(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[905],{8483:function(e,t,n){"use strict";var i=n(7879);e.exports=function(e){var t,r={stun:(e||{}).stun||n(8808),turn:(e||{}).turn||n(4576)},o=(e||{}).stunCount||2,s=(e||{}).turnCount||0;function a(e,t){for(var n,o=[],s=[].concat(r[e]);s.length&&o.length<t;)n=Math.random()*s.length|0,o=o.concat(s.splice(n,1));return o.map((function(t){return"string"===typeof t||t instanceof String?i(e+":"+t):t}))}return t=[].concat(a("stun",o)),s&&(t=t.concat(a("turn",s))),t}},8233:function(e,t,n){var i,r=n(4114);"undefined"!==typeof window&&(i=window.AudioContext||window.webkitAudioContext);var o=null;e.exports=function(e,t){var n=new r;if(!i)return n;var s,a,c,d=(t=t||{}).smoothing||.1,u=t.interval||50,l=t.threshold,p=t.play,h=t.history||10,f=!0;o=t.audioContext||o||new i,(c=o.createAnalyser()).fftSize=512,c.smoothingTimeConstant=d,a=new Float32Array(c.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(s=o.createMediaElementSource(e),"undefined"===typeof p&&(p=!0),l=l||-50):(s=o.createMediaStreamSource(e),l=l||-50),s.connect(c),p&&c.connect(o.destination),n.speaking=!1,n.suspend=function(){return o.suspend()},n.resume=function(){return o.resume()},Object.defineProperty(n,"state",{get:function(){return o.state}}),o.onstatechange=function(){n.emit("state_change",o.state)},n.setThreshold=function(e){l=e},n.setInterval=function(e){u=e},n.stop=function(){f=!1,n.emit("volume_change",-100,l),n.speaking&&(n.speaking=!1,n.emit("stopped_speaking")),c.disconnect(),s.disconnect()},n.speakingHistory=[];for(var v=0;v<h;v++)n.speakingHistory.push(0);var m=function(){setTimeout((function(){if(f){var e=function(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var i=4,r=t.length;i<r;i++)t[i]>n&&t[i]<0&&(n=t[i]);return n}(c,a);n.emit("volume_change",e,l);var t=0;if(e>l&&!n.speaking){for(var i=n.speakingHistory.length-3;i<n.speakingHistory.length;i++)t+=n.speakingHistory[i];t>=2&&(n.speaking=!0,n.emit("speaking"))}else if(e<l&&n.speaking){for(i=0;i<n.speakingHistory.length;i++)t+=n.speakingHistory[i];0==t&&(n.speaking=!1,n.emit("stopped_speaking"))}n.speakingHistory.shift(),n.speakingHistory.push(0+(e>l)),m()}}),u)};return m(),n}},5717:function(e){"function"===typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},3129:function(e,t){var n=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();function i(e){if(!e)return i.__;Array.prototype.reduce||(Array.prototype.reduce=function(e,t){for(var n=t,i=0;i<this.length;i++)n=e(n,this[i],i,this);return n});var t="";return("."+e).split(".").reduce((function(e,n,r,o){t?t+="."+n:t=n;var s=e["__"+t];return void 0===s&&(i.Logger.prototype=e,s=new i.Logger(t),e["__"+t]=s),s}),i.__)}!function(e){function t(e,t,n){void 0!==t[e]&&(null!==t[e]?n[e]=t[e]:delete n[e])}function i(t){if(null!=e.enabled&&!e.enabled)return!1;try{if(t.userAgentRegex&&!new RegExp(t.userAgentRegex).test(navigator.userAgent))return!1}catch(n){}try{if(t.ipRegex&&e.clientIP&&!new RegExp(t.ipRegex).test(e.clientIP))return!1}catch(n){}return!0}function r(e,t){try{if(e.disallow&&new RegExp(e.disallow).test(t))return!1}catch(n){}return!0}function o(e){return"function"==typeof e?e instanceof RegExp?e.toString():e():e}e.requestId="",e.entryId=0,e._createXMLHttpRequest=function(){return new XMLHttpRequest},e._getTime=function(){return(new Date).getTime()},e._console=console,e._appenderNames=[];var s=function(e,t,n){this.msg=e,this.meta=t,this.finalString=n};function a(t){var n,i=o(t);switch(typeof i){case"string":return new s(i,null,i);case"number":case"boolean":return n=i.toString(),new s(n,null,n);case"undefined":return new s("undefined",null,"undefined");case"object":return i instanceof RegExp||i instanceof String||i instanceof Number||i instanceof Boolean?(n=i.toString(),new s(n,null,n)):(n="function"===typeof e.serialize?e.serialize.call(this,i):JSON.stringify(i),new s("",i,n));default:return new s("unknown",null,"unknown")}}function c(){return 1e3}function d(){return 2e3}function u(){return 3e3}function l(){return 4e3}function p(){return 5e3}function h(){return 6e3}function f(e){return e<=1e3?"trace":e<=2e3?"debug":e<=3e3?"info":e<=4e3?"warn":e<=5e3?"error":"fatal"}e.setOptions=function(e){return t("enabled",e,this),t("maxMessages",e,this),t("defaultAjaxUrl",e,this),t("clientIP",e,this),t("requestId",e,this),t("defaultBeforeSend",e,this),t("serialize",e,this),this},e.getAllLevel=function(){return-2147483648},e.getTraceLevel=c,e.getDebugLevel=d,e.getInfoLevel=u,e.getWarnLevel=l,e.getErrorLevel=p,e.getFatalLevel=h,e.getOffLevel=function(){return 2147483647};var v=function(e,t){this.inner=t,this.name="JL.Exception",this.message=a(e).finalString};e.Exception=v,v.prototype=new Error;var m=function(e,t,n,i,r){this.l=e,this.m=t,this.n=n,this.t=i,this.u=r};function g(t,n,i){return e.entryId++,new m(t,n,i,e._getTime(),e.entryId)}function b(e){e.id&&(clearTimeout(e.id),e.id=null)}function E(e,t,n){var i=this;e.id||(e.id=setTimeout((function(){n.call(i)}),t))}e.LogItem=m;var y=function(){function n(t,n){this.appenderName=t,this.sendLogItems=n,this.level=e.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.maxBatchSize=20,this.batchTimeout=2147483647,this.sendTimeout=5e3,this.buffer=[],this.batchBuffer=[],this.batchTimeoutTimer={id:null},this.sendTimeoutTimer={id:null},this.nbrLogItemsSkipped=0,this.nbrLogItemsBeingSent=0;var i="Trying to create an appender without a name or with an empty name";if(void 0==t)throw i;if(-1!=e._appenderNames.indexOf(t)){if(!t)throw i;throw"Multiple appenders use the same name "+t}e._appenderNames.push(t)}return n.prototype.addLogItemsToBuffer=function(t){if(this.batchBuffer.length>=this.maxBatchSize)this.nbrLogItemsSkipped+=t.length;else{if(null!=e.maxMessages){if(e.maxMessages<1)return;e.maxMessages-=t.length}this.batchBuffer=this.batchBuffer.concat(t);var n=this;E(this.batchTimeoutTimer,this.batchTimeout,(function(){n.sendBatch.call(n)}))}},n.prototype.batchBufferHasOverdueMessages=function(){for(var t=0;t<this.batchBuffer.length;t++){if(e._getTime()-this.batchBuffer[t].t>this.batchTimeout)return!0}return!1},n.prototype.batchBufferHasStrandedMessage=function(){return!(null==e.maxMessages)&&e.maxMessages<1&&this.batchBuffer.length>0},n.prototype.sendBatchIfComplete=function(){(this.batchBuffer.length>=this.batchSize||this.batchBufferHasOverdueMessages()||this.batchBufferHasStrandedMessage())&&this.sendBatch()},n.prototype.onSendingEnded=function(){b(this.sendTimeoutTimer),this.nbrLogItemsBeingSent=0,this.sendBatchIfComplete()},n.prototype.setOptions=function(n){if(t("level",n,this),t("ipRegex",n,this),t("userAgentRegex",n,this),t("disallow",n,this),t("sendWithBufferLevel",n,this),t("storeInBufferLevel",n,this),t("bufferSize",n,this),t("batchSize",n,this),t("maxBatchSize",n,this),t("batchTimeout",n,this),t("sendTimeout",n,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this.maxBatchSize<this.batchSize)throw new e.Exception({message:"maxBatchSize cannot be smaller than batchSize",maxBatchSize:this.maxBatchSize,batchSize:this.batchSize});return this},n.prototype.log=function(e,t,n,o,s,a,c){var d;i(this)&&r(this,a)&&(s<this.storeInBufferLevel||(d=g(s,a,c),s<this.level?this.bufferSize>0&&(this.buffer.push(d),this.buffer.length>this.bufferSize&&this.buffer.shift()):(this.addLogItemsToBuffer([d]),s>=this.sendWithBufferLevel&&this.buffer.length&&(this.addLogItemsToBuffer(this.buffer),this.buffer.length=0),this.sendBatchIfComplete())))},n.prototype.sendBatch=function(){if(!(this.nbrLogItemsBeingSent>0)&&(b(this.batchTimeoutTimer),0!=this.batchBuffer.length)){this.nbrLogItemsBeingSent=this.batchBuffer.length;var e=this;E(this.sendTimeoutTimer,this.sendTimeout,(function(){e.onSendingEnded.call(e)})),this.sendLogItems(this.batchBuffer,(function(){e.batchBuffer.splice(0,e.nbrLogItemsBeingSent),e.nbrLogItemsSkipped>0&&(e.batchBuffer.push(g(4e3,"Lost "+e.nbrLogItemsSkipped+" messages. Either connection with the server was down or logging was disabled via the enabled option. Reduce lost messages by increasing the ajaxAppender option maxBatchSize.",e.appenderName)),e.nbrLogItemsSkipped=0),e.onSendingEnded.call(e)}))}},n}();e.Appender=y;var S=function(r){function o(e){return r.call(this,e,o.prototype.sendLogItemsAjax)||this}return n(o,r),o.prototype.setOptions=function(e){return t("url",e,this),t("beforeSend",e,this),r.prototype.setOptions.call(this,e),this},o.prototype.sendLogItemsAjax=function(t,n){try{if(!i(this))return;this.xhr&&0!=this.xhr.readyState&&4!=this.xhr.readyState&&this.xhr.abort(),this.xhr=e._createXMLHttpRequest();var r="/jsnlog.logger";null!=e.defaultAjaxUrl&&(r=e.defaultAjaxUrl),this.url&&(r=this.url),this.xhr.open("POST",r),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("JSNLog-RequestId",e.requestId);var o=this;this.xhr.onreadystatechange=function(){4==o.xhr.readyState&&o.xhr.status>=200&&o.xhr.status<300&&n()};var s={r:e.requestId,lg:t};"function"===typeof this.beforeSend?this.beforeSend.call(this,this.xhr,s):"function"===typeof e.defaultBeforeSend&&e.defaultBeforeSend.call(this,this.xhr,s);var a=JSON.stringify(s);this.xhr.send(a)}catch(c){}},o}(y);e.AjaxAppender=S;var w=function(t){function r(e){return t.call(this,e,r.prototype.sendLogItemsConsole)||this}return n(r,t),r.prototype.clog=function(t){e._console.log(t)},r.prototype.cerror=function(t){e._console.error?e._console.error(t):this.clog(t)},r.prototype.cwarn=function(t){e._console.warn?e._console.warn(t):this.clog(t)},r.prototype.cinfo=function(t){e._console.info?e._console.info(t):this.clog(t)},r.prototype.cdebug=function(t){e._console.debug?e._console.debug(t):this.cinfo(t)},r.prototype.sendLogItemsConsole=function(t,n){try{if(!i(this))return;if(!e._console)return;var r;for(r=0;r<t.length;++r){var o=t[r],s=o.n+": "+o.m;"undefined"===typeof window&&(s=new Date(o.t)+" | "+s),o.l<=e.getDebugLevel()?this.cdebug(s):o.l<=e.getInfoLevel()?this.cinfo(s):o.l<=e.getWarnLevel()?this.cwarn(s):this.cerror(s)}}catch(a){}n()},r}(y);e.ConsoleAppender=w;var C,O=function(){function e(e){this.loggerName=e,this.seenRegexes=[]}return e.prototype.setOptions=function(e){return t("level",e,this),t("userAgentRegex",e,this),t("disallow",e,this),t("ipRegex",e,this),t("appenders",e,this),t("onceOnly",e,this),this.seenRegexes=[],this},e.prototype.buildExceptionObject=function(e){var t={};return e.stack?t.stack=e.stack:t.e=e,e.message&&(t.message=e.message),e.name&&(t.name=e.name),e.data&&(t.data=e.data),e.inner&&(t.inner=this.buildExceptionObject(e.inner)),t},e.prototype.log=function(e,t,n){var s,c,d=0;if(!this.appenders)return this;if(e>=this.level&&i(this)&&(n?(c=this.buildExceptionObject(n)).logData=o(t):c=t,r(this,(s=a(c)).finalString))){if(this.onceOnly)for(d=this.onceOnly.length-1;d>=0;){if(new RegExp(this.onceOnly[d]).test(s.finalString)){if(this.seenRegexes[d])return this;this.seenRegexes[d]=!0}d--}for(s.meta=s.meta||{},d=this.appenders.length-1;d>=0;)this.appenders[d].log(f(e),s.msg,s.meta,(function(){}),e,s.finalString,this.loggerName),d--}return this},e.prototype.trace=function(e){return this.log(1e3,e)},e.prototype.debug=function(e){return this.log(2e3,e)},e.prototype.info=function(e){return this.log(3e3,e)},e.prototype.warn=function(e){return this.log(4e3,e)},e.prototype.error=function(e){return this.log(5e3,e)},e.prototype.fatal=function(e){return this.log(6e3,e)},e.prototype.fatalException=function(e,t){return this.log(6e3,e,t)},e}();e.Logger=O,e.createAjaxAppender=function(e){return new S(e)},e.createConsoleAppender=function(e){return new w(e)},C="undefined"!==typeof window?new S(""):new w(""),e.__=new e.Logger(""),e.__.setOptions({level:e.getDebugLevel(),appenders:[C]})}(i||(i={})),t.__esModule=!0,t.JL=i,"function"==typeof __jsnlog_configure&&__jsnlog_configure(i),"undefined"===typeof window||window.onerror||(window.onerror=function(e,t,n,r,o){return i("onerrorLogger").fatalException({msg:"Uncaught Exception",errorMsg:e?e.message||e:"",url:t,"line number":n,column:r},o),!1}),"undefined"===typeof window||window.onunhandledrejection||(window.onunhandledrejection=function(e){i("onerrorLogger").fatalException({msg:"unhandledrejection",errorMsg:e.reason?e.reason.message:e.message||null},e.reason)})},5293:function(e){!function(){"use strict";var t={182:function(e){var t,n="object"===typeof Reflect?Reflect:null,i=n&&"function"===typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"===typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!==e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,o),i(n)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}v(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&v(e,"error",t,n)}(e,r,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function d(e,t,n,i){var r,o,s;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"===typeof s?s=o[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(r=c(e))>0&&s.length>r&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,function(e){console&&console.warn&&console.warn(e)}(d)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=u.bind(i);return r.listener=n,i.wrapFn=r,r}function p(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"===typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):f(r,r.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function v(e,t,n,i){if("function"===typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(o){i.once&&e.removeEventListener(t,r),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"===typeof c)i(c,this,t);else{var d=c.length,u=f(c,d);for(n=0;n<d;++n)i(u[n],this,t)}return!0},o.prototype.addListener=function(e,t){return d(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return d(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,r,o,s;if(a(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},o.prototype.listenerCount=h,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={exports:{}},s=!0;try{t[e](o,o.exports,i),s=!1}finally{s&&delete n[e]}return o.exports}i.ab="//";var r=i(182);e.exports=r}()},7879:function(e){var t=["stun:","turn:"];e.exports=function(e){var n,i,r=(e||{}).url||e,o={};return"string"==typeof r||r instanceof String?(r=r.trim(),(n=t[t.indexOf(r.slice(0,5))])?(i=(r=r.slice(5)).split("@"),o.username=e.username,o.credential=e.credential,i.length>1&&(r=i[1],i=i[0].split(":"),o.username=i[0],o.credential=(e||{}).credential||i[1]||""),o.url=n+r,o.urls=[o.url],o):e):e}},3274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0;var i=n(7686),r=n(5364),o=n(6056),s=r.OpenViduLogger.getInstance(),a=function(){function e(e,t){this.session=e,this.disposed=!1;var n="'Connection' created ";t.role?(this.localOptions=t,this.connectionId=this.localOptions.id,this.creationTime=this.localOptions.createdAt,this.data=this.localOptions.metadata,this.rpcSessionId=this.localOptions.sessionId,this.role=this.localOptions.role,this.record=this.localOptions.record,n+="(local)"):(this.remoteOptions=t,this.connectionId=this.remoteOptions.id,this.creationTime=this.remoteOptions.createdAt,this.remoteOptions.metadata&&(this.data=this.remoteOptions.metadata),this.remoteOptions.streams&&this.initRemoteStreams(this.remoteOptions.streams),n+="(remote) with 'connectionId' ["+this.remoteOptions.id+"]"),s.info(n)}return e.prototype.sendIceCandidate=function(e){var t=this;s.debug((this.stream.outboundStreamOpts?"Local":"Remote")+"candidate for"+this.connectionId,e),this.session.openvidu.sendRequest("onIceCandidate",{endpointName:this.connectionId,candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex},(function(e,n){e&&(s.error("Error sending ICE candidate: "+JSON.stringify(e)),t.session.emitEvent("exception",[new o.ExceptionEvent(t.session,o.ExceptionEventName.ICE_CANDIDATE_ERROR,t.session,"There was an unexpected error on the server-side processing an ICE candidate generated and sent by the client-side",e)]))}))},e.prototype.initRemoteStreams=function(e){var t=this;e.forEach((function(e){var n={id:e.id,createdAt:e.createdAt,connection:t,hasAudio:e.hasAudio,hasVideo:e.hasVideo,audioActive:e.audioActive,videoActive:e.videoActive,typeOfVideo:e.typeOfVideo,frameRate:e.frameRate,videoDimensions:e.videoDimensions?JSON.parse(e.videoDimensions):void 0,filter:e.filter?e.filter:void 0},r=new i.Stream(t.session,n);t.addStream(r)})),s.info("Remote 'Connection' with 'connectionId' ["+this.connectionId+"] is now configured for receiving Streams with options: ",this.stream.inboundStreamOpts)},e.prototype.addStream=function(e){e.connection=this,this.stream=e},e.prototype.removeStream=function(e){delete this.stream},e.prototype.dispose=function(){this.stream&&delete this.stream,this.disposed=!0},e}();t.Connection=a},3013:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=void 0;var i=n(4795),r=n(5364).OpenViduLogger.getInstance(),o=function(){function e(){this.userHandlerArrowHandler=new WeakMap,this.ee=new i}return e.prototype.off=function(e,t){if(t){var n=this.userHandlerArrowHandler.get(t);n&&this.ee.off(e,n),this.userHandlerArrowHandler.delete(t)}else this.ee.removeAllListeners(e);return this},e.prototype.onAux=function(e,t,n){var i=function(e){e?r.info(t,e):r.info(t),n(e)};return this.userHandlerArrowHandler.set(n,i),this.ee.on(e,i),this},e.prototype.onceAux=function(e,t,n){var i=this,o=function(e){e?r.info(t,e):r.info(t),n(e),i.userHandlerArrowHandler.delete(n)};return this.userHandlerArrowHandler.set(n,o),this.ee.once(e,o),this},e}();t.EventDispatcher=o},6153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Filter=void 0;var i=n(7614),r=n(7009),o=n(5364).OpenViduLogger.getInstance(),s=function(){function e(e,t){this.handlers=new Map,this.type=e,this.options=t}return e.prototype.execMethod=function(e,t){var n=this;return new Promise((function(s,a){var c;if(o.info("Executing filter method to stream "+n.stream.streamId),"string"!==typeof t)try{c=JSON.stringify(t)}catch(u){var d="'params' property must be a JSON formatted object";o.error(d),a(d)}else c=t;n.stream.session.openvidu.sendRequest("execFilterMethod",{streamId:n.stream.streamId,method:e,params:c},(function(t,d){if(t)o.error("Error executing filter method for Stream "+n.stream.streamId,t),401===t.code?a(new r.OpenViduError(r.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to execute a filter method")):a(t);else{o.info("Filter method successfully executed on Stream "+n.stream.streamId);var u=Object.assign({},n.stream.filter);n.stream.filter.lastExecMethod={method:e,params:JSON.parse(c)},n.stream.session.emitEvent("streamPropertyChanged",[new i.StreamPropertyChangedEvent(n.stream.session,n.stream,"filter",n.stream.filter,u,"execFilterMethod")]),n.stream.streamManager.emitEvent("streamPropertyChanged",[new i.StreamPropertyChangedEvent(n.stream.streamManager,n.stream,"filter",n.stream.filter,u,"execFilterMethod")]),s()}}))}))},e.prototype.addEventListener=function(e,t){var n=this;return new Promise((function(i,s){o.info("Adding filter event listener to event "+e+" to stream "+n.stream.streamId),n.stream.session.openvidu.sendRequest("addFilterEventListener",{streamId:n.stream.streamId,eventType:e},(function(a,c){a?(o.error("Error adding filter event listener to event "+e+"for Stream "+n.stream.streamId,a),401===a.code?s(new r.OpenViduError(r.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):s(a)):(n.handlers.set(e,t),o.info("Filter event listener to event "+e+" successfully applied on Stream "+n.stream.streamId),i())}))}))},e.prototype.removeEventListener=function(e){var t=this;return new Promise((function(n,i){o.info("Removing filter event listener to event "+e+" to stream "+t.stream.streamId),t.stream.session.openvidu.sendRequest("removeFilterEventListener",{streamId:t.stream.streamId,eventType:e},(function(s,a){s?(o.error("Error removing filter event listener to event "+e+"for Stream "+t.stream.streamId,s),401===s.code?i(new r.OpenViduError(r.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):i(s)):(t.handlers.delete(e),o.info("Filter event listener to event "+e+" successfully removed on Stream "+t.stream.streamId),n())}))}))},e}();t.Filter=s},1944:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorder=void 0;var i,r=n(9690),o=n(5364),s=n(5971),a=o.OpenViduLogger.getInstance(),c=function(){function e(e){this.stream=e,this.chunks=[],i=s.PlatformUtils.getInstance(),this.connectionId=this.stream.connection?this.stream.connection.connectionId:"default-connection",this.id=this.stream.streamId+"_"+this.connectionId+"_localrecord",this.state=r.LocalRecorderState.READY}return e.prototype.record=function(e){var t=this;return new Promise((function(n,i){try{if("undefined"===typeof MediaRecorder)throw a.error("MediaRecorder not supported on your browser. See compatibility in https://caniuse.com/#search=MediaRecorder"),Error("MediaRecorder not supported on your browser. See compatibility in https://caniuse.com/#search=MediaRecorder");if(t.state!==r.LocalRecorderState.READY)throw Error("'LocalRecord.record()' needs 'LocalRecord.state' to be 'READY' (current value: '"+t.state+"'). Call 'LocalRecorder.clean()' or init a new LocalRecorder before");a.log("Starting local recording of stream '"+t.stream.streamId+"' of connection '"+t.connectionId+"'");var o={};"function"===typeof MediaRecorder.isTypeSupported?e?(MediaRecorder.isTypeSupported(e)||i(new Error('mimeType "'+e+'" is not supported')),o={mimeType:e}):a.log("No mimeType parameter provided. Using default codecs"):a.warn("MediaRecorder#isTypeSupported is not supported. Using default codecs"),t.mediaRecorder=new MediaRecorder(t.stream.getMediaStream(),o),t.mediaRecorder.start(10)}catch(s){i(s)}t.mediaRecorder.ondataavailable=function(e){t.chunks.push(e.data)},t.mediaRecorder.onerror=function(e){a.error("MediaRecorder error: ",e)},t.mediaRecorder.onstart=function(){a.log("MediaRecorder started (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onstop=function(){t.onStopDefault()},t.mediaRecorder.onpause=function(){a.log("MediaRecorder paused (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onresume=function(){a.log("MediaRecorder resumed (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onwarning=function(e){a.log("MediaRecorder warning: "+e)},t.state=r.LocalRecorderState.RECORDING,n()}))},e.prototype.stop=function(){var e=this;return new Promise((function(t,n){try{if(e.state===r.LocalRecorderState.READY||e.state===r.LocalRecorderState.FINISHED)throw Error("'LocalRecord.stop()' needs 'LocalRecord.state' to be 'RECORDING' or 'PAUSED' (current value: '"+e.state+"'). Call 'LocalRecorder.start()' before");e.mediaRecorder.onstop=function(){e.onStopDefault(),t()},e.mediaRecorder.stop()}catch(i){n(i)}}))},e.prototype.pause=function(){var e=this;return new Promise((function(t,n){try{e.state!==r.LocalRecorderState.RECORDING&&n(Error("'LocalRecord.pause()' needs 'LocalRecord.state' to be 'RECORDING' (current value: '"+e.state+"'). Call 'LocalRecorder.start()' or 'LocalRecorder.resume()' before")),e.mediaRecorder.pause(),e.state=r.LocalRecorderState.PAUSED,t()}catch(i){n(i)}}))},e.prototype.resume=function(){var e=this;return new Promise((function(t,n){try{if(e.state!==r.LocalRecorderState.PAUSED)throw Error("'LocalRecord.resume()' needs 'LocalRecord.state' to be 'PAUSED' (current value: '"+e.state+"'). Call 'LocalRecorder.pause()' before");e.mediaRecorder.resume(),e.state=r.LocalRecorderState.RECORDING,t()}catch(i){n(i)}}))},e.prototype.preview=function(e){if(this.state!==r.LocalRecorderState.FINISHED)throw Error("'LocalRecord.preview()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");if(this.videoPreview=document.createElement("video"),this.videoPreview.id=this.id,this.videoPreview.autoplay=!0,i.isSafariBrowser()&&this.videoPreview.setAttribute("playsinline","true"),"string"===typeof e){var t=document.getElementById(e);t&&(this.videoPreview=t.appendChild(this.videoPreview))}else this.videoPreview=e.appendChild(this.videoPreview);return this.videoPreview.src=this.videoPreviewSrc,this.videoPreview},e.prototype.clean=function(){var e=this,t=function(){delete e.blob,e.chunks=[],delete e.mediaRecorder,e.state=r.LocalRecorderState.READY};this.state===r.LocalRecorderState.RECORDING||this.state===r.LocalRecorderState.PAUSED?this.stop().then((function(){return t()})).catch((function(){return t()})):t()},e.prototype.download=function(){if(this.state!==r.LocalRecorderState.FINISHED)throw Error("'LocalRecord.download()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");var e=document.createElement("a");e.style.display="none",document.body.appendChild(e);var t=window.URL.createObjectURL(this.blob);e.href=t,e.download=this.id+".webm",e.click(),window.URL.revokeObjectURL(t),document.body.removeChild(e)},e.prototype.getBlob=function(){if(this.state!==r.LocalRecorderState.FINISHED)throw Error("Call 'LocalRecord.stop()' before getting Blob file");return this.blob},e.prototype.uploadAsBinary=function(e,t){var n=this;return new Promise((function(i,o){if(n.state!==r.LocalRecorderState.FINISHED)o(Error("'LocalRecord.uploadAsBinary()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));else{var s=new XMLHttpRequest;if(s.open("POST",e,!0),"object"===typeof t)for(var a=0,c=Object.keys(t);a<c.length;a++){var d=c[a];s.setRequestHeader(d,t[d])}s.onreadystatechange=function(){4===s.readyState&&("2"===s.status.toString().charAt(0)?i(s.responseText):o(s.status))},s.send(n.blob)}}))},e.prototype.uploadAsMultipartfile=function(e,t){var n=this;return new Promise((function(i,o){if(n.state!==r.LocalRecorderState.FINISHED)o(Error("'LocalRecord.uploadAsMultipartfile()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));else{var s=new XMLHttpRequest;if(s.open("POST",e,!0),"object"===typeof t)for(var a=0,c=Object.keys(t);a<c.length;a++){var d=c[a];s.setRequestHeader(d,t[d])}var u=new FormData;u.append("file",n.blob,n.id+".webm"),s.onreadystatechange=function(){4===s.readyState&&("2"===s.status.toString().charAt(0)?i(s.responseText):o(s.status))},s.send(u)}}))},e.prototype.onStopDefault=function(){a.log("MediaRecorder stopped  (state="+this.mediaRecorder.state+")"),this.blob=new Blob(this.chunks,{type:"video/webm"}),this.chunks=[],this.videoPreviewSrc=window.URL.createObjectURL(this.blob),this.state=r.LocalRecorderState.FINISHED},e}();t.LocalRecorder=c},4527:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenVidu=void 0;var i,r=n(1944),o=n(2917),s=n(7678),a=n(3439),c=n(7614),d=n(7009),u=n(4270),l=n(5364),p=n(5971),h=n(3061),f=n(9544),v=n(327),m=n(4795),g=n(4834),b=n(5549),E=l.OpenViduLogger.getInstance(),y=function(){function e(){var e=this;this.masterNodeHasCrashed=!1,this.publishers=[],this.secret="",this.recorder=!1,this.life=-1,this.advancedConfiguration={},this.webrtcStatsInterval=-1,this.sendBrowserLogs=v.OpenViduLoggerConfiguration.disabled,this.isPro=!1,this.ee=new m,i=p.PlatformUtils.getInstance(),this.libraryVersion=b.version,E.info("OpenVidu initialized"),E.info("Platform detected: "+i.getDescription()),E.info("openvidu-browser version: "+this.libraryVersion),(i.isMobileDevice()||i.isReactNative())&&this.onOrientationChanged((function(){e.publishers.forEach((function(t){t.stream.isLocalStreamPublished&&t.stream&&t.stream.hasVideo&&e.sendNewVideoDimensionsIfRequired(t,"deviceRotated",75,10)}))}))}return e.prototype.onOrientationChanged=function(e){window.addEventListener("orientationchange",e)},e.prototype.sendNewVideoDimensionsIfRequired=function(e,t,n,i){var r=this,o=0,s=e.stream.videoDimensions.width,a=e.stream.videoDimensions.height,c=setInterval((function(){++o>i&&clearTimeout(c),e.getVideoDimensions(e.stream.getMediaStream()).then((function(n){n.width===s&&n.height===a||(clearTimeout(c),r.sendVideoDimensionsChangedEvent(e,t,s,a,n.width,n.height))}))}),n)},e.prototype.sendVideoDimensionsChangedEvent=function(e,t,n,i,r,o){var s=this;e.stream.videoDimensions={width:r||0,height:o||0},this.sendRequest("streamPropertyChanged",{streamId:e.stream.streamId,property:"videoDimensions",newValue:JSON.stringify(e.stream.videoDimensions),reason:t},(function(r,o){r?E.error("Error sending 'streamPropertyChanged' event",r):(s.session.emitEvent("streamPropertyChanged",[new c.StreamPropertyChangedEvent(s.session,e.stream,"videoDimensions",e.stream.videoDimensions,{width:n,height:i},t)]),e.emitEvent("streamPropertyChanged",[new c.StreamPropertyChangedEvent(e,e.stream,"videoDimensions",e.stream.videoDimensions,{width:n,height:i},t)]),s.session.sendVideoData(e))}))},e.prototype.initSession=function(){return this.session=new s.Session(this),this.session},e.prototype.initPublisher=function(e,t,n){var i;i=t&&"function"!==typeof t?{audioSource:"undefined"!==typeof(i=t).audioSource?i.audioSource:void 0,frameRate:"undefined"!==typeof MediaStreamTrack&&i.videoSource instanceof MediaStreamTrack?void 0:"undefined"!==typeof i.frameRate?i.frameRate:void 0,insertMode:"undefined"!==typeof i.insertMode?"string"===typeof i.insertMode?u.VideoInsertMode[i.insertMode]:i.insertMode:u.VideoInsertMode.APPEND,mirror:"undefined"===typeof i.mirror||i.mirror,publishAudio:"undefined"===typeof i.publishAudio||i.publishAudio,publishVideo:"undefined"===typeof i.publishVideo||i.publishVideo,resolution:"undefined"!==typeof MediaStreamTrack&&i.videoSource instanceof MediaStreamTrack?void 0:"undefined"!==typeof i.resolution?i.resolution:"640x480",videoSource:"undefined"!==typeof i.videoSource?i.videoSource:void 0,filter:i.filter}:{insertMode:u.VideoInsertMode.APPEND,mirror:!0,publishAudio:!0,publishVideo:!0,resolution:"640x480"};var r,s=new o.Publisher(e,i,this);return t&&"function"===typeof t?r=t:n&&(r=n),s.initialize().then((function(){void 0!==r&&r(void 0),s.emitEvent("accessAllowed",[])})).catch((function(e){void 0!==r&&r(e),s.emitEvent("accessDenied",[e])})),this.publishers.push(s),s},e.prototype.initPublisherAsync=function(e,t){var n=this;return new Promise((function(i,r){var o,s=function(e){e?r(e):i(o)};o=t?n.initPublisher(e,t,s):n.initPublisher(e,s)}))},e.prototype.initLocalRecorder=function(e){return new r.LocalRecorder(e)},e.prototype.checkSystemRequirements=function(){return i.isIPhoneOrIPad()?i.isIOSWithSafari()||i.isIonicIos()||i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()?1:0:i.isChromeBrowser()||i.isChromeMobileBrowser()||i.isFirefoxBrowser()||i.isFirefoxMobileBrowser()||i.isOperaBrowser()||i.isOperaMobileBrowser()||i.isEdgeBrowser()||i.isEdgeMobileBrowser()||i.isSafariBrowser()||i.isAndroidBrowser()||i.isElectron()||i.isSamsungBrowser()?1:0},e.prototype.checkScreenSharingCapabilities=function(){return i.canScreenShare()},e.prototype.getDevices=function(){return new Promise((function(e,t){navigator.mediaDevices.enumerateDevices().then((function(t){var n,r=[];i.isIonicAndroid()&&"undefined"!=typeof cordova&&(null===(n=null===cordova||void 0===cordova?void 0:cordova.plugins)||void 0===n?void 0:n.EnumerateDevicesPlugin)?cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then((function(n){var i=[],o=[],s=[];i=n.filter((function(e){return"audioinput"===e.kind})),o=t.filter((function(e){return"videoinput"===e.kind})),s=t.filter((function(e){return"audioinput"===e.kind})),o.forEach((function(e,t){if(e.label)r.push({kind:e.kind,deviceId:e.deviceId,label:e.label});else{var n="";n=0===t?"Front Camera":1===t?"Back Camera":"Unknown Camera",r.push({kind:e.kind,deviceId:e.deviceId,label:n})}})),s.forEach((function(e,t){if(e.label)r.push({kind:e.kind,deviceId:e.deviceId,label:e.label});else{var n="";switch(t){case 0:n="Default";break;case 1:var o=i.filter((function(e){return e.label.includes("Built")}))[0];n=o?o.label:"Built-in Microphone";break;case 2:var s=i.filter((function(e){return e.label.includes("Wired")}))[0];n=s?s.label:"Headset earpiece";break;case 3:var a=i.filter((function(e){return e.label.includes("Bluetooth")}))[0];n=a?a.label:"Wireless";break;default:n="Unknown Microphone"}r.push({kind:e.kind,deviceId:e.deviceId,label:n})}})),e(r)})):(t.forEach((function(e){"audioinput"!==e.kind&&"videoinput"!==e.kind||r.push({kind:e.kind,deviceId:e.deviceId,label:e.label})})),e(r))})).catch((function(e){E.error("Error getting devices",e),t(e)}))}))},e.prototype.getUserMedia=function(e){var t=this;return new Promise((function(n,r){var o=function(e,i){var o={audio:void 0===i.audio||i.audio,video:!1};navigator.mediaDevices.getUserMedia(o).then((function(t){e.addTrack(t.getAudioTracks()[0]),n(e)})).catch((function(n){e.getAudioTracks().forEach((function(e){e.stop()})),e.getVideoTracks().forEach((function(e){e.stop()})),r(t.generateAudioDeviceError(n,o))}))};t.generateMediaConstraints(e).then((function(s){var a,c;if(s.videoTrack&&s.audioTrack||s.audioTrack&&!1===(null===(a=s.constraints)||void 0===a?void 0:a.video)||s.videoTrack&&!1===(null===(c=s.constraints)||void 0===c?void 0:c.audio))n(t.addAlreadyProvidedTracks(s,new MediaStream));else{s.videoTrack&&delete s.constraints.video,s.audioTrack&&delete s.constraints.audio;var u=!1;if("string"===typeof e.videoSource&&("screen"===e.videoSource||"window"===e.videoSource||i.isElectron()&&e.videoSource.startsWith("screen:"))&&(u=!s.audioTrack&&null!==e.audioSource&&!1!==e.audioSource,navigator.mediaDevices.getDisplayMedia&&!i.isElectron()))return void navigator.mediaDevices.getDisplayMedia({video:!0}).then((function(e){t.addAlreadyProvidedTracks(s,e),u?o(e,s.constraints):n(e)})).catch((function(e){var t=d.OpenViduErrorName.SCREEN_CAPTURE_DENIED,n=e.toString();r(new d.OpenViduError(t,n))}));var l=u?{video:s.constraints.video}:s.constraints;navigator.mediaDevices.getUserMedia(l).then((function(e){t.addAlreadyProvidedTracks(s,e),u?o(e,s.constraints):n(e)})).catch((function(t){var n,i=t.toString();n="screen"!==e.videoSource?d.OpenViduErrorName.DEVICE_ACCESS_DENIED:d.OpenViduErrorName.SCREEN_CAPTURE_DENIED,r(new d.OpenViduError(n,i))}))}})).catch((function(e){r(e)}))}))},e.prototype.enableProdMode=function(){E.enableProdMode()},e.prototype.setAdvancedConfiguration=function(e){this.advancedConfiguration=e},e.prototype.generateMediaConstraints=function(e){var t=this;return new Promise((function(n,i){var r={audioTrack:void 0,videoTrack:void 0,constraints:{audio:void 0,video:void 0}},o=e.audioSource,s=e.videoSource;if(null!==o&&!1!==o||(r.constraints.audio=!1),null!==s&&!1!==s||(r.constraints.video=!1),!1===r.constraints.audio&&!1===r.constraints.video&&i(new d.OpenViduError(d.OpenViduErrorName.NO_INPUT_SOURCE_SET,"Properties 'audioSource' and 'videoSource' cannot be set to false or null at the same time")),"undefined"!==typeof MediaStreamTrack&&o instanceof MediaStreamTrack&&(r.audioTrack=o),"undefined"!==typeof MediaStreamTrack&&s instanceof MediaStreamTrack&&(r.videoTrack=s),void 0===o&&(r.constraints.audio=!0),void 0===s&&(r.constraints.video={width:{ideal:640},height:{ideal:480}}),null!==s&&!1!==s){if(e.resolution){var a=e.resolution.toLowerCase().split("x"),c=Number(a[0]),u=Number(a[1]);r.constraints.video={width:{ideal:c},height:{ideal:u}}}e.frameRate&&(r.constraints.video.frameRate={ideal:e.frameRate})}t.configureDeviceIdOrScreensharing(r,e,n,i),n(r)}))},e.prototype.startWs=function(e){var t={heartbeat:5e3,ws:{uri:this.wsUri+"?sessionId="+this.session.sessionId,onconnected:e,ondisconnect:this.disconnectCallback.bind(this),onreconnecting:this.reconnectingCallback.bind(this),onreconnected:this.reconnectedCallback.bind(this),ismasternodecrashed:this.isMasterNodeCrashed.bind(this)},rpc:{requestTimeout:1e4,participantJoined:this.session.onParticipantJoined.bind(this.session),participantPublished:this.session.onParticipantPublished.bind(this.session),participantUnpublished:this.session.onParticipantUnpublished.bind(this.session),participantLeft:this.session.onParticipantLeft.bind(this.session),participantEvicted:this.session.onParticipantEvicted.bind(this.session),recordingStarted:this.session.onRecordingStarted.bind(this.session),recordingStopped:this.session.onRecordingStopped.bind(this.session),sendMessage:this.session.onNewMessage.bind(this.session),streamPropertyChanged:this.session.onStreamPropertyChanged.bind(this.session),connectionPropertyChanged:this.session.onConnectionPropertyChanged.bind(this.session),networkQualityLevelChanged:this.session.onNetworkQualityLevelChangedChanged.bind(this.session),filterEventDispatched:this.session.onFilterEventDispatched.bind(this.session),iceCandidate:this.session.recvIceCandidate.bind(this.session),mediaError:this.session.onMediaError.bind(this.session),masterNodeCrashedNotification:this.onMasterNodeCrashedNotification.bind(this),forciblyReconnectSubscriber:this.session.onForciblyReconnectSubscriber.bind(this.session)}};this.jsonRpcClient=new g.clients.JsonRpcClient(t)},e.prototype.onMasterNodeCrashedNotification=function(e){console.error("Master Node has crashed"),this.masterNodeHasCrashed=!0,this.session.onLostConnection("nodeCrashed"),this.jsonRpcClient.close(4103,"Master Node has crashed")},e.prototype.getWsReadyState=function(){return this.jsonRpcClient.getReadyState()},e.prototype.closeWs=function(){this.jsonRpcClient.close(4102,"Connection closed by client")},e.prototype.sendRequest=function(e,t,n){t&&t instanceof Function&&(n=t,t={}),E.debug('Sending request: {method:"'+e+'", params: '+JSON.stringify(t)+"}"),this.jsonRpcClient.send(e,t,n)},e.prototype.getWsUri=function(){return this.wsUri},e.prototype.getSecret=function(){return this.secret},e.prototype.getRecorder=function(){return this.recorder},e.prototype.generateAudioDeviceError=function(e,t){var n,i;switch("Error"===e.name&&(e.name=e.constructor.name),e.name.toLowerCase()){case"notfounderror":return n=d.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,i=e.toString(),new d.OpenViduError(n,i);case"notallowederror":return n=d.OpenViduErrorName.DEVICE_ACCESS_DENIED,i=e.toString(),new d.OpenViduError(n,i);case"overconstrainederror":return"deviceid"===e.constraint.toLowerCase()?(n=d.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,i="Audio input device with deviceId '"+t.audio.deviceId.exact+"' not found"):(n=d.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,i="Audio input device doesn't support the value passed for constraint '"+e.constraint+"'"),new d.OpenViduError(n,i);case"notreadableerror":return n=d.OpenViduErrorName.DEVICE_ALREADY_IN_USE,i=e.toString(),new d.OpenViduError(n,i);default:return new d.OpenViduError(d.OpenViduErrorName.INPUT_AUDIO_DEVICE_GENERIC_ERROR,e.toString())}},e.prototype.addAlreadyProvidedTracks=function(e,t){return e.videoTrack&&t.addTrack(e.videoTrack),e.audioTrack&&t.addTrack(e.audioTrack),t},e.prototype.configureDeviceIdOrScreensharing=function(e,t,n,r){var o=this,s=t.audioSource,a=t.videoSource;if("string"===typeof s&&(e.constraints.audio={deviceId:{exact:s}}),"string"===typeof a)if(this.isScreenShare(a))if(this.checkScreenSharingCapabilities())if(i.isElectron()){var c="screen:",u=a,l=u.substr(u.indexOf(c)+c.length);e.constraints.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:l}},n(e)}else{if(this.advancedConfiguration.screenShareChromeExtension&&!i.isFirefoxBrowser()&&!i.isFirefoxMobileBrowser()&&!navigator.mediaDevices.getDisplayMedia)return void f.getScreenConstraints((function(t,i){if(t||i.mandatory&&"screen"===i.mandatory.chromeMediaSource){if("permission-denied"!==t&&"PermissionDeniedError"!==t){var s=o.advancedConfiguration.screenShareChromeExtension.split("/").pop().trim();return void f.getChromeExtensionStatus(s,(function(e){if("installed-disabled"===e){var t=new d.OpenViduError(d.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");E.error(t),r(t)}if("not-installed"===e){var n=new d.OpenViduError(d.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,o.advancedConfiguration.screenShareChromeExtension);E.error(n),r(n)}}))}var a=new d.OpenViduError(d.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");E.error(a),r(a)}else e.constraints.video=i,n(e)}));if(!navigator.mediaDevices.getDisplayMedia){var p=i.isFirefoxBrowser()||i.isFirefoxMobileBrowser()?t.videoSource:void 0;return void h.getScreenId(p,(function(t,i,s){if(t)if("not-installed"===t){var a=o.advancedConfiguration.screenShareChromeExtension?o.advancedConfiguration.screenShareChromeExtension:"https://chrome.google.com/webstore/detail/openvidu-screensharing/lfcgfepafnobdloecchnfaclibenjold",c=new d.OpenViduError(d.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,a);E.error(c),r(c)}else if("installed-disabled"===t){c=new d.OpenViduError(d.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");E.error(c),r(c)}else if("permission-denied"===t){c=new d.OpenViduError(d.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");E.error(c),r(c)}else{c=new d.OpenViduError(d.OpenViduErrorName.GENERIC_ERROR,"Unknown error when accessing screen share");E.error(c),E.error(t),r(c)}else e.constraints.video=s.video,n(e)}))}n(e)}else{var v=new d.OpenViduError(d.OpenViduErrorName.SCREEN_SHARING_NOT_SUPPORTED,"You can only screen share in desktop Chrome, Firefox, Opera, Safari (>=13.0), Edge (>= 80) or Electron. Detected client: "+i.getName()+" "+i.getVersion());E.error(v),r(v)}else this.setVideoSource(e,a)},e.prototype.setVideoSource=function(e,t){e.constraints.video||(e.constraints.video={}),e.constraints.video.deviceId={exact:t}},e.prototype.disconnectCallback=function(){E.warn("Websocket connection lost"),this.isRoomAvailable()?this.session.onLostConnection("networkDisconnect"):alert("Connection error. Please reload page.")},e.prototype.reconnectingCallback=function(){E.warn("Websocket connection lost (reconnecting)"),this.isRoomAvailable()?this.session.emitEvent("reconnecting",[]):alert("Connection error. Please reload page.")},e.prototype.reconnectedCallback=function(){var e=this;if(E.warn("Websocket reconnected"),this.isRoomAvailable())if(this.session.connection)this.sendRequest("connect",{sessionId:this.session.connection.rpcSessionId},(function(t,n){if(t)if(e.isMasterNodeCrashed())E.warn("Master Node has crashed!");else{E.error(t);var i=function(t){E.warn("Websocket was able to reconnect to OpenVidu Server, but your Connection was already destroyed due to timeout. You are no longer a participant of the Session and your media streams have been destroyed"),e.session.onLostConnection("networkDisconnect"),e.jsonRpcClient.close(4101,"Reconnection fault")};-1===e.life?i():e.sendRequest("sessionStatus",{sessionId:e.session.sessionId},(function(t,n){e.life===n.life?i():(E.warn("Websocket was able to reconnect to OpenVidu Server, but your Master Node crashed."),e.session.onLostConnection("nodeCrashed"),e.jsonRpcClient.close(4101,"Reconnection fault"))}))}else e.jsonRpcClient.resetPing(),e.session.onRecoveredConnection()}));else{E.warn("There was no previous connection when running reconnection callback");var t=new a.SessionDisconnectedEvent(this.session,"networkDisconnect");this.session.ee.emitEvent("sessionDisconnected",[t]),t.callDefaultBehavior()}else alert("Connection error. Please reload page.")},e.prototype.isMasterNodeCrashed=function(){return this.masterNodeHasCrashed},e.prototype.isRoomAvailable=function(){return void 0!==this.session&&this.session instanceof s.Session||(E.warn("Session instance not found"),!1)},e.prototype.isScreenShare=function(e){return"screen"===e||"window"===e||i.isElectron()&&e.startsWith("screen:")},e}();t.OpenVidu=y},2917:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Publisher=void 0;var s,a=n(7678),c=n(7686),d=n(2028),u=n(3590),l=n(7614),p=n(6367),h=n(7009),f=n(5364),v=n(5971),m=f.OpenViduLogger.getInstance(),g=function(e){function t(t,n,i){var r=e.call(this,new c.Stream(i.session?i.session:new a.Session(i),{publisherProperties:n,mediaConstraints:{}}),t)||this;return r.accessAllowed=!1,r.isSubscribedToRemote=!1,r.accessDenied=!1,s=v.PlatformUtils.getInstance(),r.properties=n,r.openvidu=i,r.stream.ee.on("local-stream-destroyed",(function(e){r.stream.isLocalStreamPublished=!1;var t=new u.StreamEvent(!0,r,"streamDestroyed",r.stream,e);r.emitEvent("streamDestroyed",[t]),t.callDefaultBehavior()})),r}return i(t,e),t.prototype.publishAudio=function(e){var t=this;this.stream.audioActive!==e&&((this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream()).getAudioTracks().forEach((function(t){t.enabled=e})),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"audioActive",newValue:e,reason:"publishAudio"},(function(n,i){n?m.error("Error sending 'streamPropertyChanged' event",n):(t.session.emitEvent("streamPropertyChanged",[new l.StreamPropertyChangedEvent(t.session,t.stream,"audioActive",e,!e,"publishAudio")]),t.emitEvent("streamPropertyChanged",[new l.StreamPropertyChangedEvent(t,t.stream,"audioActive",e,!e,"publishAudio")]),t.session.sendVideoData(t.stream.streamManager))})),this.stream.audioActive=e,m.info("'Publisher' has "+(e?"published":"unpublished")+" its audio stream"))},t.prototype.publishVideo=function(e){var t=this;this.stream.videoActive!==e&&((this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream()).getVideoTracks().forEach((function(t){t.enabled=e})),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"videoActive",newValue:e,reason:"publishVideo"},(function(n,i){n?m.error("Error sending 'streamPropertyChanged' event",n):(t.session.emitEvent("streamPropertyChanged",[new l.StreamPropertyChangedEvent(t.session,t.stream,"videoActive",e,!e,"publishVideo")]),t.emitEvent("streamPropertyChanged",[new l.StreamPropertyChangedEvent(t,t.stream,"videoActive",e,!e,"publishVideo")]),t.session.sendVideoData(t.stream.streamManager))})),this.stream.videoActive=e,m.info("'Publisher' has "+(e?"published":"unpublished")+" its video stream"))},t.prototype.subscribeToRemote=function(e){e=void 0===e||e,this.isSubscribedToRemote=e,this.stream.subscribeToMyRemote(e)},t.prototype.on=function(t,n){var i=this;return e.prototype.on.call(this,t,n),"streamCreated"===t&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new u.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.on("stream-created-by-publisher",(function(){i.emitEvent("streamCreated",[new u.StreamEvent(!1,i,"streamCreated",i.stream,"")])}))),"remoteVideoPlaying"===t&&this.stream.displayMyRemote()&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.emitEvent("remoteVideoPlaying",[new p.VideoElementEvent(this.videos[0].video,this,"remoteVideoPlaying")]),"accessAllowed"===t&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===t&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},t.prototype.once=function(t,n){var i=this;return e.prototype.once.call(this,t,n),"streamCreated"===t&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new u.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.once("stream-created-by-publisher",(function(){i.emitEvent("streamCreated",[new u.StreamEvent(!1,i,"streamCreated",i.stream,"")])}))),"remoteVideoPlaying"===t&&this.stream.displayMyRemote()&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.emitEvent("remoteVideoPlaying",[new p.VideoElementEvent(this.videos[0].video,this,"remoteVideoPlaying")]),"accessAllowed"===t&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===t&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},t.prototype.replaceTrack=function(e){return r(this,void 0,void 0,(function(){var t,n,i,r,s=this;return o(this,(function(o){switch(o.label){case 0:t=function(){return new Promise((function(t,n){var i,r=s.stream.displayMyRemote()?s.stream.localMediaStreamWhenSubscribedToRemote:s.stream.getMediaStream();i="video"===e.kind?r.getVideoTracks()[0]:r.getAudioTracks()[0],r.removeTrack(i),i.stop(),r.addTrack(e),"video"===e.kind&&s.stream.isLocalStreamPublished&&(s.openvidu.sendNewVideoDimensionsIfRequired(s,"trackReplaced",50,30),s.session.sendVideoData(s.stream.streamManager,5,!0,5)),t()}))},n=function(){return new Promise((function(t,n){var i,r=s.stream.getRTCPeerConnection().getSenders();if("video"===e.kind){if(!(i=r.find((function(e){return!!e.track&&"video"===e.track.kind}))))return void n(new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object"))}else{if("audio"!==e.kind)return void n(new Error("Unknown track kind "+e.kind));if(!(i=r.find((function(e){return!!e.track&&"audio"===e.track.kind}))))return void n(new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object"))}i.replaceTrack(e).then((function(){t()})).catch((function(e){n(e)}))}))},i=e.enabled,"video"===e.kind?e.enabled=this.stream.videoActive:"audio"===e.kind&&(e.enabled=this.stream.audioActive),o.label=1;case 1:return o.trys.push([1,7,,8]),this.stream.isLocalStreamPublished?[4,n()]:[3,4];case 2:return o.sent(),[4,t()];case 3:return[2,o.sent()];case 4:return[4,t()];case 5:return[2,o.sent()];case 6:return[3,8];case 7:throw r=o.sent(),e.enabled=i,r;case 8:return[2]}}))}))},t.prototype.initialize=function(){var e=this;return new Promise((function(t,n){var i,r={},o={},a=1500,c=function(t){e.accessDenied=!0,e.accessAllowed=!1,m.error("Publisher initialization failed. "+t.name+": "+t.message),n(t)},d=function(n){if(e.accessAllowed=!0,e.accessDenied=!1,"undefined"!==typeof MediaStreamTrack&&e.properties.audioSource instanceof MediaStreamTrack&&(n.removeTrack(n.getAudioTracks()[0]),n.addTrack(e.properties.audioSource)),"undefined"!==typeof MediaStreamTrack&&e.properties.videoSource instanceof MediaStreamTrack&&(n.removeTrack(n.getVideoTracks()[0]),n.addTrack(e.properties.videoSource)),n.getAudioTracks()[0]){var i=void 0!==e.stream.audioActive&&null!==e.stream.audioActive?e.stream.audioActive:!!e.stream.outboundStreamOpts.publisherProperties.publishAudio;n.getAudioTracks()[0].enabled=i}if(n.getVideoTracks()[0]){i=void 0!==e.stream.videoActive&&null!==e.stream.videoActive?e.stream.videoActive:!!e.stream.outboundStreamOpts.publisherProperties.publishVideo;n.getVideoTracks()[0].enabled=i}e.initializeVideoReference(n),e.stream.displayMyRemote()||e.stream.updateMediaStreamInVideos(),delete e.firstVideoElement,e.stream.isSendVideo()?e.getVideoDimensions(n).then((function(t){e.stream.videoDimensions={width:t.width,height:t.height},e.stream.isSendScreen()&&(e.screenShareResizeInterval=setInterval((function(){var t=n.getVideoTracks()[0].getSettings(),i=t.width,r=t.height;!e.stream.isLocalStreamPublished||i===e.stream.videoDimensions.width&&r===e.stream.videoDimensions.height||e.openvidu.sendVideoDimensionsChangedEvent(e,"screenResized",e.stream.videoDimensions.width,e.stream.videoDimensions.height,i||0,r||0)}),650)),e.stream.isLocalStreamReadyToPublish=!0,e.stream.ee.emitEvent("stream-ready-to-publish",[])})):(e.stream.isLocalStreamReadyToPublish=!0,e.stream.ee.emitEvent("stream-ready-to-publish",[])),t()},u=function(t,n){e.clearPermissionDialogTimer(i,a),e.stream.isSendScreen()&&e.stream.isSendAudio()?(o.audio=n,o.video=!1,i=Date.now(),e.setPermissionDialogTimer(a),navigator.mediaDevices.getUserMedia(o).then((function(n){e.clearPermissionDialogTimer(i,a),t.addTrack(n.getAudioTracks()[0]),d(t)})).catch((function(n){e.clearPermissionDialogTimer(i,a),t.getAudioTracks().forEach((function(e){e.stop()})),t.getVideoTracks().forEach((function(e){e.stop()})),c(e.openvidu.generateAudioDeviceError(n,r))}))):d(t)},l=function(t){var n,o;switch(m.error("getMediaError: "+t.toString()),e.clearPermissionDialogTimer(i,a),"Error"===t.name&&(t.name=t.constructor.name),t.name.toLowerCase()){case"notfounderror":navigator.mediaDevices.getUserMedia({audio:!1,video:r.video}).then((function(e){e.getVideoTracks().forEach((function(e){e.stop()})),n=h.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,o=t.toString(),c(new h.OpenViduError(n,o))})).catch((function(e){n=h.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,o=t.toString(),c(new h.OpenViduError(n,o))}));break;case"notallowederror":n=e.stream.isSendScreen()?h.OpenViduErrorName.SCREEN_CAPTURE_DENIED:h.OpenViduErrorName.DEVICE_ACCESS_DENIED,o=t.toString(),c(new h.OpenViduError(n,o));break;case"overconstrainederror":navigator.mediaDevices.getUserMedia({audio:!1,video:r.video}).then((function(e){e.getVideoTracks().forEach((function(e){e.stop()})),"deviceid"===t.constraint.toLowerCase()?(n=h.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,o="Audio input device with deviceId '"+r.audio.deviceId.exact+"' not found"):(n=h.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,o="Audio input device doesn't support the value passed for constraint '"+t.constraint+"'"),c(new h.OpenViduError(n,o))})).catch((function(e){"deviceid"===t.constraint.toLowerCase()?(n=h.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,o="Video input device with deviceId '"+r.video.deviceId.exact+"' not found"):(n=h.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,o="Video input device doesn't support the value passed for constraint '"+t.constraint+"'"),c(new h.OpenViduError(n,o))}));break;case"aborterror":case"notreadableerror":n=h.OpenViduErrorName.DEVICE_ALREADY_IN_USE,o=t.toString(),c(new h.OpenViduError(n,o));break;default:n=h.OpenViduErrorName.GENERIC_ERROR,o=t.toString(),c(new h.OpenViduError(n,o))}};e.openvidu.generateMediaConstraints(e.properties).then((function(t){var n,c;if(t.videoTrack&&t.audioTrack||t.audioTrack&&!1===(null===(n=t.constraints)||void 0===n?void 0:n.video)||t.videoTrack&&!1===(null===(c=t.constraints)||void 0===c?void 0:c.audio))d(e.openvidu.addAlreadyProvidedTracks(t,new MediaStream));else{var p={mediaConstraints:r=t.constraints,publisherProperties:e.properties};e.stream.setOutboundStreamOptions(p);var h=void 0===r.audio||r.audio;o.audio=!e.stream.isSendScreen()&&h,o.video=r.video,i=Date.now(),e.setPermissionDialogTimer(a),e.stream.isSendScreen()&&navigator.mediaDevices.getDisplayMedia&&!s.isElectron()?navigator.mediaDevices.getDisplayMedia({video:!0}).then((function(n){e.openvidu.addAlreadyProvidedTracks(t,n),u(n,h)})).catch((function(e){l(e)})):navigator.mediaDevices.getUserMedia(o).then((function(n){e.openvidu.addAlreadyProvidedTracks(t,n),u(n,h)})).catch((function(e){l(e)}))}})).catch((function(e){c(e)}))}))},t.prototype.getVideoDimensions=function(e){var t=this;return new Promise((function(e,n){var i,r=s.isIonicIos()||s.isIOSWithSafari(),o=function(){var n,o;if("function"===typeof t.stream.getMediaStream().getVideoTracks()[0].getSettings){var a=t.stream.getMediaStream().getVideoTracks()[0].getSettings();n=a.width||t.videoReference.videoWidth,o=a.height||t.videoReference.videoHeight}else m.warn("MediaStreamTrack does not have getSettings method on "+s.getDescription()),n=t.videoReference.videoWidth,o=t.videoReference.videoHeight;null!=i&&t.videoReference.removeEventListener("loadedmetadata",i),r&&document.body.removeChild(t.videoReference),e({width:n,height:o})};t.videoReference.readyState>=1?o():(i=function(){if(t.videoReference.videoWidth)o();else var e=setInterval((function(){t.videoReference.videoWidth&&(clearInterval(e),o())}),40)},t.videoReference.addEventListener("loadedmetadata",i),r&&document.body.appendChild(t.videoReference))}))},t.prototype.reestablishStreamPlayingEvent=function(){this.ee.getListeners("streamPlaying").length>0&&this.addPlayEventToFirstVideo()},t.prototype.initializeVideoReference=function(e){this.videoReference=document.createElement("video"),this.videoReference.setAttribute("muted","true"),this.videoReference.style.display="none",(s.isSafariBrowser()||s.isIPhoneOrIPad()&&(s.isChromeMobileBrowser()||s.isEdgeMobileBrowser()||s.isOperaMobileBrowser()||s.isFirefoxMobileBrowser()))&&this.videoReference.setAttribute("playsinline","true"),this.stream.setMediaStream(e),this.firstVideoElement&&this.createVideoElement(this.firstVideoElement.targetElement,this.properties.insertMode),this.videoReference.srcObject=e},t.prototype.setPermissionDialogTimer=function(e){var t=this;this.permissionDialogTimeout=setTimeout((function(){t.emitEvent("accessDialogOpened",[])}),e)},t.prototype.clearPermissionDialogTimer=function(e,t){clearTimeout(this.permissionDialogTimeout),Date.now()-e>t&&this.emitEvent("accessDialogClosed",[])},t}(d.StreamManager);t.Publisher=g},7678:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;var s,a=n(3274),c=n(6153),d=n(4980),u=n(3013),l=n(5223),p=n(146),h=n(8856),f=n(3439),v=n(3685),m=n(3590),g=n(7614),b=n(6203),E=n(9233),y=n(7009),S=n(4270),w=n(5364),C=n(5971),O=w.OpenViduLogger.getInstance(),I=function(e){function t(t){var n=e.call(this)||this;return n.streamManagers=[],n.remoteStreamsCreated=new Map,n.remoteConnections=new Map,s=C.PlatformUtils.getInstance(),n.openvidu=t,n}return i(t,e),t.prototype.connect=function(e,t){var n=this;return new Promise((function(i,r){n.processToken(e),n.openvidu.checkSystemRequirements()?(n.options={sessionId:n.sessionId,participantId:e,metadata:t?n.stringClientMetadata(t):""},n.connectAux(e).then((function(){i()})).catch((function(e){r(e)}))):r(new y.OpenViduError(y.OpenViduErrorName.BROWSER_NOT_SUPPORTED,"Browser "+s.getName()+" (version "+s.getVersion()+") for "+s.getFamily()+" is not supported in OpenVidu"))}))},t.prototype.disconnect=function(){this.leave(!1,"disconnect")},t.prototype.subscribe=function(e,t,n,i){var r={};r=n&&"function"!==typeof n?{insertMode:"undefined"!==typeof n.insertMode?"string"===typeof n.insertMode?S.VideoInsertMode[n.insertMode]:r.insertMode:S.VideoInsertMode.APPEND,subscribeToAudio:"undefined"===typeof n.subscribeToAudio||n.subscribeToAudio,subscribeToVideo:"undefined"===typeof n.subscribeToVideo||n.subscribeToVideo}:{insertMode:S.VideoInsertMode.APPEND,subscribeToAudio:!0,subscribeToVideo:!0};var o=void 0;if(n&&"function"===typeof n?o=n:i&&(o=i),!this.sessionConnected())throw void 0!==o&&o(this.notConnectedError()),this.notConnectedError();O.info("Subscribing to "+e.connection.connectionId),e.subscribe().then((function(){O.info("Subscribed correctly to "+e.connection.connectionId),void 0!==o&&o(void 0)})).catch((function(e){void 0!==o&&o(e)}));var s=new d.Subscriber(e,t,r);return s.targetElement&&e.streamManager.createVideoElement(s.targetElement,r.insertMode),s},t.prototype.subscribeAsync=function(e,t,n){var i=this;return new Promise((function(r,o){var s;i.sessionConnected()||o(i.notConnectedError());var a=function(e){e?o(e):r(s)};s=n?i.subscribe(e,t,n,a):i.subscribe(e,t,a)}))},t.prototype.unsubscribe=function(e){var t=this;return new Promise((function(n,i){if(t.sessionConnected()){var r=e.stream.connection.connectionId;O.info("Unsubscribing from "+r),t.openvidu.sendRequest("unsubscribeFromVideo",{sender:e.stream.connection.connectionId},(function(t,o){t?(O.error("Error unsubscribing from "+r),i(t)):(O.info("Unsubscribed correctly from "+r),e.stream.streamManager.removeAllVideos(),e.stream.disposeWebRtcPeer(),e.stream.disposeMediaStream(),n())}))}else i(t.notConnectedError())}))},t.prototype.publish=function(e){var t=this;return new Promise((function(n,i){t.sessionConnected()||i(t.notConnectedError()),e.session=t,e.stream.session=t,e.stream.publishedOnce?e.initialize().then((function(){t.connection.addStream(e.stream),e.reestablishStreamPlayingEvent(),e.stream.publish().then((function(){t.sendVideoData(e,8,!0,5),n()})).catch((function(e){i(e)}))})).catch((function(e){i(e)})):(t.connection.addStream(e.stream),e.stream.publish().then((function(){t.sendVideoData(e,8,!0,5),n()})).catch((function(e){i(e)})))}))},t.prototype.unpublish=function(e){var t=this;return new Promise((function(n,i){if(!t.sessionConnected())throw t.notConnectedError();var r=e.stream;r.connection?r.connection!==t.connection?i(new Error("The associated Connection object of this Publisher is not your local Connection.Only moderators can force unpublish on remote Streams via 'forceUnpublish' method")):(O.info("Unpublishing local media ("+r.connection.connectionId+")"),t.openvidu.sendRequest("unpublishVideo",(function(t,o){if(t)i(t);else{O.info("Media unpublished correctly"),r.disposeWebRtcPeer(),r.connection.stream==r&&delete r.connection.stream;var s=new m.StreamEvent(!0,e,"streamDestroyed",e.stream,"unpublish");e.emitEvent("streamDestroyed",[s]),s.callDefaultBehavior(),n()}}))):i(new Error("The associated Connection object of this Publisher is null"))}))},t.prototype.forceDisconnect=function(e){var t=this;return new Promise((function(n,i){t.sessionConnected()||i(t.notConnectedError()),O.info("Forcing disconnect for connection "+e.connectionId),t.openvidu.sendRequest("forceDisconnect",{connectionId:e.connectionId},(function(t,r){t?(O.error("Error forcing disconnect for Connection "+e.connectionId,t),401===t.code?i(new y.OpenViduError(y.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force a disconnection")):i(t)):(O.info("Forcing disconnect correctly for Connection "+e.connectionId),n())}))}))},t.prototype.forceUnpublish=function(e){var t=this;return new Promise((function(n,i){t.sessionConnected()||i(t.notConnectedError()),O.info("Forcing unpublish for stream "+e.streamId),t.openvidu.sendRequest("forceUnpublish",{streamId:e.streamId},(function(t,r){t?(O.error("Error forcing unpublish for Stream "+e.streamId,t),401===t.code?i(new y.OpenViduError(y.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force an unpublishing")):i(t)):(O.info("Forcing unpublish correctly for Stream "+e.streamId),n())}))}))},t.prototype.signal=function(e){var t=this;return new Promise((function(n,i){t.sessionConnected()||i(t.notConnectedError());var r={};if(e.to&&e.to.length>0){var o=[];e.to.forEach((function(e){e.connectionId&&o.push(e.connectionId)})),r.to=o}else r.to=[];r.data=e.data?e.data:"";var s=e.type?e.type:"signal";s&&"signal:"!==s.substring(0,7)&&(s="signal:"+s),r.type=s,t.openvidu.sendRequest("sendMessage",{message:JSON.stringify(r)},(function(e,t){e?i(e):n()}))}))},t.prototype.on=function(t,n){var i,r,o,s;return e.prototype.onAux.call(this,t,"Event '"+t+"' triggered by 'Session'",n),"publisherStartSpeaking"===t&&(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableHarkSpeakingEvent()})),(null===(r=null===(i=this.connection)||void 0===i?void 0:i.stream)||void 0===r?void 0:r.hasAudio)&&this.connection.stream.enableHarkSpeakingEvent()),"publisherStopSpeaking"===t&&(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableHarkStoppedSpeakingEvent()})),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.hasAudio)&&this.connection.stream.enableHarkStoppedSpeakingEvent()),this},t.prototype.once=function(t,n){var i,r,o,s;return e.prototype.onceAux.call(this,t,"Event '"+t+"' triggered once by 'Session'",n),"publisherStartSpeaking"===t&&(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableOnceHarkSpeakingEvent()})),(null===(r=null===(i=this.connection)||void 0===i?void 0:i.stream)||void 0===r?void 0:r.hasAudio)&&this.connection.stream.enableOnceHarkSpeakingEvent()),"publisherStopSpeaking"===t&&(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableOnceHarkStoppedSpeakingEvent()})),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.hasAudio)&&this.connection.stream.enableOnceHarkStoppedSpeakingEvent()),this},t.prototype.off=function(t,n){var i,r,o,s,a=this;return e.prototype.off.call(this,t,n),"publisherStartSpeaking"===t&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1)||(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.streamManager)&&(a.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,e.stream.streamManager)||e.stream.disableHarkSpeakingEvent(!1))})),(null===(r=null===(i=this.connection)||void 0===i?void 0:i.stream)||void 0===r?void 0:r.streamManager)&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkSpeakingEvent(!1)))),"publisherStopSpeaking"===t&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1)||(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.streamManager)&&(a.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,e.stream.streamManager)||e.stream.disableHarkStoppedSpeakingEvent(!1))})),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.streamManager)&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkStoppedSpeakingEvent(!1)))),this},t.prototype.onParticipantJoined=function(e){var t=this;this.getConnection(e.id,"").then((function(e){O.warn("Connection "+e.connectionId+" already exists in connections list")})).catch((function(n){var i=new a.Connection(t,e);t.remoteConnections.set(e.id,i),t.ee.emitEvent("connectionCreated",[new l.ConnectionEvent(!1,t,"connectionCreated",i,"")])}))},t.prototype.onParticipantLeft=function(e){var t=this;this.getRemoteConnection(e.connectionId,"onParticipantLeft").then((function(n){if(n.stream){var i=n.stream,r=new m.StreamEvent(!0,t,"streamDestroyed",i,e.reason);t.ee.emitEvent("streamDestroyed",[r]),r.callDefaultBehavior(),t.remoteStreamsCreated.delete(i.streamId)}t.remoteConnections.delete(n.connectionId),t.ee.emitEvent("connectionDestroyed",[new l.ConnectionEvent(!1,t,"connectionDestroyed",n,e.reason)])})).catch((function(e){O.error(e)}))},t.prototype.onParticipantPublished=function(e){var t,n=this,i=function(e){n.remoteConnections.set(e.connectionId,e),n.remoteStreamsCreated.get(e.stream.streamId)||n.ee.emitEvent("streamCreated",[new m.StreamEvent(!1,n,"streamCreated",e.stream,"")]),n.remoteStreamsCreated.set(e.stream.streamId,!0)};this.getRemoteConnection(e.id,"onParticipantPublished").then((function(n){t=n,e.metadata=n.data,t.remoteOptions=e,t.initRemoteStreams(e.streams),i(t)})).catch((function(r){t=new a.Connection(n,e),i(t)}))},t.prototype.onParticipantUnpublished=function(e){var t=this;e.connectionId===this.connection.connectionId?this.stopPublisherStream(e.reason):this.getRemoteConnection(e.connectionId,"onParticipantUnpublished").then((function(n){var i=new m.StreamEvent(!0,t,"streamDestroyed",n.stream,e.reason);t.ee.emitEvent("streamDestroyed",[i]),i.callDefaultBehavior();var r=n.stream.streamId;t.remoteStreamsCreated.delete(r),n.removeStream(r)})).catch((function(e){O.error(e)}))},t.prototype.onParticipantEvicted=function(e){e.connectionId===this.connection.connectionId&&this.sessionId&&!this.connection.disposed&&this.leave(!0,e.reason)},t.prototype.onNewMessage=function(e){var t=this;O.info("New signal: "+JSON.stringify(e));var n=e.type?e.type.replace(/^(signal:)/,""):void 0;e.from?this.getConnection(e.from,"Connection '"+e.from+"' unknown when 'onNewMessage'. Existing remote connections: "+JSON.stringify(this.remoteConnections.keys())+". Existing local connection: "+this.connection.connectionId).then((function(i){t.ee.emitEvent("signal",[new v.SignalEvent(t,n,e.data,i)]),e.type&&"signal"!==e.type&&t.ee.emitEvent(e.type,[new v.SignalEvent(t,n,e.data,i)])})).catch((function(e){O.error(e)})):(this.ee.emitEvent("signal",[new v.SignalEvent(this,n,e.data,void 0)]),e.type&&"signal"!==e.type&&this.ee.emitEvent(e.type,[new v.SignalEvent(this,n,e.data,void 0)]))},t.prototype.onStreamPropertyChanged=function(e){var t=this,n=function(n){if(n.stream&&n.stream.streamId===e.streamId){var i=n.stream,r=void 0;switch(e.property){case"audioActive":r=i.audioActive,e.newValue="true"===e.newValue,i.audioActive=e.newValue;break;case"videoActive":r=i.videoActive,e.newValue="true"===e.newValue,i.videoActive=e.newValue;break;case"videoDimensions":r=i.videoDimensions,e.newValue=JSON.parse(JSON.parse(e.newValue)),i.videoDimensions=e.newValue;break;case"filter":r=i.filter,e.newValue=Object.keys(e.newValue).length>0?e.newValue:void 0,void 0!==e.newValue?(i.filter=new c.Filter(e.newValue.type,e.newValue.options),i.filter.stream=i,e.newValue.lastExecMethod&&(i.filter.lastExecMethod=e.newValue.lastExecMethod)):delete i.filter,e.newValue=i.filter}t.ee.emitEvent("streamPropertyChanged",[new g.StreamPropertyChangedEvent(t,i,e.property,e.newValue,r,e.reason)]),i.streamManager&&i.streamManager.emitEvent("streamPropertyChanged",[new g.StreamPropertyChangedEvent(i.streamManager,i,e.property,e.newValue,r,e.reason)])}else O.error("No stream with streamId '"+e.streamId+"' found for connection '"+e.connectionId+"' on 'streamPropertyChanged' event")};e.connectionId===this.connection.connectionId?n(this.connection):this.getRemoteConnection(e.connectionId,"onStreamPropertyChanged").then((function(e){n(e)})).catch((function(e){O.error(e)}))},t.prototype.onConnectionPropertyChanged=function(e){var t;switch(e.property){case"role":t=this.connection.role.slice(),this.connection.role=e.newValue,this.connection.localOptions.role=e.newValue;break;case"record":t=this.connection.record,e.newValue="true"===e.newValue,this.connection.record=e.newValue,this.connection.localOptions.record=e.newValue}this.ee.emitEvent("connectionPropertyChanged",[new b.ConnectionPropertyChangedEvent(this,this.connection,e.property,e.newValue,t)])},t.prototype.onNetworkQualityLevelChangedChanged=function(e){var t=this;e.connectionId===this.connection.connectionId?this.ee.emitEvent("networkQualityLevelChanged",[new E.NetworkQualityLevelChangedEvent(this,e.newValue,e.oldValue,this.connection)]):this.getConnection(e.connectionId,"Connection not found for connectionId "+e.connectionId).then((function(n){t.ee.emitEvent("networkQualityLevelChanged",[new E.NetworkQualityLevelChangedEvent(t,e.newValue,e.oldValue,n)])})).catch((function(e){O.error(e)}))},t.prototype.recvIceCandidate=function(e){var t={candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex,component:null,foundation:null,port:null,priority:null,protocol:null,relatedAddress:null,relatedPort:null,tcpType:null,usernameFragment:null,type:null,toJSON:function(){return{candidate:e.candidate}}};this.getConnection(e.senderConnectionId,"Connection not found for connectionId "+e.senderConnectionId+" owning endpoint "+e.endpointName+". Ice candidate will be ignored: "+t).then((function(n){var i=n.stream;i.getWebRtcPeer().addIceCandidate(t).catch((function(t){O.error("Error adding candidate for "+i.streamId+" stream of endpoint "+e.endpointName+": "+t)}))})).catch((function(e){O.error(e)}))},t.prototype.onSessionClosed=function(e){O.info("Session closed: "+JSON.stringify(e));var t=e.sessionId;void 0!==t?this.ee.emitEvent("session-closed",[{session:t}]):O.warn("Session undefined on session closed",e)},t.prototype.onLostConnection=function(e){O.warn("Lost connection in Session "+this.sessionId),this.sessionId&&this.connection&&!this.connection.disposed&&this.leave(!0,e)},t.prototype.onRecoveredConnection=function(){O.info("Recovered connection in Session "+this.sessionId),this.reconnectBrokenStreams(),this.ee.emitEvent("reconnected",[])},t.prototype.onMediaError=function(e){O.error("Media error: "+JSON.stringify(e));var t=e.error;t?this.ee.emitEvent("error-media",[{error:t}]):O.warn("Received undefined media error:",e)},t.prototype.onRecordingStarted=function(e){this.ee.emitEvent("recordingStarted",[new h.RecordingEvent(this,"recordingStarted",e.id,e.name)])},t.prototype.onRecordingStopped=function(e){this.ee.emitEvent("recordingStopped",[new h.RecordingEvent(this,"recordingStopped",e.id,e.name,e.reason)])},t.prototype.onFilterEventDispatched=function(e){var t=this,n=e.connectionId;this.getConnection(n,"No connection found for connectionId "+n).then((function(n){var i;O.info("Filter event dispatched");var r=n.stream;null===(i=r.filter.handlers.get(e.eventType))||void 0===i||i.call(t,new p.FilterEvent(r.filter,e.eventType,e.data))}))},t.prototype.onForciblyReconnectSubscriber=function(e){var t=this;return new Promise((function(n,i){t.getRemoteConnection(e.connectionId,"onForciblyReconnectSubscriber").then((function(r){if(r.stream&&r.stream.streamId===e.streamId){var o=r.stream;if(o.setupReconnectionEventEmitter(n,i)){if(null!=o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent)o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=e,i("Ongoing forced subscriber reconnection");else{o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=e;var s=function(){var e=o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent;delete o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent,t.onForciblyReconnectSubscriber(e)};o.reconnectionEventEmitter.once("success",(function(){s()})),o.reconnectionEventEmitter.once("error",(function(){s()}))}return}o.completeWebRtcPeerReceive(!0,!0,e.sdpOffer).then((function(){return o.finalResolveForSubscription(!0,n)})).catch((function(t){return o.finalRejectForSubscription(!0,"Error while forcibly reconnecting remote stream "+e.streamId+": "+t.toString(),i)}))}else{var a="No stream with streamId '"+e.streamId+"' found for connection '"+e.connectionId+"' on 'streamPropertyChanged' event";O.error(a),i(a)}})).catch((function(e){O.error(e),i(e)}))}))},t.prototype.reconnectBrokenStreams=function(){O.info("Re-establishing media connections...");var e=!1;this.connection.stream&&this.connection.stream.streamIceConnectionStateBroken()&&(O.warn("Re-establishing Publisher "+this.connection.stream.streamId),this.connection.stream.initWebRtcPeerSend(!0),e=!0),this.remoteConnections.forEach((function(t){t.stream&&t.stream.streamIceConnectionStateBroken()&&(O.warn("Re-establishing Subscriber "+t.stream.streamId),t.stream.initWebRtcPeerReceive(!0),e=!0)})),e||O.info("There were no media streams in need of a reconnection")},t.prototype.emitEvent=function(e,t){this.ee.emitEvent(e,t)},t.prototype.leave=function(e,t){var n=this;if(e=!!e,O.info("Leaving Session (forced="+e+")"),this.stopVideoDataIntervals(),this.connection){if(this.connection.disposed||e?this.openvidu.closeWs():this.openvidu.sendRequest("leaveRoom",(function(e,t){e&&O.error("leaveRoom error: "+JSON.stringify(e)),n.openvidu.closeWs()})),this.stopPublisherStream(t),!this.connection.disposed){var i=new f.SessionDisconnectedEvent(this,t);this.ee.emitEvent("sessionDisconnected",[i]),i.callDefaultBehavior()}}else O.warn("You were not connected to the session "+this.sessionId);O.flush()},t.prototype.initializeParams=function(e){return{token:e||"",session:this.sessionId,platform:s.getDescription()?s.getDescription():"unknown",metadata:this.options.metadata?this.options.metadata:"",secret:this.openvidu.getSecret(),recorder:this.openvidu.getRecorder()}},t.prototype.sendVideoData=function(e,t,n,i){var a,c,d=this;if(void 0===t&&(t=1),void 0===n&&(n=!1),void 0===i&&(i=1),s.isChromeBrowser()||s.isChromeMobileBrowser()||s.isOperaBrowser()||s.isOperaMobileBrowser()||s.isEdgeBrowser()||s.isEdgeMobileBrowser()||s.isElectron()||s.isSafariBrowser()&&!s.isIonicIos()||s.isAndroidBrowser()||s.isSamsungBrowser()||s.isIonicAndroid()||s.isIOSWithSafari()){var u=function(){return r(d,void 0,void 0,(function(){var t,n,i;return o(this,(function(r){switch(r.label){case 0:return"connected"!==(t=e.stream.getRTCPeerConnection()).connectionState?[3,2]:[4,t.getStats()];case 1:n=r.sent(),i=[],n.forEach((function(e){"frameWidth"in e&&"frameHeight"in e&&0===i.length&&i.push(e)})),i.length>0&&this.openvidu.sendRequest("videoData",{height:i[0].frameHeight,width:i[0].frameWidth,videoActive:null!=e.stream.videoActive&&e.stream.videoActive,audioActive:null!=e.stream.audioActive&&e.stream.audioActive},(function(e,t){e&&O.error("Error sending 'videoData' event",e)})),r.label=2;case 2:return[2]}}))}))};if(n){var l=1;this.videoDataInterval=setInterval((function(){l<i?(l++,u()):clearInterval(d.videoDataInterval)}),1e3*t)}else this.videoDataTimeout=setTimeout(u,1e3*t)}else s.isFirefoxBrowser()||s.isFirefoxMobileBrowser()||s.isIonicIos()||s.isReactNative()?this.openvidu.sendRequest("videoData",{height:(null===(a=e.stream.videoDimensions)||void 0===a?void 0:a.height)||0,width:(null===(c=e.stream.videoDimensions)||void 0===c?void 0:c.width)||0,videoActive:null!=e.stream.videoActive&&e.stream.videoActive,audioActive:null!=e.stream.audioActive&&e.stream.audioActive},(function(e,t){e&&O.error("Error sending 'videoData' event",e)})):O.error("Browser "+s.getName()+" (version "+s.getVersion()+") for "+s.getFamily()+" is not supported in OpenVidu for Network Quality")},t.prototype.sessionConnected=function(){return null!=this.connection},t.prototype.notConnectedError=function(){return new y.OpenViduError(y.OpenViduErrorName.OPENVIDU_NOT_CONNECTED,"There is no connection to the session. Method 'Session.connect' must be successfully completed first")},t.prototype.anySpeechEventListenerEnabled=function(e,t,n){var i=this.ee.getListeners(e);if(t&&(i=i.filter((function(e){return e.once}))),i.length>0)return!0;var r=0;if(n){var o=n.ee.getListeners(e);t&&(o=o.filter((function(e){return e.once}))),r=o.length}return r>0},t.prototype.connectAux=function(e){var t=this;return new Promise((function(n,i){t.openvidu.startWs((function(r){if(r)i(r);else{var o=t.initializeParams(e);t.openvidu.sendRequest("joinRoom",o,(function(r,o){if(r)i(r);else{t.processJoinRoomResponse(o),w.OpenViduLogger.configureJSNLog(t.openvidu,e),t.connection=new a.Connection(t,o);var s={connections:new Array,streams:new Array};o.value.forEach((function(e){var n=new a.Connection(t,e);t.remoteConnections.set(n.connectionId,n),s.connections.push(n),n.stream&&(t.remoteStreamsCreated.set(n.stream.streamId,!0),s.streams.push(n.stream))})),t.ee.emitEvent("connectionCreated",[new l.ConnectionEvent(!1,t,"connectionCreated",t.connection,"")]),s.connections.forEach((function(e){t.ee.emitEvent("connectionCreated",[new l.ConnectionEvent(!1,t,"connectionCreated",e,"")])})),s.streams.forEach((function(e){t.ee.emitEvent("streamCreated",[new m.StreamEvent(!1,t,"streamCreated",e,"")])})),n()}}))}}))}))},t.prototype.stopPublisherStream=function(e){this.connection.stream&&(this.connection.stream.disposeWebRtcPeer(),this.connection.stream.isLocalStreamPublished&&this.connection.stream.ee.emitEvent("local-stream-destroyed",[e]))},t.prototype.stopVideoDataIntervals=function(){clearInterval(this.videoDataInterval),clearTimeout(this.videoDataTimeout)},t.prototype.stringClientMetadata=function(e){return"string"!==typeof e?JSON.stringify(e):e},t.prototype.getConnection=function(e,t){var n=this;return new Promise((function(i,r){var o=n.remoteConnections.get(e);o?i(o):n.connection.connectionId===e?i(n.connection):r(new y.OpenViduError(y.OpenViduErrorName.GENERIC_ERROR,t))}))},t.prototype.getRemoteConnection=function(e,t){var n=this;return new Promise((function(i,r){var o=n.remoteConnections.get(e);if(o)i(o);else{var s="Remote connection "+e+" unknown when '"+t+"'. Existing remote connections: "+JSON.stringify(n.remoteConnections.keys());r(new y.OpenViduError(y.OpenViduErrorName.GENERIC_ERROR,s))}}))},t.prototype.processToken=function(e){var t=e.match(/^(wss?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);if(t){var n={protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7]},i=e.split("?"),r=decodeURI(i[1]).split("&").map((function(e){return e.split("=")})).reduce((function(e,t){var n=t[0],i=t[1];return e[n]=i,e}),{});this.sessionId=r.sessionId;var o=r.secret,s=r.recorder,a=r.webrtcStatsInterval,c=r.sendBrowserLogs;o&&(this.openvidu.secret=o),s&&(this.openvidu.recorder=!0),a&&(this.openvidu.webrtcStatsInterval=+a),c&&(this.openvidu.sendBrowserLogs=c),this.openvidu.isPro=!!a&&!!c,this.openvidu.wsUri="wss://"+n.host+"/openvidu",this.openvidu.httpUri="https://"+n.host}else O.error('Token "'+e+'" is not valid')},t.prototype.processJoinRoomResponse=function(e){if(this.sessionId=e.session,null!=e.coturnIp&&null!=e.turnUsername&&null!=e.turnCredential){var t="turn:"+e.coturnIp+":3478";this.openvidu.iceServers=[{urls:[t],username:e.turnUsername,credential:e.turnCredential}],O.log("STUN/TURN server IP: "+e.coturnIp),O.log("TURN temp credentials ["+e.turnUsername+":"+e.turnCredential+"]")}this.openvidu.role=e.role,this.openvidu.finalUserId=e.finalUserId,this.openvidu.mediaServer=e.mediaServer,this.capabilities={subscribe:!0,publish:"SUBSCRIBER"!==this.openvidu.role,forceUnpublish:"MODERATOR"===this.openvidu.role,forceDisconnect:"MODERATOR"===this.openvidu.role},O.info("openvidu-server version: "+e.version),null!=e.life&&(this.openvidu.life=e.life),e.version!==this.openvidu.libraryVersion&&O.warn("OpenVidu Server ("+e.version+") and OpenVidu Browser ("+this.openvidu.libraryVersion+") versions do NOT match. There may be incompatibilities")},t}(u.EventDispatcher);t.Session=I},7686:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Stream=void 0;var o,s=n(6153),a=n(4980),c=n(734),d=n(7137),u=n(6056),l=n(8271),p=n(3977),h=n(7614),f=n(7009),v=n(5364),m=n(5971),g=n(8233),b=n(4795),E=v.OpenViduLogger.getInstance(),y=function(){function e(e,t){var n=this;this.isSubscribeToRemote=!1,this.isLocalStreamReadyToPublish=!1,this.isLocalStreamPublished=!1,this.publishedOnce=!1,this.harkSpeakingEnabled=!1,this.harkSpeakingEnabledOnce=!1,this.harkStoppedSpeakingEnabled=!1,this.harkStoppedSpeakingEnabledOnce=!1,this.harkVolumeChangeEnabled=!1,this.harkVolumeChangeEnabledOnce=!1,this.ee=new b,o=m.PlatformUtils.getInstance(),this.session=e,t.hasOwnProperty("id")?(this.inboundStreamOpts=t,this.streamId=this.inboundStreamOpts.id,this.creationTime=this.inboundStreamOpts.createdAt,this.hasAudio=this.inboundStreamOpts.hasAudio,this.hasVideo=this.inboundStreamOpts.hasVideo,this.hasAudio&&(this.audioActive=this.inboundStreamOpts.audioActive),this.hasVideo&&(this.videoActive=this.inboundStreamOpts.videoActive,this.typeOfVideo=this.inboundStreamOpts.typeOfVideo?this.inboundStreamOpts.typeOfVideo:void 0,this.frameRate=-1===this.inboundStreamOpts.frameRate?void 0:this.inboundStreamOpts.frameRate,this.videoDimensions=this.inboundStreamOpts.videoDimensions),this.inboundStreamOpts.filter&&Object.keys(this.inboundStreamOpts.filter).length>0&&(this.inboundStreamOpts.filter.lastExecMethod&&0===Object.keys(this.inboundStreamOpts.filter.lastExecMethod).length&&delete this.inboundStreamOpts.filter.lastExecMethod,this.filter=this.inboundStreamOpts.filter)):(this.outboundStreamOpts=t,this.hasAudio=this.isSendAudio(),this.hasVideo=this.isSendVideo(),this.hasAudio&&(this.audioActive=!!this.outboundStreamOpts.publisherProperties.publishAudio),this.hasVideo&&(this.videoActive=!!this.outboundStreamOpts.publisherProperties.publishVideo,this.frameRate=this.outboundStreamOpts.publisherProperties.frameRate,"undefined"!==typeof MediaStreamTrack&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?this.typeOfVideo="CUSTOM":this.typeOfVideo=this.isSendScreen()?"SCREEN":"CAMERA"),this.outboundStreamOpts.publisherProperties.filter&&(this.filter=this.outboundStreamOpts.publisherProperties.filter)),this.ee.on("mediastream-updated",(function(){n.streamManager.updateMediaStream(n.mediaStream),E.debug("Video srcObject ["+n.mediaStream+"] updated in stream ["+n.streamId+"]")}))}return e.prototype.reconnect=function(){return this.reconnectStream("API")},e.prototype.applyFilter=function(e,t){var n=this;return new Promise((function(i,r){n.session.sessionConnected()||r(n.session.notConnectedError()),E.info("Applying filter to stream "+n.streamId);var o=t=null!=t?t:{};"string"!==typeof o&&(o=JSON.stringify(o)),n.session.openvidu.sendRequest("applyFilter",{streamId:n.streamId,type:e,options:o},(function(o,a){if(o)E.error("Error applying filter for Stream "+n.streamId,o),401===o.code?r(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to apply a filter")):r(o);else{E.info("Filter successfully applied on Stream "+n.streamId);var c=n.filter;n.filter=new s.Filter(e,t),n.filter.stream=n,n.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(n.session,n,"filter",n.filter,c,"applyFilter")]),n.streamManager.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(n.streamManager,n,"filter",n.filter,c,"applyFilter")]),i(n.filter)}}))}))},e.prototype.removeFilter=function(){var e=this;return new Promise((function(t,n){e.session.sessionConnected()||n(e.session.notConnectedError()),E.info("Removing filter of stream "+e.streamId),e.session.openvidu.sendRequest("removeFilter",{streamId:e.streamId},(function(i,r){if(i)E.error("Error removing filter for Stream "+e.streamId,i),401===i.code?n(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to remove a filter")):n(i);else{E.info("Filter successfully removed from Stream "+e.streamId);var o=e.filter;delete e.filter,e.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(e.session,e,"filter",e.filter,o,"applyFilter")]),e.streamManager.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(e.streamManager,e,"filter",e.filter,o,"applyFilter")]),t()}}))}))},e.prototype.getRTCPeerConnection=function(){return this.webRtcPeer.pc},e.prototype.getMediaStream=function(){return this.mediaStream},e.prototype.setMediaStream=function(e){this.mediaStream=e},e.prototype.updateMediaStreamInVideos=function(){this.ee.emitEvent("mediastream-updated",[])},e.prototype.getWebRtcPeer=function(){return this.webRtcPeer},e.prototype.subscribeToMyRemote=function(e){this.isSubscribeToRemote=e},e.prototype.setOutboundStreamOptions=function(e){this.outboundStreamOpts=e},e.prototype.subscribe=function(){var e=this;return new Promise((function(t,n){e.initWebRtcPeerReceive(!1).then((function(){t()})).catch((function(e){n(e)}))}))},e.prototype.publish=function(){var e=this;return new Promise((function(t,n){e.isLocalStreamReadyToPublish?e.initWebRtcPeerSend(!1).then((function(){t()})).catch((function(e){n(e)})):e.ee.once("stream-ready-to-publish",(function(){e.publish().then((function(){t()})).catch((function(e){n(e)}))}))}))},e.prototype.disposeWebRtcPeer=function(){var e;this.webRtcPeer&&(this.webRtcPeer.dispose(),e=this.webRtcPeer.getId()),this.stopWebRtcStats(),E.info((this.outboundStreamOpts?"Outbound ":"Inbound ")+"RTCPeerConnection with id ["+e+"] from 'Stream' with id ["+this.streamId+"] is now closed")},e.prototype.disposeMediaStream=function(){this.mediaStream&&(this.mediaStream.getAudioTracks().forEach((function(e){e.stop()})),this.mediaStream.getVideoTracks().forEach((function(e){e.stop()})),delete this.mediaStream),this.localMediaStreamWhenSubscribedToRemote&&(this.localMediaStreamWhenSubscribedToRemote.getAudioTracks().forEach((function(e){e.stop()})),this.localMediaStreamWhenSubscribedToRemote.getVideoTracks().forEach((function(e){e.stop()})),delete this.localMediaStreamWhenSubscribedToRemote),this.speechEvent&&(this.speechEvent.stop&&this.speechEvent.stop(),delete this.speechEvent),E.info((this.outboundStreamOpts?"Local ":"Remote ")+"MediaStream from 'Stream' with id ["+this.streamId+"] is now disposed")},e.prototype.displayMyRemote=function(){return this.isSubscribeToRemote},e.prototype.isSendAudio=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.audioSource&&!1!==this.outboundStreamOpts.publisherProperties.audioSource},e.prototype.isSendVideo=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.videoSource&&!1!==this.outboundStreamOpts.publisherProperties.videoSource},e.prototype.isSendScreen=function(){var e="screen"===this.outboundStreamOpts.publisherProperties.videoSource;return o.isElectron()&&(e="string"===typeof this.outboundStreamOpts.publisherProperties.videoSource&&this.outboundStreamOpts.publisherProperties.videoSource.startsWith("screen:")),!!this.outboundStreamOpts&&e},e.prototype.enableHarkSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),this.harkSpeakingEnabled||(this.harkSpeakingEnabled=!0,this.speechEvent.on("speaking",(function(){e.session.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStartSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStartSpeaking",e.connection,e.streamId)]),e.harkSpeakingEnabledOnce=!1})))},e.prototype.enableOnceHarkSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),this.harkSpeakingEnabledOnce||(this.harkSpeakingEnabledOnce=!0,this.speechEvent.once("speaking",(function(){e.harkSpeakingEnabledOnce&&(e.session.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStartSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStartSpeaking",e.connection,e.streamId)])),e.disableHarkSpeakingEvent(!0)})))},e.prototype.disableHarkSpeakingEvent=function(e){if(this.speechEvent){if(this.harkSpeakingEnabledOnce=!1,e){if(this.harkSpeakingEnabled)return}else this.harkSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkStoppedSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),this.harkStoppedSpeakingEnabled||(this.harkStoppedSpeakingEnabled=!0,this.speechEvent.on("stopped_speaking",(function(){e.session.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStopSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStopSpeaking",e.connection,e.streamId)]),e.harkStoppedSpeakingEnabledOnce=!1})))},e.prototype.enableOnceHarkStoppedSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),this.harkStoppedSpeakingEnabledOnce||(this.harkStoppedSpeakingEnabledOnce=!0,this.speechEvent.once("stopped_speaking",(function(){e.harkStoppedSpeakingEnabledOnce&&(e.session.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStopSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStopSpeaking",e.connection,e.streamId)])),e.disableHarkStoppedSpeakingEvent(!0)})))},e.prototype.disableHarkStoppedSpeakingEvent=function(e){if(this.speechEvent){if(this.harkStoppedSpeakingEnabledOnce=!1,e){if(this.harkStoppedSpeakingEnabled)return}else this.harkStoppedSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce?this.speechEvent.off("stopped_speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkVolumeChangeEvent=function(e){var t=this;this.setHarkListenerIfNotExists()?this.harkVolumeChangeEnabled&&!e||(this.harkVolumeChangeEnabled=!0,this.speechEvent.on("volume_change",(function(e){var n={newValue:e,oldValue:t.speechEvent.oldVolumeValue};t.speechEvent.oldVolumeValue=e,t.streamManager.emitEvent("streamAudioVolumeChange",[new p.StreamManagerEvent(t.streamManager,"streamAudioVolumeChange",n)])}))):this.harkVolumeChangeEnabled=!0},e.prototype.enableOnceHarkVolumeChangeEvent=function(e){var t=this;this.setHarkListenerIfNotExists()?this.harkVolumeChangeEnabledOnce&&!e||(this.harkVolumeChangeEnabledOnce=!0,this.speechEvent.once("volume_change",(function(e){var n={newValue:e,oldValue:t.speechEvent.oldVolumeValue};t.speechEvent.oldVolumeValue=e,t.disableHarkVolumeChangeEvent(!0),t.streamManager.emitEvent("streamAudioVolumeChange",[new p.StreamManagerEvent(t.streamManager,"streamAudioVolumeChange",n)])}))):this.harkVolumeChangeEnabledOnce=!0},e.prototype.disableHarkVolumeChangeEvent=function(e){if(this.speechEvent){if(this.harkVolumeChangeEnabledOnce=!1,e){if(this.harkVolumeChangeEnabled)return}else this.harkVolumeChangeEnabled=!1;this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("volume_change"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.isLocal=function(){return!this.inboundStreamOpts&&!!this.outboundStreamOpts},e.prototype.getSelectedIceCandidate=function(){var e=this;return new Promise((function(t,n){e.webRtcStats.getSelectedIceCandidateInfo().then((function(e){return t(e)})).catch((function(e){return n(e)}))}))},e.prototype.getRemoteIceCandidateList=function(){return this.webRtcPeer.remoteCandidatesQueue},e.prototype.getLocalIceCandidateList=function(){return this.webRtcPeer.localCandidatesQueue},e.prototype.streamIceConnectionStateBroken=function(){if(!this.getWebRtcPeer()||!this.getRTCPeerConnection())return!1;if(this.isLocal()&&this.session.openvidu.advancedConfiguration.forceMediaReconnectionAfterNetworkDrop)return E.warn('OpenVidu Browser advanced configuration option "forceMediaReconnectionAfterNetworkDrop" is enabled. Stream '+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") will force a reconnection"),!0;var e=this.getRTCPeerConnection().iceConnectionState;return"connected"!==e&&"completed"!==e},e.prototype.setHarkListenerIfNotExists=function(){if(this.mediaStream){if(!this.speechEvent){var e=this.harkOptions?this.harkOptions:this.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{};e.interval="number"===typeof e.interval?e.interval:100,e.threshold="number"===typeof e.threshold?e.threshold:-50,this.speechEvent=g(this.mediaStream,e)}return!0}return!1},e.prototype.setupReconnectionEventEmitter=function(e,t){return void 0==this.reconnectionEventEmitter?(this.reconnectionEventEmitter=new b,!1):(console.warn("Trying to reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") but an ongoing reconnection process is active. Waiting for response..."),this.reconnectionEventEmitter.once("success",(function(){e()})),this.reconnectionEventEmitter.once("error",(function(e){t(e)})),!0)},e.prototype.initWebRtcPeerSend=function(e){var t=this;return new Promise((function(n,i){if(e){if(t.setupReconnectionEventEmitter(n,i))return}else t.initHarkEvents();var r=function(n){var r;e&&(null===(r=t.reconnectionEventEmitter)||void 0===r||r.emitEvent("error",[n]),delete t.reconnectionEventEmitter),i(n)},o=function(i){E.debug("Sending SDP offer to publish as "+t.streamId,i);var o,s=e?"reconnectStream":"publishVideo";if(e)o={stream:t.streamId,sdpString:i};else{var a="";t.isSendVideo()&&(a="undefined"!==typeof MediaStreamTrack&&t.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?"CUSTOM":t.isSendScreen()?"SCREEN":"CAMERA"),o={doLoopback:t.displayMyRemote()||!1,hasAudio:t.isSendAudio(),hasVideo:t.isSendVideo(),audioActive:t.audioActive,videoActive:t.videoActive,typeOfVideo:a,frameRate:t.frameRate?t.frameRate:-1,videoDimensions:JSON.stringify(t.videoDimensions),filter:t.outboundStreamOpts.publisherProperties.filter,sdpOffer:i}}t.session.openvidu.sendRequest(s,o,(function(i,o){i?401===i.code?r(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to publish")):r("Error on publishVideo: "+JSON.stringify(i)):t.webRtcPeer.processRemoteAnswer(o.sdpAnswer).then((function(){t.streamId=o.id,t.creationTime=o.createdAt,t.isLocalStreamPublished=!0,t.publishedOnce=!0,t.displayMyRemote()&&(t.localMediaStreamWhenSubscribedToRemote=t.mediaStream,t.remotePeerSuccessfullyEstablished(e)),e?t.ee.emitEvent("stream-reconnected-by-publisher",[]):t.ee.emitEvent("stream-created-by-publisher",[]),t.initWebRtcStats(),E.info("'Publisher' ("+t.streamId+") successfully "+(e?"reconnected":"published")+" to session"),function(){var i;e&&(null===(i=t.reconnectionEventEmitter)||void 0===i||i.emitEvent("success"),delete t.reconnectionEventEmitter),n()}()})).catch((function(e){r(e)}))}))},s={mediaConstraints:{audio:t.hasAudio,video:t.hasVideo},simulcast:t.session.openvidu.advancedConfiguration.enableSimulcastExperimental||!1,onIceCandidate:t.connection.sendIceCandidate.bind(t.connection),onIceConnectionStateException:function(e,n,i){t.session.emitEvent("exception",[new u.ExceptionEvent(t.session,e,t,n,i)])},iceServers:t.getIceServersConf(),mediaStream:t.mediaStream,mediaServer:t.session.openvidu.mediaServer};e&&t.disposeWebRtcPeer(),t.displayMyRemote()?t.webRtcPeer=new c.WebRtcPeerSendrecv(s):t.webRtcPeer=new c.WebRtcPeerSendonly(s),t.webRtcPeer.addIceConnectionStateChangeListener("publisher of "+t.connection.connectionId),t.webRtcPeer.createOffer().then((function(e){t.webRtcPeer.processLocalOffer(e).then((function(){o(e.sdp)})).catch((function(e){r(new Error("(publish) SDP process local offer error: "+JSON.stringify(e)))}))})).catch((function(e){r(new Error("(publish) SDP create offer error: "+JSON.stringify(e)))}))}))},e.prototype.finalResolveForSubscription=function(e,t){var n;E.info("'Subscriber' ("+this.streamId+") successfully "+(e?"reconnected":"subscribed")),this.remotePeerSuccessfullyEstablished(e),this.initWebRtcStats(),e&&(null===(n=this.reconnectionEventEmitter)||void 0===n||n.emitEvent("success"),delete this.reconnectionEventEmitter),t()},e.prototype.finalRejectForSubscription=function(e,t,n){var i;E.error("Error for 'Subscriber' ("+this.streamId+") while trying to "+(e?"reconnect":"subscribe")+": "+t.toString()),e&&(null===(i=this.reconnectionEventEmitter)||void 0===i||i.emitEvent("error",[t]),delete this.reconnectionEventEmitter),n(t)},e.prototype.initWebRtcPeerReceive=function(e){var t=this;return new Promise((function(n,i){e&&t.setupReconnectionEventEmitter(n,i)||("mediasoup"===t.session.openvidu.mediaServer?t.initWebRtcPeerReceiveFromServer(e).then((function(){return t.finalResolveForSubscription(e,n)})).catch((function(n){return t.finalRejectForSubscription(e,n,i)})):t.initWebRtcPeerReceiveFromClient(e).then((function(){return t.finalResolveForSubscription(e,n)})).catch((function(n){return t.finalRejectForSubscription(e,n,i)})))}))},e.prototype.initWebRtcPeerReceiveFromClient=function(e){var t=this;return new Promise((function(n,i){t.completeWebRtcPeerReceive(e,!1).then((function(e){t.webRtcPeer.processRemoteAnswer(e.sdpAnswer).then((function(){return n()})).catch((function(e){return i(e)}))})).catch((function(e){return i(e)}))}))},e.prototype.initWebRtcPeerReceiveFromServer=function(e){var t=this;return new Promise((function(n,i){t.session.openvidu.sendRequest("prepareReceiveVideoFrom",{sender:t.streamId,reconnect:e},(function(r,o){r?i(new Error("Error on prepareReceiveVideoFrom: "+JSON.stringify(r))):t.completeWebRtcPeerReceive(e,!1,o.sdpOffer).then((function(){return n()})).catch((function(e){return i(e)}))}))}))},e.prototype.completeWebRtcPeerReceive=function(e,t,n){var i=this;return new Promise((function(r,o){E.debug("'Session.subscribe(Stream)' called");var s=function(s){E.debug("Sending local SDP "+(n?"answer":"offer")+" to subscribe to "+i.streamId,s);var a=e?"reconnectStream":"receiveVideoFrom",c={};c[e?"stream":"sender"]=i.streamId,n?c[e?"sdpString":"sdpAnswer"]=s:c.sdpOffer=s,e&&(c.forciblyReconnect=t),i.session.openvidu.sendRequest(a,c,(function(e,t){e?o(new Error("Error on "+a+" : "+JSON.stringify(e))):r(t)}))},a={mediaConstraints:{audio:i.hasAudio,video:i.hasVideo},simulcast:!1,onIceCandidate:i.connection.sendIceCandidate.bind(i.connection),onIceConnectionStateException:function(e,t,n){i.session.emitEvent("exception",[new u.ExceptionEvent(i.session,e,i,t,n)])},iceServers:i.getIceServersConf(),mediaServer:i.session.openvidu.mediaServer};e&&i.disposeWebRtcPeer(),i.webRtcPeer=new c.WebRtcPeerRecvonly(a),i.webRtcPeer.addIceConnectionStateChangeListener(i.streamId),n?i.webRtcPeer.processRemoteOffer(n).then((function(){i.webRtcPeer.createAnswer().then((function(e){i.webRtcPeer.processLocalAnswer(e).then((function(){s(e.sdp)})).catch((function(e){o(new Error("(subscribe) SDP process local answer error: "+JSON.stringify(e)))}))})).catch((function(e){o(new Error("(subscribe) SDP create answer error: "+JSON.stringify(e)))}))})).catch((function(e){o(new Error("(subscribe) SDP process remote offer error: "+JSON.stringify(e)))})):i.webRtcPeer.createOffer().then((function(e){i.webRtcPeer.processLocalOffer(e).then((function(){s(e.sdp)})).catch((function(e){o(new Error("(subscribe) SDP process local offer error: "+JSON.stringify(e)))}))})).catch((function(e){o(new Error("(subscribe) SDP create offer error: "+JSON.stringify(e)))}))}))},e.prototype.remotePeerSuccessfullyEstablished=function(e){var t;e&&null!=this.mediaStream&&this.disposeMediaStream(),this.mediaStream=new MediaStream;for(var n=0,i=this.webRtcPeer.pc.getReceivers();n<i.length;n++)(t=i[n]).track&&this.mediaStream.addTrack(t.track);if(E.debug("Peer remote stream",this.mediaStream),this.mediaStream){if(this.streamManager instanceof a.Subscriber){if(this.mediaStream.getAudioTracks()[0]){var r=e?this.audioActive:!!this.streamManager.properties.subscribeToAudio;this.mediaStream.getAudioTracks()[0].enabled=r}if(this.mediaStream.getVideoTracks()[0]){r=e?this.videoActive:!!this.streamManager.properties.subscribeToVideo;this.mediaStream.getVideoTracks()[0].enabled=r}}this.updateMediaStreamInVideos(),this.initHarkEvents()}},e.prototype.initHarkEvents=function(){this.mediaStream.getAudioTracks()[0]&&(this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!0,this.streamManager)&&this.enableOnceHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.streamManager)&&this.enableHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!0,this.streamManager)&&this.enableOnceHarkStoppedSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.streamManager)&&this.enableHarkStoppedSpeakingEvent(),this.harkVolumeChangeEnabledOnce&&this.enableOnceHarkVolumeChangeEvent(!0),this.harkVolumeChangeEnabled&&this.enableHarkVolumeChangeEvent(!0))},e.prototype.onIceConnectionStateExceptionHandler=function(e,t,n){switch(e){case u.ExceptionEventName.ICE_CONNECTION_FAILED:this.onIceConnectionFailed();break;case u.ExceptionEventName.ICE_CONNECTION_DISCONNECTED:this.onIceConnectionDisconnected()}this.session.emitEvent("exception",[new u.ExceptionEvent(this.session,e,this,t,n)])},e.prototype.onIceConnectionFailed=function(){E.log("[ICE_CONNECTION_FAILED] Handling ICE_CONNECTION_FAILED event. Reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+")"),this.reconnectStreamAndLogResultingIceConnectionState(u.ExceptionEventName.ICE_CONNECTION_FAILED)},e.prototype.onIceConnectionDisconnected=function(){var e=this;E.log("[ICE_CONNECTION_DISCONNECTED] Handling ICE_CONNECTION_DISCONNECTED event. Waiting for ICE to be restored and reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") if not possible");var t=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3;this.awaitWebRtcPeerConnectionState(t).then((function(n){switch(n){case"failed":E.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream "+e.streamId+" ("+(e.isLocal()?"Publisher":"Subscriber")+") is now failed after ICE_CONNECTION_DISCONNECTED");break;case"connected":case"completed":E.log("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream "+e.streamId+" ("+(e.isLocal()?"Publisher":"Subscriber")+") automatically restored after ICE_CONNECTION_DISCONNECTED. Current ICE connection state: "+n);break;case"closed":case"checking":case"new":case"disconnected":E.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream "+e.streamId+" ("+(e.isLocal()?"Publisher":"Subscriber")+") couldn't be restored after ICE_CONNECTION_DISCONNECTED event. Current ICE connection state after "+t+" ms: "+n),e.reconnectStreamAndLogResultingIceConnectionState(u.ExceptionEventName.ICE_CONNECTION_DISCONNECTED)}}))},e.prototype.reconnectStreamAndLogResultingIceConnectionState=function(e){return i(this,void 0,void 0,(function(){var t,n;return r(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.reconnectStreamAndReturnIceConnectionState(e)];case 1:switch(t=i.sent()){case"connected":case"completed":E.log("["+e+"] Stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") successfully reconnected after "+e+". Current ICE connection state: "+t);break;default:E.error("["+e+"] Stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") failed to reconnect after "+e+". Current ICE connection state: "+t)}return[3,3];case 2:return n=i.sent(),E.error("["+e+"] Error reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") after "+e+": "+n),[3,3];case 3:return[2]}}))}))},e.prototype.reconnectStreamAndReturnIceConnectionState=function(e){return i(this,void 0,void 0,(function(){var t,n;return r(this,(function(i){switch(i.label){case 0:E.log("["+e+"] Reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") after event "+e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.reconnectStream(e)];case 2:return i.sent(),t=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3,[2,this.awaitWebRtcPeerConnectionState(t)];case 3:return n=i.sent(),E.warn("["+e+"] Error reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+"). Reason: "+n),[2,this.awaitWebRtcPeerConnectionState(1)];case 4:return[2]}}))}))},e.prototype.reconnectStream=function(e){return i(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return[4,this.isWebsocketConnected(e,3e3)];case 1:if(n.sent())return E.log("["+e+"] Trying to reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") and the websocket is opened"),this.isLocal()?[2,this.initWebRtcPeerSend(!0)]:[2,this.initWebRtcPeerReceive(!0)];throw t="["+e+"] Trying to reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") but the websocket wasn't opened",E.error(t),Error(t)}}))}))},e.prototype.isWebsocketConnected=function(e,t){var n=this;return new Promise((function(i,r){var o=n.session.openvidu.getWsReadyState();if(1===o){var s=setTimeout((function(){console.warn("["+e+"] Websocket timeout of "+t+"ms"),i(!1)}),t);n.session.openvidu.sendRequest("echo",{},(function(t,n){clearTimeout(s),t?(console.warn("["+e+"] Websocket 'echo' returned error: "+t),i(!1)):i(!0)}))}else console.warn("["+e+"] Websocket readyState is "+o),i(!1)}))},e.prototype.awaitWebRtcPeerConnectionState=function(e){return i(this,void 0,void 0,(function(){var t,n,i,o;return r(this,(function(r){switch(r.label){case 0:t=this.getRTCPeerConnection().iceConnectionState,n=150,i=Math.ceil(e/n),o=0,r.label=1;case 1:return o<i?"connected"===(t=this.getRTCPeerConnection().iceConnectionState)||"completed"===t?[3,4]:[4,new Promise((function(e){return setTimeout(e,n)}))]:[3,4];case 2:r.sent(),r.label=3;case 3:return o++,[3,1];case 4:return[2,t]}}))}))},e.prototype.initWebRtcStats=function(){this.webRtcStats=new d.WebRtcStats(this),this.webRtcStats.initWebRtcStats()},e.prototype.stopWebRtcStats=function(){this.webRtcStats&&this.webRtcStats.isEnabled()&&this.webRtcStats.stopWebRtcStats()},e.prototype.getIceServersConf=function(){return this.session.openvidu.advancedConfiguration.iceServers?"freeice"===this.session.openvidu.advancedConfiguration.iceServers?void 0:this.session.openvidu.advancedConfiguration.iceServers:this.session.openvidu.iceServers?this.session.openvidu.iceServers:void 0},e.prototype.gatherStatsForPeer=function(){var e=this;return new Promise((function(t,n){e.isLocal()?e.getRTCPeerConnection().getSenders().forEach((function(t){return t.getStats().then((function(t){t.forEach((function(t){if(e.isReportWanted(t)){var n={};n.type=t.type,n.timestamp=t.timestamp,n.id=t.id,"outbound-rtp"===t.type&&(n.ssrc=t.ssrc,n.firCount=t.firCount,n.pliCount=t.pliCount,n.nackCount=t.nackCount,n.qpSum=t.qpSum,t.kind?n.mediaType=t.kind:t.mediaType?n.mediaType=t.mediaType:n.mediaType=-1!==t.id.indexOf("VideoStream")?"video":"audio","video"===n.mediaType&&(n.framesEncoded=t.framesEncoded),n.packetsSent=t.packetsSent,n.bytesSent=t.bytesSent),"candidate-pair"===t.type&&void 0!==t.totalRoundTripTime&&(n.availableOutgoingBitrate=t.availableOutgoingBitrate,n.rtt=t.currentRoundTripTime,n.averageRtt=t.totalRoundTripTime/t.responsesReceived),"remote-inbound-rtp"===t.type||t.type,E.log(n)}}))}))})):e.getRTCPeerConnection().getReceivers().forEach((function(t){return t.getStats().then((function(t){t.forEach((function(t){if(e.isReportWanted(t)){var n={};n.type=t.type,n.timestamp=t.timestamp,n.id=t.id,"inbound-rtp"===t.type&&(n.ssrc=t.ssrc,n.firCount=t.firCount,n.pliCount=t.pliCount,n.nackCount=t.nackCount,n.qpSum=t.qpSum,t.kind?n.mediaType=t.kind:t.mediaType?n.mediaType=t.mediaType:n.mediaType=-1!==t.id.indexOf("VideoStream")?"video":"audio","video"===n.mediaType&&(n.framesDecoded=t.framesDecoded),n.packetsReceived=t.packetsReceived,n.packetsLost=t.packetsLost,n.jitter=t.jitter,n.bytesReceived=t.bytesReceived),"candidate-pair"===t.type&&void 0!==t.totalRoundTripTime&&(n.availableIncomingBitrate=t.availableIncomingBitrate,n.rtt=t.currentRoundTripTime,n.averageRtt=t.totalRoundTripTime/t.responsesReceived),"remote-inbound-rtp"===t.type||t.type,E.log(n)}}))}))}))}))},e.prototype.isReportWanted=function(e){return"inbound-rtp"===e.type&&!this.isLocal()||"outbound-rtp"===e.type&&this.isLocal()||"candidate-pair"===e.type&&e.nominated&&e.bytesSent>0},e}();t.Stream=y},2028:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManager=void 0;var r,o=n(3013),s=n(3977),a=n(6367),c=n(4270),d=n(5364),u=n(5971),l=n(6056),p=d.OpenViduLogger.getInstance(),h=function(e){function t(t,n){var i=e.call(this)||this;if(i.videos=[],i.lazyLaunchVideoElementCreatedEvent=!1,r=u.PlatformUtils.getInstance(),i.stream=t,i.stream.streamManager=i,i.remote=!i.stream.isLocal(),n){var o=void 0;"string"===typeof n?o=document.getElementById(n):n instanceof HTMLElement&&(o=n),o&&(i.firstVideoElement={targetElement:o,video:document.createElement("video"),id:"",canplayListenerAdded:!1},(r.isSafariBrowser()||r.isIPhoneOrIPad()&&(r.isChromeMobileBrowser()||r.isEdgeMobileBrowser()||r.isOperaMobileBrowser()||r.isFirefoxMobileBrowser()))&&i.firstVideoElement.video.setAttribute("playsinline","true"),i.targetElement=o,i.element=o)}return i.canPlayListener=function(){i.deactivateStreamPlayingEventExceptionTimeout(),i.remote?(p.info("Remote 'Stream' with id ["+i.stream.streamId+"] video is now playing"),i.ee.emitEvent("videoPlaying",[new a.VideoElementEvent(i.videos[0].video,i,"videoPlaying")])):i.stream.displayMyRemote()?(p.info("Your own remote 'Stream' with id ["+i.stream.streamId+"] video is now playing"),i.ee.emitEvent("remoteVideoPlaying",[new a.VideoElementEvent(i.videos[0].video,i,"remoteVideoPlaying")])):(p.info("Your local 'Stream' with id ["+i.stream.streamId+"] video is now playing"),i.ee.emitEvent("videoPlaying",[new a.VideoElementEvent(i.videos[0].video,i,"videoPlaying")])),i.ee.emitEvent("streamPlaying",[new s.StreamManagerEvent(i,"streamPlaying",void 0)])},i}return i(t,e),t.prototype.on=function(t,n){return e.prototype.onAux.call(this,t,"Event '"+t+"' triggered by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===t&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&(this.ee.emitEvent("videoElementCreated",[new a.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!1),"streamPlaying"!==t&&"videoPlaying"!==t||this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&(this.ee.emitEvent("streamPlaying",[new s.StreamManagerEvent(this,"streamPlaying",void 0)]),this.ee.emitEvent("videoPlaying",[new a.VideoElementEvent(this.videos[0].video,this,"videoPlaying")])),this.stream.hasAudio&&("publisherStartSpeaking"===t&&this.stream.enableHarkSpeakingEvent(),"publisherStopSpeaking"===t&&this.stream.enableHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===t&&this.stream.enableHarkVolumeChangeEvent(!1)),this},t.prototype.once=function(t,n){return e.prototype.onceAux.call(this,t,"Event '"+t+"' triggered once by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===t&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&this.ee.emitEvent("videoElementCreated",[new a.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),"streamPlaying"!==t&&"videoPlaying"!==t||this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&(this.ee.emitEvent("streamPlaying",[new s.StreamManagerEvent(this,"streamPlaying",void 0)]),this.ee.emitEvent("videoPlaying",[new a.VideoElementEvent(this.videos[0].video,this,"videoPlaying")])),this.stream.hasAudio&&("publisherStartSpeaking"===t&&this.stream.enableOnceHarkSpeakingEvent(),"publisherStopSpeaking"===t&&this.stream.enableOnceHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===t&&this.stream.enableOnceHarkVolumeChangeEvent(!1)),this},t.prototype.off=function(t,n){(e.prototype.off.call(this,t,n),"publisherStartSpeaking"===t)&&(0===this.ee.getListeners(t).length+this.stream.session.ee.getListeners(t).length&&this.stream.disableHarkSpeakingEvent(!1));"publisherStopSpeaking"===t&&(0===this.ee.getListeners(t).length+this.stream.session.ee.getListeners(t).length&&this.stream.disableHarkStoppedSpeakingEvent(!1));"streamAudioVolumeChange"===t&&(0===this.ee.getListeners(t).length&&this.stream.disableHarkVolumeChangeEvent(!1));return this},t.prototype.addVideoElement=function(e){this.initializeVideoProperties(e),!this.remote&&this.stream.displayMyRemote()&&e.srcObject!==this.stream.getMediaStream()&&(e.srcObject=this.stream.getMediaStream());for(var t=0,n=this.videos;t<n.length;t++){if(n[t].video===e)return 0}for(var i=1,r=0,o=this.stream.session.streamManagers;r<o.length;r++){if(o[r].disassociateVideo(e)){i=-1;break}}return this.stream.session.streamManagers.forEach((function(t){t.disassociateVideo(e)})),this.pushNewStreamManagerVideo({video:e,id:e.id,canplayListenerAdded:!1}),p.info("New video element associated to ",this),i},t.prototype.createVideoElement=function(e,t){var n;if("string"===typeof e){if(!(n=document.getElementById(e)))throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e)}else{if(!(e instanceof HTMLElement))throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e);n=e}var i=this.createVideo();this.initializeVideoProperties(i);var r=t||c.VideoInsertMode.APPEND;switch(r){case c.VideoInsertMode.AFTER:n.parentNode.insertBefore(i,n.nextSibling);break;case c.VideoInsertMode.APPEND:n.appendChild(i);break;case c.VideoInsertMode.BEFORE:n.parentNode.insertBefore(i,n);break;case c.VideoInsertMode.PREPEND:n.insertBefore(i,n.childNodes[0]);break;case c.VideoInsertMode.REPLACE:n.parentNode.replaceChild(i,n);break;default:r=c.VideoInsertMode.APPEND,n.appendChild(i)}var o={targetElement:n,video:i,insertMode:r,id:i.id,canplayListenerAdded:!1};return this.pushNewStreamManagerVideo(o),this.ee.emitEvent("videoElementCreated",[new a.VideoElementEvent(o.video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!!this.firstVideoElement,i},t.prototype.updatePublisherSpeakingEventsOptions=function(e){var t=this.stream.harkOptions?this.stream.harkOptions:this.stream.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{},n="number"===typeof e.interval?e.interval:"number"===typeof t.interval?t.interval:100,i="number"===typeof e.threshold?e.threshold:"number"===typeof t.threshold?t.threshold:-50;this.stream.harkOptions={interval:n,threshold:i},this.stream.speechEvent&&(this.stream.speechEvent.setInterval(n),this.stream.speechEvent.setThreshold(i))},t.prototype.initializeVideoProperties=function(e){!this.remote&&this.stream.displayMyRemote()||e.srcObject!==this.stream.getMediaStream()&&(e.srcObject=this.stream.getMediaStream()),e.autoplay=!0,e.controls=!1,(r.isSafariBrowser()||r.isIPhoneOrIPad()&&(r.isChromeMobileBrowser()||r.isEdgeMobileBrowser()||r.isOperaMobileBrowser()||r.isFirefoxMobileBrowser()))&&e.setAttribute("playsinline","true"),e.id||(e.id=(this.remote?"remote-":"local-")+"video-"+this.stream.streamId,!this.id&&this.targetElement&&(this.id=e.id)),this.remote||this.stream.displayMyRemote()||(e.muted=!0,"rotateY(180deg)"!==e.style.transform||this.stream.outboundStreamOpts.publisherProperties.mirror?this.stream.outboundStreamOpts.publisherProperties.mirror&&!this.stream.isSendScreen()&&this.mirrorVideo(e):this.removeMirrorVideo(e))},t.prototype.removeAllVideos=function(){for(var e=this,t=this.stream.session.streamManagers.length-1;t>=0;--t)this.stream.session.streamManagers[t]===this&&this.stream.session.streamManagers.splice(t,1);this.videos.forEach((function(t){t.video&&t.video.removeEventListener&&t.video.removeEventListener("canplay",e.canPlayListener),t.canplayListenerAdded=!1,t.targetElement&&(t.video.parentNode.removeChild(t.video),e.ee.emitEvent("videoElementDestroyed",[new a.VideoElementEvent(t.video,e,"videoElementDestroyed")])),e.removeSrcObject(t),e.videos.filter((function(e){return!e.targetElement}))}))},t.prototype.disassociateVideo=function(e){for(var t=!1,n=0;n<this.videos.length;n++)if(this.videos[n].video===e){this.videos[n].video.removeEventListener("canplay",this.canPlayListener),this.videos.splice(n,1),t=!0,p.info("Video element disassociated from ",this);break}return t},t.prototype.addPlayEventToFirstVideo=function(){this.videos[0]&&this.videos[0].video&&!this.videos[0].canplayListenerAdded&&(this.activateStreamPlayingEventExceptionTimeout(),this.videos[0].video.addEventListener("canplay",this.canPlayListener),this.videos[0].canplayListenerAdded=!0)},t.prototype.updateMediaStream=function(e){this.videos.forEach((function(t){if(t.video.srcObject=e,r.isIonicIos()){var n=t.video.parentElement,i=t.video;n.replaceChild(i,t.video),t.video=i}}))},t.prototype.emitEvent=function(e,t){this.ee.emitEvent(e,t)},t.prototype.createVideo=function(){return document.createElement("video")},t.prototype.removeSrcObject=function(e){e.video.srcObject=null,this.deactivateStreamPlayingEventExceptionTimeout()},t.prototype.pushNewStreamManagerVideo=function(e){this.videos.push(e),this.addPlayEventToFirstVideo(),-1===this.stream.session.streamManagers.indexOf(this)&&this.stream.session.streamManagers.push(this)},t.prototype.mirrorVideo=function(e){r.isIonicIos()||(e.style.transform="rotateY(180deg)",e.style.webkitTransform="rotateY(180deg)")},t.prototype.removeMirrorVideo=function(e){e.style.transform="unset",e.style.webkitTransform="unset"},t.prototype.activateStreamPlayingEventExceptionTimeout=function(){var e=this;if(this.remote&&null==this.streamPlayingEventExceptionTimeout){var t=this.stream.session.openvidu.advancedConfiguration.noStreamPlayingEventExceptionTimeout||4e3;this.streamPlayingEventExceptionTimeout=setTimeout((function(){var n="StreamManager of Stream "+e.stream.streamId+" ("+(e.remote?"Subscriber":"Publisher")+') did not trigger "streamPlaying" event in '+t+" ms";p.warn(n),e.stream.session.emitEvent("exception",[new l.ExceptionEvent(e.stream.session,l.ExceptionEventName.NO_STREAM_PLAYING_EVENT,e,n)]),delete e.streamPlayingEventExceptionTimeout}),t)}},t.prototype.deactivateStreamPlayingEventExceptionTimeout=function(){clearTimeout(this.streamPlayingEventExceptionTimeout),delete this.streamPlayingEventExceptionTimeout},t}(o.EventDispatcher);t.StreamManager=h},4980:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.Subscriber=void 0;var r=n(2028),o=n(5364).OpenViduLogger.getInstance(),s=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.element=r.targetElement,r.stream=t,r.properties=i,r}return i(t,e),t.prototype.subscribeToAudio=function(e){return this.stream.getMediaStream().getAudioTracks().forEach((function(t){t.enabled=e})),this.stream.audioActive=e,o.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its audio stream"),this},t.prototype.subscribeToVideo=function(e){return this.stream.getMediaStream().getVideoTracks().forEach((function(t){t.enabled=e})),this.stream.videoActive=e,o.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its video stream"),this},t}(r.StreamManager);t.Subscriber=s},9690:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorderState=void 0,function(e){e.READY="READY",e.RECORDING="RECORDING",e.PAUSED="PAUSED",e.FINISHED="FINISHED"}(t.LocalRecorderState||(t.LocalRecorderState={}))},7009:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduError=t.OpenViduErrorName=void 0,function(e){e.BROWSER_NOT_SUPPORTED="BROWSER_NOT_SUPPORTED",e.DEVICE_ACCESS_DENIED="DEVICE_ACCESS_DENIED",e.DEVICE_ALREADY_IN_USE="DEVICE_ALREADY_IN_USE",e.SCREEN_CAPTURE_DENIED="SCREEN_CAPTURE_DENIED",e.SCREEN_SHARING_NOT_SUPPORTED="SCREEN_SHARING_NOT_SUPPORTED",e.SCREEN_EXTENSION_NOT_INSTALLED="SCREEN_EXTENSION_NOT_INSTALLED",e.SCREEN_EXTENSION_DISABLED="SCREEN_EXTENSION_DISABLED",e.INPUT_VIDEO_DEVICE_NOT_FOUND="INPUT_VIDEO_DEVICE_NOT_FOUND",e.INPUT_AUDIO_DEVICE_NOT_FOUND="INPUT_AUDIO_DEVICE_NOT_FOUND",e.INPUT_AUDIO_DEVICE_GENERIC_ERROR="INPUT_AUDIO_DEVICE_GENERIC_ERROR",e.NO_INPUT_SOURCE_SET="NO_INPUT_SOURCE_SET",e.PUBLISHER_PROPERTIES_ERROR="PUBLISHER_PROPERTIES_ERROR",e.OPENVIDU_PERMISSION_DENIED="OPENVIDU_PERMISSION_DENIED",e.OPENVIDU_NOT_CONNECTED="OPENVIDU_NOT_CONNECTED",e.GENERIC_ERROR="GENERIC_ERROR"}(t.OpenViduErrorName||(t.OpenViduErrorName={}));var n=function(e,t){this.name=e,this.message=t};t.OpenViduError=n},4270:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoInsertMode=void 0,function(e){e.AFTER="AFTER",e.APPEND="APPEND",e.BEFORE="BEFORE",e.PREPEND="PREPEND",e.REPLACE="REPLACE"}(t.VideoInsertMode||(t.VideoInsertMode={}))},5223:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionEvent=void 0;var r=function(e){function t(t,n,i,r,o){var s=e.call(this,t,n,i)||this;return s.connection=r,s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.ConnectionEvent=r},6203:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionPropertyChangedEvent=void 0;var r=function(e){function t(t,n,i,r,o){var s=e.call(this,!1,t,"connectionPropertyChanged")||this;return s.connection=n,s.changedProperty=i,s.newValue=r,s.oldValue=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.ConnectionPropertyChangedEvent=r},6300:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=function(){function e(e,t,n){this.hasBeenPrevented=!1,this.cancelable=e,this.target=t,this.type=n}return e.prototype.isDefaultPrevented=function(){return this.hasBeenPrevented},e.prototype.preventDefault=function(){this.callDefaultBehavior=function(){},this.hasBeenPrevented=!0},e}();t.Event=n},6056:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.ExceptionEvent=t.ExceptionEventName=void 0;var r=n(6300);!function(e){e.ICE_CANDIDATE_ERROR="ICE_CANDIDATE_ERROR",e.ICE_CONNECTION_FAILED="ICE_CONNECTION_FAILED",e.ICE_CONNECTION_DISCONNECTED="ICE_CONNECTION_DISCONNECTED",e.NO_STREAM_PLAYING_EVENT="NO_STREAM_PLAYING_EVENT"}(t.ExceptionEventName||(t.ExceptionEventName={}));var o=function(e){function t(t,n,i,r,o){var s=e.call(this,!1,t,"exception")||this;return s.name=n,s.origin=i,s.message=r,s.data=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(r.Event);t.ExceptionEvent=o},146:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.FilterEvent=void 0;var r=function(e){function t(t,n,i){var r=e.call(this,!1,t,n)||this;return r.data=i,r}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.FilterEvent=r},9233:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkQualityLevelChangedEvent=void 0;var r=function(e){function t(t,n,i,r){var o=e.call(this,!1,t,"networkQualityLevelChanged")||this;return o.newValue=n,o.oldValue=i,o.connection=r,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.NetworkQualityLevelChangedEvent=r},8271:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.PublisherSpeakingEvent=void 0;var r=function(e){function t(t,n,i,r){var o=e.call(this,!1,t,n)||this;return o.type=n,o.connection=i,o.streamId=r,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.PublisherSpeakingEvent=r},8856:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.RecordingEvent=void 0;var r=function(e){function t(t,n,i,r,o){var s=e.call(this,!1,t,n)||this;return s.id=i,r!==i&&(s.name=r),s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.RecordingEvent=r},3439:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SessionDisconnectedEvent=void 0;var r=n(6300),o=n(5364).OpenViduLogger.getInstance(),s=function(e){function t(t,n){var i=e.call(this,!0,t,"sessionDisconnected")||this;return i.reason=n,i}return i(t,e),t.prototype.callDefaultBehavior=function(){o.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'");var e=this.target;e.remoteConnections.forEach((function(t){var n,i,r,o,s,a,c,d,u=t.connectionId;if(null===(n=e.remoteConnections.get(u))||void 0===n?void 0:n.stream){null===(i=e.remoteConnections.get(u))||void 0===i||i.stream.disposeWebRtcPeer(),null===(r=e.remoteConnections.get(u))||void 0===r||r.stream.disposeMediaStream(),(null===(o=e.remoteConnections.get(u))||void 0===o?void 0:o.stream.streamManager)&&(null===(s=e.remoteConnections.get(u))||void 0===s||s.stream.streamManager.removeAllVideos());var l=null===(c=null===(a=e.remoteConnections.get(u))||void 0===a?void 0:a.stream)||void 0===c?void 0:c.streamId;l&&e.remoteStreamsCreated.delete(l),null===(d=e.remoteConnections.get(u))||void 0===d||d.dispose()}e.remoteConnections.delete(u)}))},t}(r.Event);t.SessionDisconnectedEvent=s},3685:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SignalEvent=void 0;var r=function(e){function t(t,n,i,r){var o=e.call(this,!1,t,"signal")||this;return n&&(o.type="signal:"+n),o.data=i,o.from=r,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.SignalEvent=r},3590:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.StreamEvent=void 0;var r=n(6300),o=n(2917),s=n(7678),a=n(5364).OpenViduLogger.getInstance(),c=function(e){function t(t,n,i,r,o){var s=e.call(this,t,n,i)||this;return s.stream=r,s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){if("streamDestroyed"===this.type){if(this.target instanceof s.Session)a.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'"),this.stream.disposeWebRtcPeer();else if(this.target instanceof o.Publisher){a.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Publisher'"),clearInterval(this.target.screenShareResizeInterval),this.stream.isLocalStreamReadyToPublish=!1;for(var e=this.target.openvidu.publishers,t=0;t<e.length;t++)if(e[t]===this.target){e.splice(t,1);break}}this.stream.disposeMediaStream(),this.stream.streamManager&&this.stream.streamManager.removeAllVideos(),this.stream.session.remoteStreamsCreated.delete(this.stream.streamId);var n=this.stream.session.remoteConnections.get(this.stream.connection.connectionId);if(n&&n.remoteOptions){var i=n.remoteOptions.streams;for(t=i.length-1;t>=0;--t)i[t].id===this.stream.streamId&&i.splice(t,1)}}},t}(r.Event);t.StreamEvent=c},3977:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManagerEvent=void 0;var r=function(e){function t(t,n,i){var r=e.call(this,!1,t,n)||this;return r.value=i,r}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.StreamManagerEvent=r},7614:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.StreamPropertyChangedEvent=void 0;var r=function(e){function t(t,n,i,r,o,s){var a=e.call(this,!1,t,"streamPropertyChanged")||this;return a.stream=n,a.changedProperty=i,a.newValue=r,a.oldValue=o,a.reason=s,a}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.StreamPropertyChangedEvent=r},6367:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.VideoElementEvent=void 0;var r=function(e){function t(t,n,i){var r=e.call(this,!1,n,i)||this;return r.element=t,r}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(6300).Event);t.VideoElementEvent=r},4113:function(e){function t(){var e={};this.forEach=function(t){for(var n in e){var i=e[n];for(var r in i)t(i[r])}},this.get=function(t,n){var i=e[n];if(void 0!=i)return i[t]},this.remove=function(t,n){var i=e[n];if(void 0!=i){for(var r in delete i[t],i)return!1;delete e[n]}},this.set=function(t,n,i){if(void 0==t)return this.remove(n,i);var r=e[i];void 0==r&&(e[i]=r={}),r[n]=t}}t.prototype.pop=function(e,t){var n=this.get(e,t);if(void 0!=n)return this.remove(e,t),n},e.exports=t},264:function(e,t,n){var i=n(9972);t.JsonRpcClient=i},9972:function(e,t,n){var i=n(4834),r=n(1889),o=n(5364).OpenViduLogger;Date.now=Date.now||function(){return+new Date};var s="RECONNECTING",a="CONNECTED",c="DISCONNECTED",d=o.getInstance();e.exports=function(e){var t,n=this,o=e.ws,u=-1,l=0,p=!0,h=!1,f=c,v=o.onreconnecting,m=o.onreconnected,g=o.onconnected,b=o.onerror;e.rpc.pull=function(e,t){t.reply(null,"push")},o.onreconnecting=function(){d.debug("--------- ONRECONNECTING -----------"),f!==s?(I(),f=s,v&&v()):d.error("Websocket already in RECONNECTING state when receiving a new ONRECONNECTING message. Ignoring it")},o.onreconnected=function(){d.debug("--------- ONRECONNECTED -----------"),f!==a?(f=a,w(),m&&m()):d.error("Websocket already in CONNECTED state when receiving a new ONRECONNECTED message. Ignoring it")},o.onconnected=function(){d.debug("--------- ONCONNECTED -----------"),f!==a?(f=a,p=!0,O(),g&&g()):d.error("Websocket already in CONNECTED state when receiving a new ONCONNECTED message. Ignoring it")},o.onerror=function(e){d.debug("--------- ONERROR -----------"),f=c,I(),b&&b(e)};var E=new r(o);d.debug("Connecting websocket to URI: "+o.uri);var y={request_timeout:e.rpc.requestTimeout,ping_request_timeout:e.rpc.heartbeatRequestTimeout},S=new i(i.packers.JsonRPC,y,E,(function(t){d.debug("Received request: "+JSON.stringify(t));try{var n=e.rpc[t.method];void 0===n?d.error("Method "+t.method+" not registered in client"):n(t.params,t)}catch(i){d.error("Exception processing request: "+JSON.stringify(t)),d.error(i)}}));function w(){d.debug("notReconnectIfNumLessThan = "+l+" (old="+u+")"),u=l}function C(){if(p){var t=null;0!=l&&l!=u||(t={interval:e.heartbeat||5e3}),l++,n.send("ping",t,(i=l,function(e,t){e&&(d.debug("Error in ping request #"+i+" ("+e.message+")"),i>u&&(p=!1,w(),d.debug("Server did not respond to ping message #"+i+". Reconnecting... "),E.reconnectWs()))}))}else d.debug("Trying to send ping, but ping is not enabled");var i}function O(){h||(d.debug("Starting ping (if configured)"),h=!0,void 0!=e.heartbeat&&(t=setInterval(C,e.heartbeat),C()))}function I(){clearInterval(t),h=!1,p=!1,l=-1,S.cancel()}this.send=function(e,t,n){var i=Date.now();S.encode(e,t,(function(r,o){if(r){try{d.error("ERROR:"+r.message+" in Request: method:"+e+" params:"+JSON.stringify(t)+" request:"+r.request),r.data&&d.error("ERROR DATA:"+JSON.stringify(r.data))}catch(s){}r.requestTime=i}n&&(void 0!=o&&"pong"!==o.value&&d.debug("Response: "+JSON.stringify(o)),n(r,o))}))},this.close=function(e,n){d.debug("Closing  with code: "+e+" because: "+n),void 0!=t&&(d.debug("Clearing ping interval"),clearInterval(t)),h=!1,p=!1,E.close(e,n)},this.forceClose=function(e){E.forceClose(e)},this.reconnect=function(){E.reconnectWs()},this.resetPing=function(){p=!0,l=0,O()},this.getReadyState=function(){return E.getReadyState()}}},6115:function(e,t,n){var i=n(1889);t.WebSocketWithReconnection=i},1889:function(e,t,n){"use strict";var i=n(5364).OpenViduLogger.getInstance();e.exports=function(e){var t,n=!1,r=e.uri,o=!1,s=new WebSocket(r);s.onopen=function(){i.debug("WebSocket connected to "+r),e.onconnected&&e.onconnected()},s.onerror=function(t){i.error("Could not connect to "+r+" (invoking onerror if defined)",t),e.onerror&&e.onerror(t)};var a=function(){3===s.readyState?n?i.debug("Connection closed by user"):e.ismasternodecrashed()?i.error("Master Node has crashed. Stopping reconnection process"):(i.debug("Connection closed unexpectedly. Reconnecting..."),c(2e3,1)):i.debug("Close callback from previous websocket. Ignoring it")};function c(n,d){if(i.debug("reconnect (attempt #"+d+", max="+n+")"),1===d){if(o)return void i.warn("Trying to reconnect when already reconnecting... Ignoring this reconnection.");o=!0,e.onreconnecting&&e.onreconnecting()}!function(n,d){i.debug("Reconnection attempt #"+d),s.close(),(s=new WebSocket(r)).onopen=function(){i.debug("Reconnected to "+r+" after "+d+" attempts..."),o=!1,t(),e.onreconnected()&&e.onreconnected(),s.onclose=a},s.onerror=function(t){i.warn("Reconnection error: ",t),d===n?e.ondisconnect&&e.ondisconnect():setTimeout((function(){c(n,d+1)}),3e3)}}(n,d)}s.onclose=a,this.close=function(){n=!0,s.close()},this.forceClose=function(){s.close()},this.reconnectWs=function(){i.debug("reconnectWs"),c(2e3,1)},this.send=function(e){s.send(e)},this.addEventListener=function(e,n){(t=function(){s.addEventListener(e,n)})()},this.getReadyState=function(){return s.readyState}}},4834:function(e,t,n){var i=!1;if(Object.defineProperty)try{Object.defineProperty({},"x",{})}catch(f){i=!0}Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,i=function(){},r=function(){return n.apply(this instanceof i&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,r.prototype=new i,r});var r=n(5293).EventEmitter,o=n(5717),s=n(6622),a=n(4113),c=5e3;function d(e){if(e){if(e instanceof Function)return{send:e};if(e.send instanceof Function)return e;if(e.postMessage instanceof Function)return e.send=e.postMessage,e;if(e.write instanceof Function)return e.send=e.write,e;if(void 0===e.onmessage&&!(e.pause instanceof Function))throw new SyntaxError("Transport is not a function nor a valid object")}}function u(e,t){i?(this.method=e,this.params=t):(Object.defineProperty(this,"method",{value:e,enumerable:!0}),Object.defineProperty(this,"params",{value:t,enumerable:!0}))}function l(e,t,n,s){var l=this;if(!e)throw new SyntaxError("Packer is not defined");if(!e.pack||!e.unpack)throw new SyntaxError("Packer is invalid");var p=function(e){if(!e)return{};for(var t in e){var n=e[t];"string"==typeof n&&(e[t]={response:n})}return e}(e.responseMethods);if(t instanceof Function){if(void 0!=n)throw new SyntaxError("There can't be parameters after onRequest");s=t,n=void 0,t=void 0}if(t&&t.send instanceof Function){if(n&&!(n instanceof Function))throw new SyntaxError("Only a function can be after transport");s=n,n=t,t=void 0}if(n instanceof Function){if(void 0!=s)throw new SyntaxError("There can't be parameters after onRequest");s=n,n=void 0}if(n&&n.send instanceof Function&&s&&!(s instanceof Function))throw new SyntaxError("Only a function can be after transport");t=t||{},r.call(this),s&&this.on("request",s),i?this.peerID=t.peerID:Object.defineProperty(this,"peerID",{value:t.peerID});var h=t.max_retries||0;function v(e){l.decode(e.data||e)}this.getTransport=function(){return n},this.setTransport=function(e){n&&(n.removeEventListener?n.removeEventListener("message",v):n.removeListener&&n.removeListener("data",v)),e&&(e.addEventListener?e.addEventListener("message",v):e.addListener&&e.addListener("data",v)),n=d(e)},i||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)}),this.setTransport(n);var m=t.request_timeout||c,g=t.ping_request_timeout||m,b=t.response_timeout||c,E=t.duplicates_timeout||c,y=0,S=new a,w=new a,C=new a,O={};function I(e,t){var n=setTimeout((function(){C.remove(e,t)}),E);C.set(n,e,t)}function R(t,n,r,o,s){u.call(this,t,n),this.getTransport=function(){return s},this.setTransport=function(e){s=d(e)},i||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)});var a=w.get(r,o);s||l.getTransport()||(i?this.duplicated=Boolean(a):Object.defineProperty(this,"duplicated",{value:Boolean(a)}));var c=p[t];this.pack=e.pack.bind(e,this,r),this.reply=function(t,n,i){if(t instanceof Function||t&&t.send instanceof Function){if(void 0!=n)throw new SyntaxError("There can't be parameters after callback");i=t,n=null,t=void 0}else if(n instanceof Function||n&&n.send instanceof Function){if(void 0!=i)throw new SyntaxError("There can't be parameters after callback");i=n,n=null}var s;if(i=d(i),a&&clearTimeout(a.timeout),void 0!=o&&(t&&(t.dest=o),n&&(n.dest=o)),t||void 0!=n){if(void 0!=l.peerID&&(t?t.from=l.peerID:n.from=l.peerID),c)if(void 0==c.error&&t)s={error:t};else s={method:t?c.error:c.response,params:t||n};else s={error:t,result:n};s=e.pack(s,r)}else s=a?a.message:e.pack({result:null},r);return function(e,t,n){var i={message:e,timeout:setTimeout((function(){w.remove(t,n)}),b)};w.set(i,t,n)}(s,r,o),(i=i||this.getTransport()||l.getTransport())?i.send(s):s}}function P(e){var t=O[e];if(t){delete O[e];var n=S.pop(t.id,t.dest);n&&(clearTimeout(n.timeout),I(t.id,t.dest))}}o(R,u),this.cancel=function(e){if(e)return P(e);for(var e in O)P(e)},this.close=function(){var e=this.getTransport();e&&e.close&&e.close(4003,"Cancel request"),this.cancel(),C.forEach(clearTimeout),w.forEach((function(e){clearTimeout(e.timeout)}))},this.encode=function(t,n,i,r,o){if(n instanceof Function){if(void 0!=i)throw new SyntaxError("There can't be parameters after callback");o=n,r=void 0,i=void 0,n=void 0}else if(i instanceof Function){if(void 0!=r)throw new SyntaxError("There can't be parameters after callback");o=i,r=void 0,i=void 0}else if(r instanceof Function){if(void 0!=o)throw new SyntaxError("There can't be parameters after callback");o=r,r=void 0}void 0!=l.peerID&&((n=n||{}).from=l.peerID),void 0!=i&&((n=n||{}).dest=i);var s={method:t,params:n};if(o){var a=y++,c=0;function u(e,t){l.cancel(s),o(e,t)}var f={message:s=e.pack(s,a),callback:u,responseMethods:p[t]||{}},v=d(r);function b(e){var n="ping"===t?g:m;return f.timeout=setTimeout(w,n*Math.pow(2,c++)),O[s]={id:a,dest:i},S.set(f,a,i),(e=e||v||l.getTransport())?e.send(s):s}function E(e){e=d(e),console.warn(c+" retry for request message:",s);var t=C.pop(a,i);return clearTimeout(t),b(e)}function w(){if(c<h)return E(r);var e=new Error("Request has timed out");e.request=s,e.retry=E,u(e)}return b(r)}return s=e.pack(s),(r=r||this.getTransport())?r.send(s):s},this.decode=function(t,n){if(!t)throw new TypeError("Message is not defined");try{t=e.unpack(t)}catch(f){return console.debug(f,t)}var i=t.id,r=t.ack,o=t.method,s=t.params||{},a=s.from,c=s.dest;if(void 0==l.peerID||a!=l.peerID){if(void 0==i&&void 0==r){var p=new u(o,s);if(l.emit("request",p))return;return p}if(o){if(void 0==c||c==l.peerID){if(g=S.get(r,a)){var h=g.responseMethods;return o==h.error?y(g,s):o==h.response?y(g,null,s):E()}if(b=C.get(r,a))return O(b)}return E()}var v=t.error,m=t.result;if((!v||!v.dest||v.dest==l.peerID)&&(!m||!m.dest||m.dest==l.peerID)){var g,b;if(!(g=S.get(r,a)))return(b=C.get(r,a))?O(b):console.warn("No callback was defined for this message",t);y(g,v,m)}}function E(){if(n=d(n)||l.getTransport()){var e=w.get(i,a);if(e)return n.send(e.message)}var t=new R(o,s,void 0!=i?i:r,a,n);if(!l.emit("request",t))return t}function y(e,t,n){e.callback(t,n)}function O(e){console.warn("Response already processed",t),clearTimeout(e),I(r,a)}}}o(l,r),l.RpcNotification=u,e.exports=l;var p=n(264),h=n(6115);l.clients=p,l.clients.transports=h,l.packers=s},8447:function(e,t){t.pack=function(e,t){var n={jsonrpc:"2.0"};if(e.method)n.method=e.method,e.params&&(n.params=e.params),void 0!=t&&(n.id=t);else if(void 0!=t){if(e.error){if(void 0!==e.result)throw new TypeError("Both result and error are defined");n.error=e.error}else{if(void 0===e.result)throw new TypeError("No result or error is defined");n.result=e.result}n.id=t}return JSON.stringify(n)},t.unpack=function(e){var t=e;("string"===typeof e||e instanceof String)&&(t=JSON.parse(e));var n=t.jsonrpc;if("2.0"!==n)throw new TypeError("Invalid JsonRPC version '"+n+"': "+e);if(void 0==t.method){if(void 0==t.id)throw new TypeError("Invalid message: "+e);var i=void 0!==t.result,r=void 0!==t.error;if(i&&r)throw new TypeError("Both result and error are defined: "+e);if(!i&&!r)throw new TypeError("No result or error is defined: "+e);t.ack=t.id,delete t.id}return t}},7632:function(e,t){t.pack=function(e){throw new TypeError("Not yet implemented")},t.unpack=function(e){throw new TypeError("Not yet implemented")}},6622:function(e,t,n){var i=n(8447),r=n(7632);t.JsonRPC=i,t.XmlRPC=r},6689:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleLogger=void 0;var n=function(e){this.logger=e,this.log=window.console.log,this.info=window.console.info,this.debug=window.console.debug,this.warn=window.console.warn,this.error=window.console.error};t.ConsoleLogger=n},5364:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLogger=void 0;var i=n(3129),r=n(6689),o=n(327),s=function(){function e(){this.JSNLOG_URL="/openvidu/elk/openvidu-browser-logs",this.MAX_JSNLOG_BATCH_LOG_MESSAGES=100,this.MAX_MSECONDS_BATCH_MESSAGES=5e3,this.MAX_LENGTH_STRING_JSON=1e3,this.defaultConsoleLogger=new r.ConsoleLogger(window.console),this.isProdMode=!1,this.isJSNLogSetup=!1}return e.configureJSNLog=function(e,t){var n=this;try{if(window.LOG_JSNLOG_RESULTS||this.instance&&e.isPro&&this.instance.isOpenViduBrowserLogsDebugActive(e)&&this.instance.canConfigureJSNLog(e,this.instance)){e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app&&this.instance.replaceWindowConsole(),this.instance.isJSNLogSetup=!1,this.instance.info("Configuring JSNLogs.");var r=e.finalUserId,s=e.session.sessionId;this.instance.currentAppender=i.JL.createAjaxAppender("appender-"+r+"-"+s),this.instance.currentAppender.setOptions({beforeSend:function(e){var i=e.onreadystatechange;e.onreadystatechange=function(){n.isInvalidResponse(e)&&(Object.defineProperty(e,"readyState",{value:4}),Object.defineProperty(e,"status",{value:200}),n.instance.disableLogger()),i()},e.setRequestHeader("Authorization","Basic "+btoa(r+"%/%"+s+":"+t)),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("OV-Final-User-Id",r),e.setRequestHeader("OV-Session-Id",s),e.setRequestHeader("OV-Token",t)},maxBatchSize:1e3,batchSize:this.instance.MAX_JSNLOG_BATCH_LOG_MESSAGES,batchTimeout:this.instance.MAX_MSECONDS_BATCH_MESSAGES});i.JL.setOptions({defaultAjaxUrl:e.httpUri+this.instance.JSNLOG_URL,serialize:function(e){var t=JSON.stringify(e,function(){var e=new WeakSet;return function(t,n){if("object"===typeof n&&null!=n){if(e.has(n)||HTMLElement&&n instanceof HTMLElement)return;e.add(n)}return n}}());return t.length>n.instance.MAX_LENGTH_STRING_JSON&&(t=t.substring(0,n.instance.MAX_LENGTH_STRING_JSON)+"..."),window.LOG_JSNLOG_RESULTS&&console.log(t),t},enabled:!0}),i.JL().setOptions({appenders:[this.instance.currentAppender]}),this.instance.isJSNLogSetup=!0,this.instance.loggingSessionId=s,this.instance.info("JSNLog configured.")}}catch(a){console.error("Error configuring JSNLog: "),console.error(a),this.instance.disableLogger()}},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.isInvalidResponse=function(e){return 401==e.status||403==e.status||404==e.status||0==e.status},e.prototype.canConfigureJSNLog=function(e,t){return e.session.sessionId!=t.loggingSessionId},e.prototype.isOpenViduBrowserLogsDebugActive=function(e){return e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug||e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app},e.prototype.getConsoleWithJSNLog=function(){return e=this,{log:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.log.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&i.JL().info(arguments)},info:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.info.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&i.JL().info(arguments)},debug:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.debug.apply(e.defaultConsoleLogger.logger,arguments)},warn:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.warn.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&i.JL().warn(arguments)},error:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.error.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&i.JL().error(arguments)}};var e},e.prototype.replaceWindowConsole=function(){window.console=this.defaultConsoleLogger.logger,window.console.log=this.getConsoleWithJSNLog().log,window.console.info=this.getConsoleWithJSNLog().info,window.console.debug=this.getConsoleWithJSNLog().debug,window.console.warn=this.getConsoleWithJSNLog().warn,window.console.error=this.getConsoleWithJSNLog().error},e.prototype.disableLogger=function(){i.JL.setOptions({enabled:!1}),this.isJSNLogSetup=!1,this.loggingSessionId=void 0,this.currentAppender=void 0,window.console=this.defaultConsoleLogger.logger,window.console.log=this.defaultConsoleLogger.log,window.console.info=this.defaultConsoleLogger.info,window.console.debug=this.defaultConsoleLogger.debug,window.console.warn=this.defaultConsoleLogger.warn,window.console.error=this.defaultConsoleLogger.error},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.log.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&i.JL().info(arguments)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.debug.apply(this.defaultConsoleLogger.logger,arguments)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.info.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&i.JL().info(arguments)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.warn.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&i.JL().warn(arguments)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.defaultConsoleLogger.error.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&i.JL().error(arguments)},e.prototype.flush=function(){this.isJSNLogSetup&&null!=this.currentAppender&&this.currentAppender.sendBatch()},e.prototype.enableProdMode=function(){this.isProdMode=!0},e}();t.OpenViduLogger=s},327:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLoggerConfiguration=void 0,function(e){e.disabled="disabled",e.debug="debug",e.debug_app="debug_app"}(t.OpenViduLoggerConfiguration||(t.OpenViduLoggerConfiguration={}))},3061:function(e,t){function n(e,t,n){var i={audio:!1,video:{mandatory:{chromeMediaSource:e?"screen":"desktop",maxWidth:window.screen.width>1920?window.screen.width:1920,maxHeight:window.screen.height>1080?window.screen.height:1080},optional:[]}};return n&&(i.audio={mandatory:{chromeMediaSource:e?"screen":"desktop"},optional:[]}),t&&(i.video.mandatory.chromeMediaSourceId=t,i.audio&&i.audio.mandatory&&(i.audio.mandatory.chromeMediaSourceId=t)),i}function i(e){r?r.isLoaded?e?e.forEach?r.contentWindow.postMessage({captureCustomSourceId:e},"*"):r.contentWindow.postMessage({captureSourceIdWithAudio:!0},"*"):r.contentWindow.postMessage({captureSourceId:!0},"*"):setTimeout((function(){i(e)}),100):o((function(){i(e)}))}var r;function o(e){r?e():((r=document.createElement("iframe")).onload=function(){r.isLoaded=!0,e()},r.src="https://openvidu.github.io/openvidu-screen-sharing-chrome-extension/",r.style.display="none",(document.body||document.documentElement).appendChild(r))}function s(){r?r.isLoaded?r.contentWindow.postMessage({getChromeExtensionStatus:!0},"*"):setTimeout(s,100):o(s)}window.getScreenId=function(e,t,r){-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveOrOpenBlob&&!navigator.msSaveBlob?navigator.mozGetUserMedia?t(null,"firefox",{video:{mozMediaSource:e,mediaSource:e}}):(window.addEventListener("message",(function e(i){if(!i.data)return;i.data.chromeMediaSourceId&&("PermissionDeniedError"===i.data.chromeMediaSourceId?t("permission-denied"):t(null,i.data.chromeMediaSourceId,n(null,i.data.chromeMediaSourceId,i.data.canRequestAudioTrack)),window.removeEventListener("message",e));i.data.chromeExtensionStatus&&(t(i.data.chromeExtensionStatus,null,n(i.data.chromeExtensionStatus)),window.removeEventListener("message",e))})),r?setTimeout((function(){i(r)}),100):setTimeout(i,100)):t({video:!0})},window.getScreenConstraints=function(e){o((function(){getScreenId((function(t,n,i){i||(i={video:!0}),e(t,i.video)}))}))},window.getChromeExtensionStatus=function(e){navigator.mozGetUserMedia?e("installed-enabled"):(window.addEventListener("message",(function t(n){if(!n.data)return;n.data.chromeExtensionStatus&&(e(n.data.chromeExtensionStatus),window.removeEventListener("message",t))})),setTimeout(s,100))},t.getScreenId=window.getScreenId},9544:function(e,t){var n,i,r="screen";if("undefined"!==typeof window&&"undefined"!==typeof navigator&&"undefined"!==typeof navigator.userAgent){var o="undefined"!==typeof window.InstallTrigger,s=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;window.chrome;window.addEventListener("message",(function(e){e.origin==window.location.origin&&function(e){if("PermissionDeniedError"==e){if(i)return i("PermissionDeniedError");throw new Error("PermissionDeniedError")}"rtcmulticonnection-extension-loaded"==e&&(r="desktop");e.sourceId&&i&&i(n=e.sourceId,!0===e.canRequestAudioTrack)}(e.data)}))}function a(e){if(!e)throw'"callback" parameter is mandatory.';if(n)return e(n);i=e,window.postMessage("get-sourceId","*")}function c(e,t){n="";if(o)return e(null,{mozMediaSource:"window",mediaSource:"window"});var s={mandatory:{chromeMediaSource:r,maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080},optional:[]};"desktop"!=r||n?("desktop"==r&&(s.mandatory.chromeMediaSourceId=n),e(null,s)):t?function(e){if(!e)throw'"callback" parameter is mandatory.';if(n)return e(n);i=e,window.postMessage("audio-plus-tab","*")}((function(t,n){s.mandatory.chromeMediaSourceId=t,n&&(s.canRequestAudioTrack=!0),e("PermissionDeniedError"==t?t:null,s)})):a((function(t){s.mandatory.chromeMediaSourceId=t,e("PermissionDeniedError"==t?t:null,s)}))}t.getScreenConstraints=c,t.getScreenConstraintsWithAudio=function(e){c(e,!0)},t.isChromeExtensionAvailable=function(e){if(e){if("desktop"==r)return e(!0);window.postMessage("are-you-there","*"),setTimeout((function(){e("screen"!=r)}),2e3)}},t.getChromeExtensionStatus=function(e,t){if(o)return t("not-chrome");2!=arguments.length&&(t=e,e="lfcgfepafnobdloecchnfaclibenjold");var n=document.createElement("img");n.src="chrome-extension://"+e+"/icon.png",n.onload=function(){r="screen",window.postMessage("are-you-there","*"),setTimeout((function(){t("screen"==r?"installed-disabled":"installed-enabled")}),2e3)},n.onerror=function(){t("not-installed")}},t.getSourceId=a},5971:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformUtils=void 0;var i=n(1795),r=function(){function e(){}return e.getInstance=function(){return this.instance||(this.instance=new e),e.instance},e.prototype.isChromeBrowser=function(){return"Chrome"===i.name},e.prototype.isSafariBrowser=function(){return"Safari"===i.name},e.prototype.isChromeMobileBrowser=function(){return"Chrome Mobile"===i.name},e.prototype.isFirefoxBrowser=function(){return"Firefox"===i.name},e.prototype.isFirefoxMobileBrowser=function(){return"Firefox Mobile"===i.name||"Firefox for iOS"===i.name},e.prototype.isOperaBrowser=function(){return"Opera"===i.name},e.prototype.isOperaMobileBrowser=function(){return"Opera Mobile"===i.name},e.prototype.isEdgeBrowser=function(){var e=(null===i||void 0===i?void 0:i.version)?parseFloat(i.version):-1;return"Microsoft Edge"===i.name&&e>=80},e.prototype.isEdgeMobileBrowser=function(){var e,t,n=(null===i||void 0===i?void 0:i.version)?parseFloat(i.version):-1;return"Microsoft Edge"===i.name&&("Android"===(null===(e=i.os)||void 0===e?void 0:e.family)||"iOS"===(null===(t=i.os)||void 0===t?void 0:t.family))&&n>45},e.prototype.isAndroidBrowser=function(){return"Android Browser"===i.name},e.prototype.isElectron=function(){return"Electron"===i.name},e.prototype.isSamsungBrowser=function(){return"Samsung Internet Mobile"===i.name||"Samsung Internet"===i.name},e.prototype.isIPhoneOrIPad=function(){var e=i.ua?i.ua:navigator.userAgent,t="ontouchend"in document,n=/\b(\w*Macintosh\w*)\b/.test(e)&&t,r=/\b(\w*iPhone\w*)\b/.test(e)&&/\b(\w*Mobile\w*)\b/.test(e)&&t;return n||r},e.prototype.isIOSWithSafari=function(){var e=i.ua?i.ua:navigator.userAgent;return this.isIPhoneOrIPad()&&/\b(\w*Apple\w*)\b/.test(navigator.vendor)&&/\b(\w*Safari\w*)\b/.test(e)&&!/\b(\w*CriOS\w*)\b/.test(e)&&!/\b(\w*FxiOS\w*)\b/.test(e)},e.prototype.isIonicIos=function(){return this.isIPhoneOrIPad()&&-1===i.ua.indexOf("Safari")},e.prototype.isIonicAndroid=function(){return"Android"===i.os.family&&"Android Browser"==i.name},e.prototype.isMobileDevice=function(){return"iOS"===i.os.family||"Android"===i.os.family},e.prototype.isReactNative=function(){return!1},e.prototype.isChromium=function(){return this.isChromeBrowser()||this.isChromeMobileBrowser()||this.isOperaBrowser()||this.isOperaMobileBrowser()||this.isEdgeBrowser()||this.isEdgeMobileBrowser()||this.isSamsungBrowser()||this.isIonicAndroid()||this.isIonicIos()||this.isElectron()},e.prototype.canScreenShare=function(){var e=(null===i||void 0===i?void 0:i.version)?parseFloat(i.version):-1;return!this.isMobileDevice()&&(this.isChromeBrowser()||this.isFirefoxBrowser()||this.isOperaBrowser()||this.isElectron()||this.isEdgeBrowser()||this.isSafariBrowser()&&e>=13)},e.prototype.getName=function(){return i.name||""},e.prototype.getVersion=function(){return i.version||""},e.prototype.getFamily=function(){return i.os.family||""},e.prototype.getDescription=function(){return i.description||""},e}();t.PlatformUtils=r},734:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRtcPeerSendrecv=t.WebRtcPeerSendonly=t.WebRtcPeerRecvonly=t.WebRtcPeer=void 0;var a=n(8483),c=n(7466),d=n(6056),u=n(5364),l=n(5971),p=u.OpenViduLogger.getInstance(),h=[{rid:"r0",scaleResolutionDownBy:4},{rid:"r1",scaleResolutionDownBy:2},{rid:"r2",scaleResolutionDownBy:1}],f=function(){function e(e){var t=this;this.remoteCandidatesQueue=[],this.localCandidatesQueue=[],this.iceCandidateList=[],this.candidategatheringdone=!1,l.PlatformUtils.getInstance(),this.configuration=r(r({},e),{iceServers:e.iceServers&&e.iceServers.length>0?e.iceServers:a(),mediaStream:void 0!==e.mediaStream?e.mediaStream:null,mode:e.mode?e.mode:"sendrecv",id:e.id?e.id:this.generateUniqueId()}),this.pc=new RTCPeerConnection({iceServers:this.configuration.iceServers}),this.pc.addEventListener("icecandidate",(function(e){if(null!=e.candidate){var n=e.candidate;t.configuration.onIceCandidate(n),""!==n.candidate&&t.localCandidatesQueue.push({candidate:n.candidate})}})),this.pc.addEventListener("signalingstatechange",(function(){if("stable"===t.pc.signalingState)for(;t.iceCandidateList.length>0;){var e=t.iceCandidateList.shift();t.pc.addIceCandidate(e)}}))}return e.prototype.getId=function(){return this.configuration.id},e.prototype.dispose=function(){if(p.debug("Disposing WebRtcPeer"),this.pc){if("closed"===this.pc.signalingState)return;this.pc.close(),this.remoteCandidatesQueue=[],this.localCandidatesQueue=[]}},e.prototype.createOffer=function(){var e=this;return new Promise((function(t,n){return o(e,void 0,void 0,(function(){var e,i,r,o,a,c,d,u,l,f,v,m;return s(this,(function(s){switch(s.label){case 0:if(!("addTransceiver"in this.pc))return[3,7];if(p.debug("[createOffer] Method RTCPeerConnection.addTransceiver() is available; using it"),"recvonly"===this.configuration.mode)return[3,5];if(!this.configuration.mediaStream)return n(new Error(this.configuration.mode+" direction requested, but no stream was configured to be sent")),[2];e=0,i=this.configuration.mediaStream.getTracks(),s.label=1;case 1:return e<i.length?(r=i[e],o={direction:this.configuration.mode,streams:[this.configuration.mediaStream]},this.configuration.simulcast&&"video"===r.kind&&(o.sendEncodings=h),a=this.pc.addTransceiver(r,o),this.configuration.simulcast&&"video"===r.kind?"encodings"in(c=a.sender.getParameters())&&c.encodings.length===o.sendEncodings.length?[3,3]:(c.encodings=o.sendEncodings,[4,a.sender.setParameters(c)]):[3,3]):[3,4];case 2:s.sent(),s.label=3;case 3:return e++,[3,1];case 4:return[3,6];case 5:for(d=0,u=["audio","video"];d<u.length;d++)l=u[d],this.configuration.mediaConstraints[l]&&(this.configuration.mediaStream=new MediaStream,this.pc.addTransceiver(l,{direction:this.configuration.mode,streams:[this.configuration.mediaStream]}));s.label=6;case 6:return this.pc.createOffer().then((function(e){return t(e)})).catch((function(e){return n(e)})),[3,8];case 7:p.warn("[createOffer] Method RTCPeerConnection.addTransceiver() is NOT available; using LEGACY offerToReceive{Audio,Video}"),this.configuration.mediaStream&&this.deprecatedPeerConnectionTrackApi(),f=this.configuration.mediaConstraints.audio,v=this.configuration.mediaConstraints.video,m={offerToReceiveAudio:"sendonly"!==this.configuration.mode&&f,offerToReceiveVideo:"sendonly"!==this.configuration.mode&&v},p.debug("RTCPeerConnection.createOffer() options:",JSON.stringify(m)),this.pc.createOffer(m).then((function(e){return t(e)})).catch((function(e){return n(e)})),s.label=8;case 8:return[2]}}))}))}))},e.prototype.deprecatedPeerConnectionTrackApi=function(){for(var e=0,t=this.configuration.mediaStream.getTracks();e<t.length;e++){var n=t[e];this.pc.addTrack(n,this.configuration.mediaStream)}},e.prototype.createAnswer=function(){var e=this;return new Promise((function(t,n){if("getTransceivers"in e.pc){p.debug("[createAnswer] Method RTCPeerConnection.getTransceivers() is available; using it");for(var i=function(t){if(!e.configuration.mediaConstraints[t])return"continue";var i=e.pc.getTransceivers().find((function(e){return e.receiver.track.kind===t}));i?i.direction=e.configuration.mode:n(new Error(t+" requested, but no transceiver was created from remote description"))},r=0,o=["audio","video"];r<o.length;r++){i(o[r])}e.pc.createAnswer().then((function(e){return t(e)})).catch((function(e){return n(e)}))}else{if(e.configuration.mediaConstraints){var s={offerToReceiveAudio:"boolean"!==typeof e.configuration.mediaConstraints.audio||e.configuration.mediaConstraints.audio,offerToReceiveVideo:"boolean"!==typeof e.configuration.mediaConstraints.video||e.configuration.mediaConstraints.video};e.pc.createAnswer(s).then((function(e){t(e)})).catch((function(e){n(e)}))}}}))},e.prototype.processLocalOffer=function(e){var t=this;return new Promise((function(n,i){t.pc.setLocalDescription(e).then((function(){var e=t.pc.localDescription;e?(p.debug("Local description set",e.sdp),n()):i("Local description is not defined")})).catch((function(e){i(e)}))}))},e.prototype.processRemoteOffer=function(e){var t=this;return new Promise((function(n,i){var r={type:"offer",sdp:e};p.debug("SDP offer received, setting remote description",r),"closed"===t.pc.signalingState&&i("RTCPeerConnection is closed when trying to set remote description"),t.setRemoteDescription(r).then((function(){n()})).catch((function(e){i(e)}))}))},e.prototype.processLocalAnswer=function(e){var t=this;return new Promise((function(n,i){p.debug("SDP answer created, setting local description"),"closed"===t.pc.signalingState&&i("RTCPeerConnection is closed when trying to set local description"),t.pc.setLocalDescription(e).then((function(){return n()})).catch((function(e){return i(e)}))}))},e.prototype.processRemoteAnswer=function(e){var t=this;return new Promise((function(n,i){var r={type:"answer",sdp:e};p.debug("SDP answer received, setting remote description"),"closed"===t.pc.signalingState&&i("RTCPeerConnection is closed when trying to set remote description"),t.setRemoteDescription(r).then((function(){return n()})).catch((function(e){return i(e)}))}))},e.prototype.setRemoteDescription=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.pc.setRemoteDescription(e)]}))}))},e.prototype.addIceCandidate=function(e){var t=this;return new Promise((function(n,i){switch(p.debug("Remote ICE candidate received",e),t.remoteCandidatesQueue.push(e),t.pc.signalingState){case"closed":i(new Error("PeerConnection object is closed"));break;case"stable":t.pc.remoteDescription?t.pc.addIceCandidate(e).then((function(){return n()})).catch((function(e){return i(e)})):(t.iceCandidateList.push(e),n());break;default:t.iceCandidateList.push(e),n()}}))},e.prototype.addIceConnectionStateChangeListener=function(e){var t=this;this.pc.addEventListener("iceconnectionstatechange",(function(){switch(t.pc.iceConnectionState){case"disconnected":var n="IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "disconnected". Possible network disconnection';p.warn(n),t.configuration.onIceConnectionStateException(d.ExceptionEventName.ICE_CONNECTION_DISCONNECTED,n);break;case"failed":var i="IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') to "failed"';p.error(i),t.configuration.onIceConnectionStateException(d.ExceptionEventName.ICE_CONNECTION_FAILED,i);break;case"closed":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "closed"');break;case"new":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "new"');break;case"checking":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "checking"');break;case"connected":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "connected"');break;case"completed":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "completed"')}}))},e.prototype.generateUniqueId=function(){return c.v4()},e}();t.WebRtcPeer=f;var v=function(e){function t(t){return t.mode="recvonly",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerRecvonly=v;var m=function(e){function t(t){return t.mode="sendonly",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerSendonly=m;var g=function(e){function t(t){return t.mode="sendrecv",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerSendrecv=g},7137:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRtcStats=void 0;var o,s=n(5364),a=n(5971),c=s.OpenViduLogger.getInstance(),d=function(){function e(e){this.stream=e,this.STATS_ITEM_NAME="webrtc-stats-config",this.webRtcStatsEnabled=!1,this.statsInterval=1,o=a.PlatformUtils.getInstance()}return e.prototype.isEnabled=function(){return this.webRtcStatsEnabled},e.prototype.initWebRtcStats=function(){var e=this,t=localStorage.getItem(this.STATS_ITEM_NAME);if(t){this.webRtcStatsEnabled=!0;var n=JSON.parse(t);c.warn("WebRtc stats enabled for stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId),c.warn("localStorage item: "+JSON.stringify(n)),this.POST_URL=n.httpEndpoint,this.statsInterval=n.interval,this.webRtcStatsIntervalId=setInterval((function(){return i(e,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.sendStatsToHttpEndpoint()];case 1:return e.sent(),[2]}}))}))}),1e3*this.statsInterval)}else c.debug("WebRtc stats not enabled")},e.prototype.getSelectedIceCandidateInfo=function(){var e=this;return new Promise((function(t,n){return i(e,void 0,void 0,(function(){var e,n,i,s,a,c,d,u,l,p,h,f,v,m,g,b,E,y,S,w,C,O;return r(this,(function(r){switch(r.label){case 0:return[4,this.stream.getRTCPeerConnection().getStats()];case 1:if(e=r.sent(),i=new Map,s=new Map,a=new Map,e.forEach((function(e){switch("transport"===e.type&&(o.isChromium()||o.isSafariBrowser()||o.isReactNative())&&(n=e),e.type){case"candidate-pair":i.set(e.id,e);break;case"local-candidate":s.set(e.id,e);break;case"remote-candidate":a.set(e.id,e)}})),null!=n)d=n.selectedCandidatePairId,c=i.get(d);else for(u=i.size,l=i.values(),p=0;p<u;p++)if((h=l.next().value).selected){c=h;break}if(f=c.localCandidateId,v=c.remoteCandidateId,m=s.get(f))for(y=this.stream.getLocalIceCandidateList(),S=y.filter((function(e){return!!e.candidate&&(e.candidate.indexOf(m.ip)>=0||e.candidate.indexOf(m.address)>=0)&&e.candidate.indexOf(m.port)>=0})),m.raw=[],g=0,b=S;g<b.length;g++)O=b[g],m.raw.push(O.candidate);else m="ERROR: No active local ICE candidate. Probably ICE-TCP is being used";if(E=a.get(v))for(y=this.stream.getRemoteIceCandidateList(),S=y.filter((function(e){return!!e.candidate&&(e.candidate.indexOf(E.ip)>=0||e.candidate.indexOf(E.address)>=0)&&e.candidate.indexOf(E.port)>=0})),E.raw=[],w=0,C=S;w<C.length;w++)O=C[w],E.raw.push(O.candidate);else E="ERROR: No active remote ICE candidate. Probably ICE-TCP is being used";return t({localCandidate:m,remoteCandidate:E}),[2]}}))}))}))},e.prototype.stopWebRtcStats=function(){this.webRtcStatsEnabled&&(clearInterval(this.webRtcStatsIntervalId),c.warn("WebRtc stats stopped for disposed stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId))},e.prototype.sendStats=function(e,t){return i(this,void 0,void 0,(function(){var n,i;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),n={headers:{"Content-type":"application/json"},body:JSON.stringify(t),method:"POST"},[4,fetch(e,n)];case 1:return r.sent(),[3,3];case 2:return i=r.sent(),c.error("sendStats error: "+JSON.stringify(i)),[3,3];case 3:return[2]}}))}))},e.prototype.sendStatsToHttpEndpoint=function(){return i(this,void 0,void 0,(function(){var e,t,n;return r(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.getCommonStats()];case 1:return e=i.sent(),t=this.generateJSONStatsResponse(e),[4,this.sendStats(this.POST_URL,t)];case 2:return i.sent(),[3,4];case 3:return n=i.sent(),c.log(n),[3,4];case 4:return[2]}}))}))},e.prototype.getCommonStats=function(){return i(this,void 0,void 0,(function(){var e=this;return r(this,(function(t){return[2,new Promise((function(t,n){return i(e,void 0,void 0,(function(){var e,i,o,s,a,d=this;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.stream.getRTCPeerConnection().getStats()];case 1:return e=r.sent(),i=this.getWebRtcStatsResponseOutline(),o=["framesReceived","framesDropped","framesSent","frameHeight","frameWidth"],s=["availableOutgoingBitrate","currentRoundTripTime"],e.forEach((function(e){var t=null!=e.mediaType?e.mediaType:e.kind,n=function(n,r){null!=e[r]&&null!=i[n]&&(!t&&o.indexOf(r)>-1&&(t="video"),null!=n&&null!=t&&null!=r&&null!=i[n][t]?i[n][t][r]=Number(e[r]):null!=n&&null!=r&&s.includes(r)&&(i[n][r]=Number(e[r])))};switch(e.type){case"outbound-rtp":n("outbound","bytesSent"),n("outbound","packetsSent"),n("outbound","framesEncoded"),n("outbound","nackCount"),n("outbound","firCount"),n("outbound","pliCount"),n("outbound","qpSum");break;case"inbound-rtp":n("inbound","bytesReceived"),n("inbound","packetsReceived"),n("inbound","packetsLost"),n("inbound","jitter"),n("inbound","framesDecoded"),n("inbound","nackCount"),n("inbound","firCount"),n("inbound","pliCount");break;case"track":n("inbound","jitterBufferDelay"),n("inbound","framesReceived"),n("outbound","framesDropped"),n("outbound","framesSent"),n(d.stream.isLocal()?"outbound":"inbound","frameHeight"),n(d.stream.isLocal()?"outbound":"inbound","frameWidth");break;case"candidate-pair":n("candidatepair","currentRoundTripTime"),n("candidatepair","availableOutgoingBitrate")}})),(null===i||void 0===i?void 0:i.candidatepair)&&0!==Object.keys(i.candidatepair).length||delete i.candidatepair,[2,t(i)];case 2:return a=r.sent(),c.error("Error getting common stats: ",a),[2,n(a)];case 3:return[2]}}))}))}))]}))}))},e.prototype.generateJSONStatsResponse=function(e){return{"@timestamp":(new Date).toISOString(),participant_id:this.stream.connection.data,session_id:this.stream.session.sessionId,platform:o.getName(),platform_description:o.getDescription(),stream:"webRTC",webrtc_stats:e}},e.prototype.getWebRtcStatsResponseOutline=function(){return this.stream.isLocal()?{outbound:{audio:{},video:{}},candidatepair:{}}:{inbound:{audio:{},video:{}}}},e}();t.WebRtcStats=d},4905:function(e,t,n){"use strict";t.Dn=void 0;var i=n(3129),r=n(4527);Object.defineProperty(t,"Dn",{enumerable:!0,get:function(){return r.OpenVidu}});var o=n(7678);var s=n(2917);var a=n(4980);var c=n(2028);var d=n(7686);var u=n(3274);var l=n(1944);var p=n(6153);var h=n(9690);var f=n(7009);var v=n(4270);var m=n(6300);var g=n(5223);var b=n(8271);var E=n(8856);var y=n(3439);var S=n(3685);var w=n(3590);var C=n(3977);var O=n(6367);var I=n(7614);var R=n(6203);var P=n(146);var _=n(9233);var k=n(6056);var N=n(3013);i.JL.setOptions({enabled:!1})},1795:function(e,t,n){var i;e=n.nmd(e),function(){"use strict";var r={function:!0,object:!0},o=r[typeof window]&&window||this,s=r[typeof t]&&t,a=r.object&&e&&!e.nodeType&&e,c=s&&a&&"object"==typeof n.g&&n.g;!c||c.global!==c&&c.window!==c&&c.self!==c||(o=c);var d=Math.pow(2,53)-1,u=/\bOpera/,l=Object.prototype,p=l.hasOwnProperty,h=l.toString;function f(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function v(e){return e=y(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:f(e)}function m(e,t){for(var n in e)p.call(e,n)&&t(e[n],n,e)}function g(e){return null==e?f(e):h.call(e).slice(8,-1)}function b(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function E(e,t){var n=null;return function(e,t){var n=-1,i=e?e.length:0;if("number"==typeof i&&i>-1&&i<=d)for(;++n<i;)t(e[n],n,e);else m(e,t)}(e,(function(i,r){n=t(n,i,r,e)})),n}function y(e){return String(e).replace(/^ +| +$/g,"")}var S=function e(t){var n=o,i=t&&"object"==typeof t&&"String"!=g(t);i&&(n=t,t=null);var r=n.navigator||{},s=r.userAgent||"";t||(t=s);var a,c,d=i?!!r.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(h.toString()),l="Object",p=i?l:"ScriptBridgingProxyObject",f=i?l:"Environment",S=i&&n.java?"JavaPackage":g(n.java),w=i?l:"RuntimeObject",C=/\bJava/.test(S)&&n.java,O=C&&g(n.environment)==f,I=C?"a":"\u03b1",R=C?"b":"\u03b2",P=n.document||{},_=n.operamini||n.opera,k=u.test(k=i&&_?_["[[Class]]"]:g(_))?k:_=null,N=t,T=[],L=null,M=t==s,D=M&&_&&"function"==typeof _.version&&_.version(),A=E([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||b(n))+"\\b","i").exec(t)&&(n.label||n)})),V=function(e){return E(e,(function(e,n){return e||RegExp("\\b"+(n.pattern||b(n))+"\\b","i").exec(t)&&(n.label||n)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),x=W([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),B=function(e){return E(e,(function(e,n,i){return e||(n[x]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(x)]||RegExp("\\b"+b(i)+"(?:\\b|\\w*\\d)","i").exec(t))&&i}))}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),j=function(e){return E(e,(function(e,n){var i=n.pattern||b(n);return!e&&(e=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\d.]+$/.exec(e)])&&(e="Windows "+i),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),v(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,i,n.label||n)),e}))}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function W(e){return E(e,(function(e,n){var i=n.pattern||b(n);return!e&&(e=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(i,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=v(e[0].replace(RegExp(i,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function F(e){return E(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(A&&(A=[A]),/\bAndroid\b/.test(j)&&!x&&(a=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(x=y(a[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),B&&!x?x=W([B]):B&&x&&(x=x.replace(RegExp("^("+b(B)+")[-_.\\s]","i"),B+" ").replace(RegExp("^("+b(B)+")[-_.]?(\\w)","i"),B+" $2")),(a=/\bGoogle TV\b/.exec(x))&&(x=a[0]),/\bSimulator\b/i.test(t)&&(x=(x?x+" ":"")+"Simulator"),"Opera Mini"==V&&/\bOPiOS\b/.test(t)&&T.push("running in Turbo/Uncompressed mode"),"IE"==V&&/\blike iPhone OS\b/.test(t)?(B=(a=e(t.replace(/like iPhone OS/,""))).manufacturer,x=a.product):/^iP/.test(x)?(V||(V="Safari"),j="iOS"+((a=/ OS ([\d_]+)/i.exec(t))?" "+a[1].replace(/_/g,"."):"")):"Konqueror"==V&&/^Linux\b/i.test(j)?j="Kubuntu":B&&"Google"!=B&&(/Chrome/.test(V)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(x))||/\bAndroid\b/.test(j)&&/^Chrome/.test(V)&&/\bVersion\//i.test(t)?(V="Android Browser",j=/\bAndroid\b/.test(j)?j:"Android"):"Silk"==V?(/\bMobi/i.test(t)||(j="Android",T.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&T.unshift("accelerated")):"UC Browser"==V&&/\bUCWEB\b/.test(t)?T.push("speed mode"):"PaleMoon"==V&&(a=/\bFirefox\/([\d.]+)\b/.exec(t))?T.push("identifying as Firefox "+a[1]):"Firefox"==V&&(a=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(j||(j="Firefox OS"),x||(x=a[1])):!V||(a=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(V))?(V&&!x&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(a+"/")+8))&&(V=null),(a=x||B||j)&&(x||B||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(j))&&(V=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(j)?j:a)+" Browser")):"Electron"==V&&(a=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&T.push("Chromium "+a),D||(D=F(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",b(V),"(?:Firefox|Minefield|NetFront)"])),(a=("iCab"==A&&parseFloat(D)>3?"WebKit":/\bOpera\b/.test(V)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(A)&&"WebKit"||!A&&/\bMSIE\b/i.test(t)&&("Mac OS"==j?"Tasman":"Trident")||"WebKit"==A&&/\bPlayStation\b(?! Vita\b)/i.test(V)&&"NetFront")&&(A=[a]),"IE"==V&&(a=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(V+=" Mobile",j="Windows Phone "+(/\+$/.test(a)?a:a+".x"),T.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(V="IE Mobile",j="Windows Phone 8.x",T.unshift("desktop mode"),D||(D=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=V&&"Trident"==A&&(a=/\brv:([\d.]+)/.exec(t))&&(V&&T.push("identifying as "+V+(D?" "+D:"")),V="IE",D=a[1]),M){if(function(e,t){var n=null!=e?typeof e[t]:"number";return!/^(?:boolean|number|string|undefined)$/.test(n)&&("object"!=n||!!e[t])}(n,"global"))if(C&&(N=(a=C.lang.System).getProperty("os.arch"),j=j||a.getProperty("os.name")+" "+a.getProperty("os.version")),O){try{D=n.require("ringo/engine").version.join("."),V="RingoJS"}catch(H){(a=n.system)&&a.global.system==n.system&&(V="Narwhal",j||(j=a[0].os||null))}V||(V="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(a=n.process)&&("object"==typeof a.versions&&("string"==typeof a.versions.electron?(T.push("Node "+a.versions.node),V="Electron",D=a.versions.electron):"string"==typeof a.versions.nw&&(T.push("Chromium "+D,"Node "+a.versions.node),V="NW.js",D=a.versions.nw)),V||(V="Node.js",N=a.arch,j=a.platform,D=(D=/[\d.]+/.exec(a.version))?D[0]:null));else g(a=n.runtime)==p?(V="Adobe AIR",j=a.flash.system.Capabilities.os):g(a=n.phantom)==w?(V="PhantomJS",D=(a=a.version||null)&&a.major+"."+a.minor+"."+a.patch):"number"==typeof P.documentMode&&(a=/\bTrident\/(\d+)/i.exec(t))?(D=[D,P.documentMode],(a=+a[1]+4)!=D[1]&&(T.push("IE "+D[1]+" mode"),A&&(A[1]=""),D[1]=a),D="IE"==V?String(D[1].toFixed(1)):D[0]):"number"==typeof P.documentMode&&/^(?:Chrome|Firefox)\b/.test(V)&&(T.push("masking as "+V+" "+D),V="IE",D="11.0",A=["Trident"],j="Windows");j=j&&v(j)}if(D&&(a=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(D)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(M&&r.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(L=/b/i.test(a)?"beta":"alpha",D=D.replace(RegExp(a+"\\+?$"),"")+("beta"==L?R:I)+(/\d+\+?/.exec(a)||"")),"Fennec"==V||"Firefox"==V&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(j))V="Firefox Mobile";else if("Maxthon"==V&&D)D=D.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(x))"Xbox 360"==x&&(j=null),"Xbox 360"==x&&/\bIEMobile\b/.test(t)&&T.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(V)&&(!V||x||/Browser|Mobi/.test(V))||"Windows CE"!=j&&!/Mobi/i.test(t))if("IE"==V&&M)try{null===n.external&&T.unshift("platform preview")}catch(H){T.unshift("embedded")}else(/\bBlackBerry\b/.test(x)||/\bBB10\b/.test(t))&&(a=(RegExp(x.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||D)?(j=((a=[a,/BB10/.test(t)])[1]?(x=null,B="BlackBerry"):"Device Software")+" "+a[0],D=null):this!=m&&"Wii"!=x&&(M&&_||/Opera/.test(V)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==V&&/\bOS X (?:\d+\.){2,}/.test(j)||"IE"==V&&(j&&!/^Win/.test(j)&&D>5.5||/\bWindows XP\b/.test(j)&&D>8||8==D&&!/\bTrident\b/.test(t)))&&!u.test(a=e.call(m,t.replace(u,"")+";"))&&a.name&&(a="ing as "+a.name+((a=a.version)?" "+a:""),u.test(V)?(/\bIE\b/.test(a)&&"Mac OS"==j&&(j=null),a="identify"+a):(a="mask"+a,V=k?v(k.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(a)&&(j=null),M||(D=null)),A=["Presto"],T.push(a));else V+=" Mobile";(a=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(a=[parseFloat(a.replace(/\.(\d)$/,".0$1")),a],"Safari"==V&&"+"==a[1].slice(-1)?(V="WebKit Nightly",L="alpha",D=a[1].slice(0,-1)):D!=a[1]&&D!=(a[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(D=null),a[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==a[0]&&537.36==a[2]&&parseFloat(a[1])>=28&&"WebKit"==A&&(A=["Blink"]),M&&(d||a[1])?(A&&(A[1]="like Chrome"),a=a[1]||((a=a[0])<530?1:a<532?2:a<532.05?3:a<533?4:a<534.03?5:a<534.07?6:a<534.1?7:a<534.13?8:a<534.16?9:a<534.24?10:a<534.3?11:a<535.01?12:a<535.02?"13+":a<535.07?15:a<535.11?16:a<535.19?17:a<536.05?18:a<536.1?19:a<537.01?20:a<537.11?"21+":a<537.13?23:a<537.18?24:a<537.24?25:a<537.36?26:"Blink"!=A?"27":"28")):(A&&(A[1]="like Safari"),a=(a=a[0])<400?1:a<500?2:a<526?3:a<533?4:a<534?"4+":a<535?5:a<537?6:a<538?7:a<601?8:a<602?9:a<604?10:a<606?11:a<608?12:"12"),A&&(A[1]+=" "+(a+="number"==typeof a?".x":/[.+]/.test(a)?"":"+")),"Safari"==V&&(!D||parseInt(D)>45)?D=a:"Chrome"==V&&/\bHeadlessChrome/i.test(t)&&T.unshift("headless")),"Opera"==V&&(a=/\bzbov|zvav$/.exec(j))?(V+=" ",T.unshift("desktop mode"),"zvav"==a?(V+="Mini",D=null):V+="Mobile",j=j.replace(RegExp(" *"+a+"$"),"")):"Safari"==V&&/\bChrome\b/.exec(A&&A[1])?(T.unshift("desktop mode"),V="Chrome Mobile",D=null,/\bOS X\b/.test(j)?(B="Apple",j="iOS 4.3+"):j=null):/\bSRWare Iron\b/.test(V)&&!D&&(D=F("Chrome")),D&&0==D.indexOf(a=/[\d.]+$/.exec(j))&&t.indexOf("/"+a+"-")>-1&&(j=y(j.replace(a,""))),j&&-1!=j.indexOf(V)&&!RegExp(V+" OS").test(j)&&(j=j.replace(RegExp(" *"+b(V)+" *"),"")),A&&!/\b(?:Avant|Nook)\b/.test(V)&&(/Browser|Lunascape|Maxthon/.test(V)||"Safari"!=V&&/^iOS/.test(j)&&/\bSafari\b/.test(A[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(V)&&A[1])&&(a=A[A.length-1])&&T.push(a),T.length&&(T=["("+T.join("; ")+")"]),B&&x&&x.indexOf(B)<0&&T.push("on "+B),x&&T.push((/^on /.test(T[T.length-1])?"":"on ")+x),j&&(a=/ ([\d.+]+)$/.exec(j),c=a&&"/"==j.charAt(j.length-a[0].length-1),j={architecture:32,family:a&&!c?j.replace(a[0],""):j,version:a?a[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(a=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(N))&&!/\bi686\b/i.test(N)?(j&&(j.architecture=64,j.family=j.family.replace(RegExp(" *"+a),"")),V&&(/\bWOW64\b/i.test(t)||M&&/\w(?:86|32)$/.test(r.cpuClass||r.platform)&&!/\bWin64; x64\b/i.test(t))&&T.unshift("32-bit")):j&&/^OS X/.test(j.family)&&"Chrome"==V&&parseFloat(D)>=39&&(j.architecture=64),t||(t=null);var U={};return U.description=t,U.layout=A&&A[0],U.manufacturer=B,U.name=V,U.prerelease=L,U.product=x,U.ua=t,U.version=V&&D,U.os=j||{architecture:null,family:null,version:null,toString:function(){return"null"}},U.parse=e,U.toString=function(){return this.description||""},U.version&&T.unshift(D),U.name&&T.unshift(V),j&&V&&(j!=String(j).split(" ")[0]||j!=V.split(" ")[0]&&!x)&&T.push(x?"("+j+")":"on "+j),T.length&&(U.description=T.join(" ")),U}();o.platform=S,void 0===(i=function(){return S}.call(t,n,t,e))||(e.exports=i)}.call(this)},7466:function(e,t,n){"use strict";var i;n.r(t),n.d(t,{NIL:function(){return N},parse:function(){return m},stringify:function(){return p},v1:function(){return v},v3:function(){return I},v4:function(){return R},v5:function(){return k},validate:function(){return a},version:function(){return T}});var r=new Uint8Array(16);function o(){if(!i&&!(i="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)}var s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var a=function(e){return"string"===typeof e&&s.test(e)},c=[],d=0;d<256;++d)c.push((d+256).toString(16).substr(1));var u,l,p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!a(n))throw TypeError("Stringified UUID is invalid");return n},h=0,f=0;var v=function(e,t,n){var i=t&&n||0,r=t||new Array(16),s=(e=e||{}).node||u,a=void 0!==e.clockseq?e.clockseq:l;if(null==s||null==a){var c=e.random||(e.rng||o)();null==s&&(s=u=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==a&&(a=l=16383&(c[6]<<8|c[7]))}var d=void 0!==e.msecs?e.msecs:Date.now(),v=void 0!==e.nsecs?e.nsecs:f+1,m=d-h+(v-f)/1e4;if(m<0&&void 0===e.clockseq&&(a=a+1&16383),(m<0||d>h)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=d,f=v,l=a;var g=(1e4*(268435455&(d+=122192928e5))+v)%4294967296;r[i++]=g>>>24&255,r[i++]=g>>>16&255,r[i++]=g>>>8&255,r[i++]=255&g;var b=d/4294967296*1e4&268435455;r[i++]=b>>>8&255,r[i++]=255&b,r[i++]=b>>>24&15|16,r[i++]=b>>>16&255,r[i++]=a>>>8|128,r[i++]=255&a;for(var E=0;E<6;++E)r[i+E]=s[E];return t||p(r)};var m=function(e){if(!a(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};function g(e,t,n){function i(e,i,r,o){if("string"===typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"===typeof i&&(i=m(i)),16!==i.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+e.length);if(s.set(i),s.set(e,i.length),(s=n(s))[6]=15&s[6]|t,s[8]=63&s[8]|128,r){o=o||0;for(var a=0;a<16;++a)r[o+a]=s[a];return r}return p(s)}try{i.name=e}catch(r){}return i.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",i.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",i}function b(e){return 14+(e+64>>>9<<4)+1}function E(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function y(e,t,n,i,r,o){return E((s=E(E(t,e),E(i,o)))<<(a=r)|s>>>32-a,n);var s,a}function S(e,t,n,i,r,o,s){return y(t&n|~t&i,e,t,r,o,s)}function w(e,t,n,i,r,o,s){return y(t&i|n&~i,e,t,r,o,s)}function C(e,t,n,i,r,o,s){return y(t^n^i,e,t,r,o,s)}function O(e,t,n,i,r,o,s){return y(n^(t|~i),e,t,r,o,s)}var I=g("v3",48,(function(e){if("string"===typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,i="0123456789abcdef",r=0;r<n;r+=8){var o=e[r>>5]>>>r%32&255,s=parseInt(i.charAt(o>>>4&15)+i.charAt(15&o),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[b(t)-1]=t;for(var n=1732584193,i=-271733879,r=-1732584194,o=271733878,s=0;s<e.length;s+=16){var a=n,c=i,d=r,u=o;n=S(n,i,r,o,e[s],7,-680876936),o=S(o,n,i,r,e[s+1],12,-389564586),r=S(r,o,n,i,e[s+2],17,606105819),i=S(i,r,o,n,e[s+3],22,-1044525330),n=S(n,i,r,o,e[s+4],7,-176418897),o=S(o,n,i,r,e[s+5],12,1200080426),r=S(r,o,n,i,e[s+6],17,-1473231341),i=S(i,r,o,n,e[s+7],22,-45705983),n=S(n,i,r,o,e[s+8],7,1770035416),o=S(o,n,i,r,e[s+9],12,-1958414417),r=S(r,o,n,i,e[s+10],17,-42063),i=S(i,r,o,n,e[s+11],22,-1990404162),n=S(n,i,r,o,e[s+12],7,1804603682),o=S(o,n,i,r,e[s+13],12,-40341101),r=S(r,o,n,i,e[s+14],17,-1502002290),n=w(n,i=S(i,r,o,n,e[s+15],22,1236535329),r,o,e[s+1],5,-165796510),o=w(o,n,i,r,e[s+6],9,-1069501632),r=w(r,o,n,i,e[s+11],14,643717713),i=w(i,r,o,n,e[s],20,-373897302),n=w(n,i,r,o,e[s+5],5,-701558691),o=w(o,n,i,r,e[s+10],9,38016083),r=w(r,o,n,i,e[s+15],14,-660478335),i=w(i,r,o,n,e[s+4],20,-405537848),n=w(n,i,r,o,e[s+9],5,568446438),o=w(o,n,i,r,e[s+14],9,-1019803690),r=w(r,o,n,i,e[s+3],14,-187363961),i=w(i,r,o,n,e[s+8],20,1163531501),n=w(n,i,r,o,e[s+13],5,-1444681467),o=w(o,n,i,r,e[s+2],9,-51403784),r=w(r,o,n,i,e[s+7],14,1735328473),n=C(n,i=w(i,r,o,n,e[s+12],20,-1926607734),r,o,e[s+5],4,-378558),o=C(o,n,i,r,e[s+8],11,-2022574463),r=C(r,o,n,i,e[s+11],16,1839030562),i=C(i,r,o,n,e[s+14],23,-35309556),n=C(n,i,r,o,e[s+1],4,-1530992060),o=C(o,n,i,r,e[s+4],11,1272893353),r=C(r,o,n,i,e[s+7],16,-155497632),i=C(i,r,o,n,e[s+10],23,-1094730640),n=C(n,i,r,o,e[s+13],4,681279174),o=C(o,n,i,r,e[s],11,-358537222),r=C(r,o,n,i,e[s+3],16,-722521979),i=C(i,r,o,n,e[s+6],23,76029189),n=C(n,i,r,o,e[s+9],4,-640364487),o=C(o,n,i,r,e[s+12],11,-421815835),r=C(r,o,n,i,e[s+15],16,530742520),n=O(n,i=C(i,r,o,n,e[s+2],23,-995338651),r,o,e[s],6,-198630844),o=O(o,n,i,r,e[s+7],10,1126891415),r=O(r,o,n,i,e[s+14],15,-1416354905),i=O(i,r,o,n,e[s+5],21,-57434055),n=O(n,i,r,o,e[s+12],6,1700485571),o=O(o,n,i,r,e[s+3],10,-1894986606),r=O(r,o,n,i,e[s+10],15,-1051523),i=O(i,r,o,n,e[s+1],21,-2054922799),n=O(n,i,r,o,e[s+8],6,1873313359),o=O(o,n,i,r,e[s+15],10,-30611744),r=O(r,o,n,i,e[s+6],15,-1560198380),i=O(i,r,o,n,e[s+13],21,1309151649),n=O(n,i,r,o,e[s+4],6,-145523070),o=O(o,n,i,r,e[s+11],10,-1120210379),r=O(r,o,n,i,e[s+2],15,718787259),i=O(i,r,o,n,e[s+9],21,-343485551),n=E(n,a),i=E(i,c),r=E(r,d),o=E(o,u)}return[n,i,r,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(b(t)),i=0;i<t;i+=8)n[i>>5]|=(255&e[i/8])<<i%32;return n}(e),8*e.length))}));var R=function(e,t,n){var i=(e=e||{}).random||(e.rng||o)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return p(i)};function P(e,t,n,i){switch(e){case 0:return t&n^~t&i;case 1:return t^n^i;case 2:return t&n^t&i^n&i;case 3:return t^n^i}}function _(e,t){return e<<t|e>>>32-t}var k=g("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"===typeof e){var i=unescape(encodeURIComponent(e));e=[];for(var r=0;r<i.length;++r)e.push(i.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,s=Math.ceil(o/16),a=new Array(s),c=0;c<s;++c){for(var d=new Uint32Array(16),u=0;u<16;++u)d[u]=e[64*c+4*u]<<24|e[64*c+4*u+1]<<16|e[64*c+4*u+2]<<8|e[64*c+4*u+3];a[c]=d}a[s-1][14]=8*(e.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(e.length-1)&4294967295;for(var l=0;l<s;++l){for(var p=new Uint32Array(80),h=0;h<16;++h)p[h]=a[l][h];for(var f=16;f<80;++f)p[f]=_(p[f-3]^p[f-8]^p[f-14]^p[f-16],1);for(var v=n[0],m=n[1],g=n[2],b=n[3],E=n[4],y=0;y<80;++y){var S=Math.floor(y/20),w=_(v,5)+P(S,m,g,b)+E+t[S]+p[y]>>>0;E=b,b=g,g=_(m,30)>>>0,m=v,v=w}n[0]=n[0]+v>>>0,n[1]=n[1]+m>>>0,n[2]=n[2]+g>>>0,n[3]=n[3]+b>>>0,n[4]=n[4]+E>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),N="00000000-0000-0000-0000-000000000000";var T=function(e){if(!a(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},4114:function(e){function t(){}e.exports=t,t.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var i=3===arguments.length,r=i?arguments[1]:void 0,o=i?arguments[2]:arguments[1];return o._groupName=r,(this.callbacks[e]=this.callbacks[e]||[]).push(o),this},t.once=function(e,t,n){var i=this,r=3===arguments.length,o=r?arguments[1]:void 0,s=r?arguments[2]:arguments[1];function a(){i.off(e,a),s.apply(this,arguments)}return this.on(e,o,a),this},t.releaseGroup=function(e){var t,n,i,r;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,i=(r=this.callbacks[t]).length;n<i;n++)r[n]._groupName===e&&(r.splice(n,1),n--,i--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,i=this.callbacks[e];return i?1===arguments.length?(delete this.callbacks[e],this):(-1!==(n=i.indexOf(t))&&(i.splice(n,1),0===i.length&&delete this.callbacks[e]),this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,i,r=[].slice.call(arguments,1),o=this.callbacks[e],s=this.getWildcardCallbacks(e);if(o)for(t=0,n=(i=o.slice()).length;t<n&&i[t];++t)i[t].apply(this,r);if(s)for(n=s.length,t=0,n=(i=s.slice()).length;t<n&&i[t];++t)i[t].apply(this,[e].concat(r));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,i=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(i=i.concat(this.callbacks[t]));return i}},t.mixin(t)},4795:function(e,t,n){var i;!function(t){"use strict";function r(){}var o=r.prototype,s=t.EventEmitter;function a(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function c(e){return function(){return this[e].apply(this,arguments)}}function d(e){return"function"===typeof e||e instanceof RegExp||!(!e||"object"!==typeof e)&&d(e.listener)}o.getListeners=function(e){var t,n,i=this._getEvents();if(e instanceof RegExp)for(n in t={},i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n]);else t=i[e]||(i[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},o.addListener=function(e,t){if(!d(t))throw new TypeError("listener must be a function");var n,i=this.getListenersAsObject(e),r="object"===typeof t;for(n in i)i.hasOwnProperty(n)&&-1===a(i[n],t)&&i[n].push(r?t:{listener:t,once:!1});return this},o.on=c("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=c("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,i,r=this.getListenersAsObject(e);for(i in r)r.hasOwnProperty(i)&&-1!==(n=a(r[i],t))&&r[i].splice(n,1);return this},o.off=c("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var i,r,o=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!==typeof t||t instanceof RegExp)for(i=n.length;i--;)o.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(r=t[i])&&("function"===typeof r?o.call(this,i,r):s.call(this,i,r));return this},o.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"===n)delete i[e];else if(e instanceof RegExp)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},o.removeAllListeners=c("removeEvent"),o.emitEvent=function(e,t){var n,i,r,o,s=this.getListenersAsObject(e);for(o in s)if(s.hasOwnProperty(o))for(n=s[o].slice(0),r=0;r<n.length;r++)!0===(i=n[r]).once&&this.removeListener(e,i.listener),i.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,i.listener);return this},o.trigger=c("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},r.noConflict=function(){return t.EventEmitter=s,r},void 0===(i=function(){return r}.call(t,n,t,e))||(e.exports=i)}("undefined"!==typeof window?window:this||{})},8808:function(e){"use strict";e.exports=JSON.parse('["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"]')},4576:function(e){"use strict";e.exports=[]},5549:function(e){"use strict";e.exports=JSON.parse('{"_args":[["openvidu-browser@2.20.0","/home/runner/work/facial-recognition-service/facial-recognition-service/app"]],"_from":"openvidu-browser@2.20.0","_id":"openvidu-browser@2.20.0","_inBundle":false,"_integrity":"sha512-ZlCF2B91Mix/z6NsmarLZomaycyadY8I3giV0NRMo5vWfhKcGLREKPCX979G+UJQxn7qGiq31/2dJ29bpf7hBg==","_location":"/openvidu-browser","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"openvidu-browser@2.20.0","name":"openvidu-browser","escapedName":"openvidu-browser","rawSpec":"2.20.0","saveSpec":null,"fetchSpec":"2.20.0"},"_requiredBy":["/"],"_resolved":"https://registry.npmjs.org/openvidu-browser/-/openvidu-browser-2.20.0.tgz","_spec":"2.20.0","_where":"/home/runner/work/facial-recognition-service/facial-recognition-service/app","author":{"name":"OpenVidu"},"bugs":{"url":"https://github.com/OpenVidu/openvidu/issues"},"dependencies":{"freeice":"2.2.2","hark":"1.2.3","jsnlog":"2.30.0","platform":"1.3.6","uuid":"8.3.2","wolfy87-eventemitter":"5.2.9"},"description":"OpenVidu Browser","devDependencies":{"@types/node":"15.12.2","@types/platform":"1.3.3","browserify":"17.0.0","grunt":"1.4.1","grunt-cli":"1.4.3","grunt-contrib-copy":"1.0.0","grunt-contrib-sass":"2.0.0","grunt-contrib-uglify":"5.0.1","grunt-contrib-watch":"1.1.0","grunt-postcss":"0.9.0","grunt-string-replace":"1.3.1","grunt-ts":"6.0.0-beta.22","terser":"5.7.0","tsify":"5.0.4","tslint":"6.1.3","typedoc":"0.19.2","typescript":"4.0.7"},"homepage":"https://github.com/OpenVidu/openvidu#readme","license":"Apache-2.0","main":"lib/index.js","name":"openvidu-browser","repository":{"type":"git","url":"git://github.com/OpenVidu/openvidu.git"},"scripts":{"browserify":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js Main.ts -p [ tsify ] --exclude kurento-browser-extensions --debug -o ../static/js/openvidu-browser-$VERSION.js -v","browserify-prod":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js --debug Main.ts -p [ tsify ] --exclude kurento-browser-extensions | ../node_modules/terser/bin/terser --source-map content=inline --output ../static/js/openvidu-browser-$VERSION.min.js","build":"cd src/OpenVidu && ./../../node_modules/typescript/bin/tsc && cd ../.. && ./node_modules/typescript/bin/tsc --declaration src/index.ts --outDir ./lib --sourceMap --target es5 --lib dom,es5,es2015.promise,scripthost","docs":"./generate-docs.sh"},"types":"lib/index.d.ts","version":"2.20.0"}')}}]);